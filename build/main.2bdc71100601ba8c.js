"use strict";var lM=Math.pow;(self.webpackChunkproduct_configurator=self.webpackChunkproduct_configurator||[]).push([[179],{902:(gy,cM,yy)=>{var yl={};function Jt(i){return"function"==typeof i}function _y(i){const t=i(n=>{Error.call(n),n.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}yy.r(yl),yy.d(yl,{AsyncCompress:()=>SL,AsyncDecompress:()=>lK,AsyncDeflate:()=>bL,AsyncGunzip:()=>CL,AsyncGzip:()=>SL,AsyncInflate:()=>fb,AsyncUnzipInflate:()=>vK,AsyncUnzlib:()=>AL,AsyncZipDeflate:()=>pK,AsyncZlib:()=>oK,Compress:()=>Ng,DecodeUTF8:()=>hK,Decompress:()=>IL,Deflate:()=>_s,EncodeUTF8:()=>dK,Gunzip:()=>Bg,Gzip:()=>Ng,Inflate:()=>Ri,Unzip:()=>xK,UnzipInflate:()=>_K,UnzipPassThrough:()=>BL,Unzlib:()=>Ug,Zip:()=>mK,ZipDeflate:()=>fK,ZipPassThrough:()=>Fd,Zlib:()=>mb,compress:()=>EL,compressSync:()=>kg,decompress:()=>cK,decompressSync:()=>uK,deflate:()=>ML,deflateSync:()=>Ld,gunzip:()=>TL,gunzipSync:()=>zg,gzip:()=>EL,gzipSync:()=>kg,inflate:()=>pb,inflateSync:()=>hu,strFromU8:()=>vb,strToU8:()=>Qo,unzip:()=>wK,unzipSync:()=>bK,unzlib:()=>DL,unzlibSync:()=>Ko,zip:()=>gK,zipSync:()=>yK,zlib:()=>aK,zlibSync:()=>gb});const vy=_y(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((n,r)=>`${r+1}) ${n.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function xy(i,e){if(i){const t=i.indexOf(e);0<=t&&i.splice(t,1)}}class Qi{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:n}=this;if(Jt(n))try{n()}catch(s){e=s instanceof vy?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{dM(s)}catch(o){e=null!=e?e:[],o instanceof vy?e=[...e,...o.errors]:e.push(o)}}if(e)throw new vy(e)}}add(e){var t;if(e&&e!==this)if(this.closed)dM(e);else{if(e instanceof Qi){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&xy(t,e)}remove(e){const{_finalizers:t}=this;t&&xy(t,e),e instanceof Qi&&e._removeParent(this)}}Qi.EMPTY=(()=>{const i=new Qi;return i.closed=!0,i})();const uM=Qi.EMPTY;function hM(i){return i instanceof Qi||i&&"closed"in i&&Jt(i.remove)&&Jt(i.add)&&Jt(i.unsubscribe)}function dM(i){Jt(i)?i():i.unsubscribe()}const la={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Xd={setTimeout(i,e,...t){const{delegate:n}=Xd;return(null==n?void 0:n.setTimeout)?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){const{delegate:e}=Xd;return((null==e?void 0:e.clearTimeout)||clearTimeout)(i)},delegate:void 0};function fM(i){Xd.setTimeout(()=>{const{onUnhandledError:e}=la;if(!e)throw i;e(i)})}function pM(){}const IF=wy("C",void 0,void 0);function wy(i,e,t){return{kind:i,value:e,error:t}}let ca=null;function Zd(i){if(la.useDeprecatedSynchronousErrorHandling){const e=!ca;if(e&&(ca={errorThrown:!1,error:null}),i(),e){const{errorThrown:t,error:n}=ca;if(ca=null,t)throw n}}else i()}class by extends Qi{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,hM(e)&&e.add(this)):this.destination=kF}static create(e,t,n){return new Yd(e,t,n)}next(e){this.isStopped?Sy(function PF(i){return wy("N",i,void 0)}(e),this):this._next(e)}error(e){this.isStopped?Sy(function RF(i){return wy("E",void 0,i)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Sy(IF,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const FF=Function.prototype.bind;function My(i,e){return FF.call(i,e)}class OF{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){Kd(n)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){Kd(n)}else Kd(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Kd(t)}}}class Yd extends by{constructor(e,t,n){let r;if(super(),Jt(e)||!e)r={next:null!=e?e:void 0,error:null!=t?t:void 0,complete:null!=n?n:void 0};else{let s;this&&la.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&My(e.next,s),error:e.error&&My(e.error,s),complete:e.complete&&My(e.complete,s)}):r=e}this.destination=new OF(r)}}function Kd(i){la.useDeprecatedSynchronousErrorHandling?function LF(i){la.useDeprecatedSynchronousErrorHandling&&ca&&(ca.errorThrown=!0,ca.error=i)}(i):fM(i)}function Sy(i,e){const{onStoppedNotification:t}=la;t&&Xd.setTimeout(()=>t(i,e))}const kF={closed:!0,next:pM,error:function NF(i){throw i},complete:pM},Ey="function"==typeof Symbol&&Symbol.observable||"@@observable";function ua(i){return i}let Cn=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){const n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){const s=function zF(i){return i&&i instanceof by||function BF(i){return i&&Jt(i.next)&&Jt(i.error)&&Jt(i.complete)}(i)&&hM(i)}(t)?t:new Yd(t,n,r);return Zd(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return new(n=gM(n))((r,s)=>{const o=new Yd({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return null===(n=this.source)||void 0===n?void 0:n.subscribe(t)}[Ey](){return this}pipe(...t){return function mM(i){return 0===i.length?ua:1===i.length?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}(t)(this)}toPromise(t){return new(t=gM(t))((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function gM(i){var e;return null!==(e=null!=i?i:la.Promise)&&void 0!==e?e:Promise}const UF=_y(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Kr=(()=>{class i extends Cn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const n=new yM(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new UF}next(t){Zd(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const n of this.currentObservers)n.next(t)}})}error(t){Zd(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){Zd(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:n,isStopped:r,observers:s}=this;return n||r?uM:(this.currentObservers=null,s.push(t),new Qi(()=>{this.currentObservers=null,xy(s,t)}))}_checkFinalizedStatuses(t){const{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){const t=new Cn;return t.source=this,t}}return i.create=(e,t)=>new yM(e,t),i})();class yM extends Kr{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)}error(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:uM}}function _M(i){return Jt(null==i?void 0:i.lift)}function Gn(i){return e=>{if(_M(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Wn(i,e,t,n,r){return new VF(i,e,t,n,r)}class VF extends by{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function $t(i,e){return Gn((t,n)=>{let r=0;t.subscribe(Wn(n,s=>{n.next(i.call(e,s,r++))}))})}function xM(i,e,t,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(i,e,t,n);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(s=(r<3?o(s):r>3?o(e,t,s):o(e,t))||s);return r>3&&s&&Object.defineProperty(e,t,s),s}function ha(i,e,t,n){return new(t||(t=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}function da(i){return this instanceof da?(this.v=i,this):new da(i)}function GF(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,n=t.apply(i,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){n[d]&&(r[d]=function(f){return new Promise(function(p,m){s.push([d,f,p,m])>1||a(d,f)})})}function a(d,f){try{!function l(d){d.value instanceof da?Promise.resolve(d.value.v).then(c,u):h(s[0][2],d)}(n[d](f))}catch(p){h(s[0][3],p)}}function c(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function WF(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=i[Symbol.asyncIterator];return e?e.call(i):(i=function bM(i){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&"number"==typeof i.length)return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=i[s](o)).done,o.value)})}}}const MM=i=>i&&"number"==typeof i.length&&"function"!=typeof i;function SM(i){return Jt(null==i?void 0:i.then)}function EM(i){return Jt(i[Ey])}function CM(i){return Symbol.asyncIterator&&Jt(null==i?void 0:i[Symbol.asyncIterator])}function TM(i){return new TypeError(`You provided ${null!==i&&"object"==typeof i?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const AM=function qF(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function DM(i){return Jt(null==i?void 0:i[AM])}function IM(i){return GF(this,arguments,function*(){const t=i.getReader();try{for(;;){const{value:n,done:r}=yield da(t.read());if(r)return yield da(void 0);yield yield da(n)}}finally{t.releaseLock()}})}function RM(i){return Jt(null==i?void 0:i.getReader)}function xs(i){if(i instanceof Cn)return i;if(null!=i){if(EM(i))return function $F(i){return new Cn(e=>{const t=i[Ey]();if(Jt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(i);if(MM(i))return function XF(i){return new Cn(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}(i);if(SM(i))return function ZF(i){return new Cn(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,fM)})}(i);if(CM(i))return PM(i);if(DM(i))return function YF(i){return new Cn(e=>{for(const t of i)if(e.next(t),e.closed)return;e.complete()})}(i);if(RM(i))return function KF(i){return PM(IM(i))}(i)}throw TM(i)}function PM(i){return new Cn(e=>{(function QF(i,e){var t,n,r,s;return ha(this,void 0,void 0,function*(){try{for(t=WF(i);!(n=yield t.next()).done;)if(e.next(n.value),e.closed)return}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(i,e).catch(t=>e.error(t))})}function ws(i,e,t,n=0,r=!1){const s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function Fn(i,e,t=1/0){return Jt(e)?Fn((n,r)=>$t((s,o)=>e(n,s,r,o))(xs(i(n,r))),t):("number"==typeof e&&(t=e),Gn((n,r)=>function JF(i,e,t,n,r,s,o,a){const l=[];let c=0,u=0,h=!1;const d=()=>{h&&!l.length&&!c&&e.complete()},f=m=>c<n?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let g=!1;xs(t(m,u++)).subscribe(Wn(e,y=>{null==r||r(y),s?f(y):e.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){const y=l.shift();o?ws(e,o,()=>p(y)):p(y)}d()}catch(y){e.error(y)}}))};return i.subscribe(Wn(e,f,()=>{h=!0,d()})),()=>{null==a||a()}}(n,r,i,t)))}function Iu(i=1/0){return Fn(ua,i)}const bs=new Cn(i=>i.complete());function Ty(i){return i[i.length-1]}function Ru(i){return function t3(i){return i&&Jt(i.schedule)}(Ty(i))?i.pop():void 0}function LM(i,e=0){return Gn((t,n)=>{t.subscribe(Wn(n,r=>ws(n,i,()=>n.next(r),e),()=>ws(n,i,()=>n.complete(),e),r=>ws(n,i,()=>n.error(r),e)))})}function FM(i,e=0){return Gn((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function OM(i,e){if(!i)throw new Error("Iterable cannot be null");return new Cn(t=>{ws(t,e,()=>{const n=i[Symbol.asyncIterator]();ws(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function jn(i,e){return e?function c3(i,e){if(null!=i){if(EM(i))return function r3(i,e){return xs(i).pipe(FM(e),LM(e))}(i,e);if(MM(i))return function o3(i,e){return new Cn(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}(i,e);if(SM(i))return function s3(i,e){return xs(i).pipe(FM(e),LM(e))}(i,e);if(CM(i))return OM(i,e);if(DM(i))return function a3(i,e){return new Cn(t=>{let n;return ws(t,e,()=>{n=i[AM](),ws(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>Jt(null==n?void 0:n.return)&&n.return()})}(i,e);if(RM(i))return function l3(i,e){return OM(IM(i),e)}(i,e)}throw TM(i)}(i,e):xs(i)}function Qd(i){return i<=0?()=>bs:Gn((e,t)=>{let n=0;e.subscribe(Wn(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Ay(i,e,...t){return!0===e?(i(),null):!1===e?null:e(...t).pipe(Qd(1)).subscribe(()=>i())}function zt(i){for(let e in i)if(i[e]===zt)return e;throw Error("Could not find renamed property on target object.")}function Nt(i){if("string"==typeof i)return i;if(Array.isArray(i))return"["+i.map(Nt).join(", ")+"]";if(null==i)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;const e=i.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Iy(i,e){return null==i||""===i?null===e?"":e:null==e||""===e?i:i+" "+e}const d3=zt({__forward_ref__:zt});function Ry(i){return i.__forward_ref__=Ry,i.toString=function(){return Nt(this())},i}function ct(i){return function NM(i){return"function"==typeof i&&i.hasOwnProperty(d3)&&i.__forward_ref__===Ry}(i)?i():i}class We extends Error{constructor(e,t){super(function Py(i,e){return`NG0${Math.abs(i)}${e?": "+e:""}`}(e,t)),this.code=e}}function ot(i){return"string"==typeof i?i:null==i?"":String(i)}function ci(i){return"function"==typeof i?i.name||i.toString():"object"==typeof i&&null!=i&&"function"==typeof i.type?i.type.name||i.type.toString():ot(i)}function Jd(i,e){const t=e?` in ${e}`:"";throw new We(-201,`No provider for ${ci(i)} found${t}`)}function Li(i,e){null==i&&function Xt(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(null==n?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}(e,i,null,"!=")}function mt(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function ho(i){return{providers:i.providers||[],imports:i.imports||[]}}function Ly(i){return kM(i,ef)||kM(i,zM)}function kM(i,e){return i.hasOwnProperty(e)?i[e]:null}function BM(i){return i&&(i.hasOwnProperty(Fy)||i.hasOwnProperty(v3))?i[Fy]:null}const ef=zt({\u0275prov:zt}),Fy=zt({\u0275inj:zt}),zM=zt({ngInjectableDef:zt}),v3=zt({ngInjectorDef:zt});var st=(()=>((st=st||{})[st.Default=0]="Default",st[st.Host=1]="Host",st[st.Self=2]="Self",st[st.SkipSelf=4]="SkipSelf",st[st.Optional=8]="Optional",st))();let Oy;function fo(i){const e=Oy;return Oy=i,e}function UM(i,e,t){const n=Ly(i);return n&&"root"==n.providedIn?void 0===n.value?n.value=n.factory():n.value:t&st.Optional?null:void 0!==e?e:void Jd(Nt(i),"Injector")}function po(i){return{toString:i}.toString()}var br=(()=>((br=br||{})[br.OnPush=0]="OnPush",br[br.Default=1]="Default",br))(),Mr=(()=>{return(i=Mr||(Mr={}))[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",Mr;var i})();const w3="undefined"!=typeof globalThis&&globalThis,b3="undefined"!=typeof window&&window,M3="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Bt=w3||"undefined"!=typeof global&&global||b3||M3,_l={},Ut=[],tf=zt({\u0275cmp:zt}),Ny=zt({\u0275dir:zt}),ky=zt({\u0275pipe:zt}),VM=zt({\u0275mod:zt}),Ss=zt({\u0275fac:zt}),Pu=zt({__NG_ELEMENT_ID__:zt});let S3=0;function Jn(i){return po(()=>{const t={},n={type:i.type,providersResolver:null,decls:i.decls,vars:i.vars,factory:null,template:i.template||null,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:i.exportAs||null,onPush:i.changeDetection===br.OnPush,directiveDefs:null,pipeDefs:null,selectors:i.selectors||Ut,viewQuery:i.viewQuery||null,features:i.features||null,data:i.data||{},encapsulation:i.encapsulation||Mr.Emulated,id:"c",styles:i.styles||Ut,_:null,setInput:null,schemas:i.schemas||null,tView:null},r=i.directives,s=i.features,o=i.pipes;return n.id+=S3++,n.inputs=jM(i.inputs,t),n.outputs=jM(i.outputs),s&&s.forEach(a=>a(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(HM):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(GM):null,n})}function HM(i){return ti(i)||function mo(i){return i[Ny]||null}(i)}function GM(i){return function pa(i){return i[ky]||null}(i)}const WM={};function fa(i){return po(()=>{const e={type:i.type,bootstrap:i.bootstrap||Ut,declarations:i.declarations||Ut,imports:i.imports||Ut,exports:i.exports||Ut,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null};return null!=i.id&&(WM[i.id]=i.type),e})}function jM(i,e){if(null==i)return _l;const t={};for(const n in i)if(i.hasOwnProperty(n)){let r=i[n],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=n,e&&(e[r]=s)}return t}const ei=Jn;function ti(i){return i[tf]||null}function Ji(i,e){const t=i[VM]||null;if(!t&&!0===e)throw new Error(`Type ${Nt(i)} does not have '\u0275mod' property.`);return t}function Qr(i){return Array.isArray(i)&&"object"==typeof i[1]}function Er(i){return Array.isArray(i)&&!0===i[1]}function Uy(i){return 0!=(8&i.flags)}function of(i){return 2==(2&i.flags)}function af(i){return 1==(1&i.flags)}function Cr(i){return null!==i.template}function I3(i){return 0!=(512&i[2])}function _a(i,e){return i.hasOwnProperty(Ss)?i[Ss]:null}class L3{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function go(){return $M}function $M(i){return i.type.prototype.ngOnChanges&&(i.setInput=O3),F3}function F3(){const i=ZM(this),e=null==i?void 0:i.current;if(e){const t=i.previous;if(t===_l)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function O3(i,e,t,n){const r=ZM(i)||function N3(i,e){return i[XM]=e}(i,{previous:_l,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new L3(l&&l.currentValue,e,o===_l),i[n]=e}go.ngInherit=!0;const XM="__ngSimpleChanges__";function ZM(i){return i[XM]||null}let jy;function an(i){return!!i.listen}const YM={createRenderer:(i,e)=>function qy(){return void 0!==jy?jy:"undefined"!=typeof document?document:void 0}()};function _n(i){for(;Array.isArray(i);)i=i[0];return i}function lf(i,e){return _n(e[i])}function nr(i,e){return _n(e[i.index])}function $y(i,e){return i.data[e]}function Oi(i,e){const t=e[i];return Qr(t)?t:t[0]}function KM(i){return 4==(4&i[2])}function Xy(i){return 128==(128&i[2])}function yo(i,e){return null==e?null:i[e]}function QM(i){i[18]=0}function Zy(i,e){i[5]+=e;let t=i,n=i[3];for(;null!==n&&(1===e&&1===t[5]||-1===e&&0===t[5]);)n[5]+=e,t=n,n=n[3]}const it={lFrame:oS(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function JM(){return it.bindingsEnabled}function fe(){return it.lFrame.lView}function Tt(){return it.lFrame.tView}function cf(i){return it.lFrame.contextLView=i,i[8]}function Tn(){let i=eS();for(;null!==i&&64===i.type;)i=i.parent;return i}function eS(){return it.lFrame.currentTNode}function Jr(i,e){const t=it.lFrame;t.currentTNode=i,t.isParent=e}function Yy(){return it.lFrame.isParent}function Ky(){it.lFrame.isParent=!1}function uf(){return it.isInCheckNoChangesMode}function hf(i){it.isInCheckNoChangesMode=i}function Sl(){return it.lFrame.bindingIndex++}function J3(i,e){const t=it.lFrame;t.bindingIndex=t.bindingRootIndex=i,Qy(e)}function Qy(i){it.lFrame.currentDirectiveIndex=i}function iS(){return it.lFrame.currentQueryIndex}function e0(i){it.lFrame.currentQueryIndex=i}function tO(i){const e=i[1];return 2===e.type?e.declTNode:1===e.type?i[6]:null}function rS(i,e,t){if(t&st.SkipSelf){let r=e,s=i;for(;!(r=r.parent,null!==r||t&st.Host||(r=tO(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,i=s}const n=it.lFrame=sS();return n.currentTNode=e,n.lView=i,!0}function df(i){const e=sS(),t=i[1];it.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function sS(){const i=it.lFrame,e=null===i?null:i.child;return null===e?oS(i):e}function oS(i){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return null!==i&&(i.child=e),e}function aS(){const i=it.lFrame;return it.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}const lS=aS;function ff(){const i=aS();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function hi(){return it.lFrame.selectedIndex}function _o(i){it.lFrame.selectedIndex=i}function pf(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){const s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(i.contentHooks||(i.contentHooks=[])).push(-t,o),a&&((i.contentHooks||(i.contentHooks=[])).push(t,a),(i.contentCheckHooks||(i.contentCheckHooks=[])).push(t,a)),l&&(i.viewHooks||(i.viewHooks=[])).push(-t,l),c&&((i.viewHooks||(i.viewHooks=[])).push(t,c),(i.viewCheckHooks||(i.viewCheckHooks=[])).push(t,c)),null!=u&&(i.destroyHooks||(i.destroyHooks=[])).push(t,u)}}function mf(i,e,t){cS(i,e,3,t)}function gf(i,e,t,n){(3&i[2])===t&&cS(i,e,t,n)}function t0(i,e){let t=i[2];(3&t)===e&&(t&=2047,t+=1,i[2]=t)}function cS(i,e,t,n){const s=null!=n?n:-1,o=e.length-1;let a=0;for(let l=void 0!==n?65535&i[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=n&&a>=n)break}else e[l]<0&&(i[18]+=65536),(a<s||-1==s)&&(uO(i,t,e,l),i[18]=(4294901760&i[18])+l+2),l++}function uO(i,e,t,n){const r=t[n]<0,s=t[n+1],a=i[r?-t[n]:t[n]];if(r){if(i[2]>>11<i[18]>>16&&(3&i[2])===e){i[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class ku{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function yf(i,e,t){const n=an(i);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];n?i.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];r0(o)?n&&i.setProperty(e,o,a):n?i.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function uS(i){return 3===i||4===i||6===i}function r0(i){return 64===i.charCodeAt(0)}function _f(i,e){if(null!==e&&0!==e.length)if(null===i||0===i.length)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){const r=e[n];"number"==typeof r?t=r:0===t||hS(i,t,r,null,-1===t||2===t?e[++n]:null)}}return i}function hS(i,e,t,n,r){let s=0,o=i.length;if(-1===e)o=-1;else for(;s<i.length;){const a=i[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<i.length;){const a=i[s];if("number"==typeof a)break;if(a===t){if(null===n)return void(null!==r&&(i[s+1]=r));if(n===i[s+1])return void(i[s+2]=r)}s++,null!==n&&s++,null!==r&&s++}-1!==o&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),null!==n&&i.splice(s++,0,n),null!==r&&i.splice(s++,0,r)}function dS(i){return-1!==i}function El(i){return 32767&i}function Cl(i,e){let t=function mO(i){return i>>16}(i),n=e;for(;t>0;)n=n[15],t--;return n}let s0=!0;function vf(i){const e=s0;return s0=i,e}let gO=0;function zu(i,e){const t=a0(i,e);if(-1!==t)return t;const n=e[1];n.firstCreatePass&&(i.injectorIndex=e.length,o0(n.data,i),o0(e,null),o0(n.blueprint,null));const r=xf(i,e),s=i.injectorIndex;if(dS(r)){const o=El(r),a=Cl(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function o0(i,e){i.push(0,0,0,0,0,0,0,0,e)}function a0(i,e){return-1===i.injectorIndex||i.parent&&i.parent.injectorIndex===i.injectorIndex||null===e[i.injectorIndex+8]?-1:i.injectorIndex}function xf(i,e){if(i.parent&&-1!==i.parent.injectorIndex)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(n=2===o?s.declTNode:1===o?r[6]:null,null===n)return-1;if(t++,r=r[15],-1!==n.injectorIndex)return n.injectorIndex|t<<16}return-1}function wf(i,e,t){!function yO(i,e,t){let n;"string"==typeof t?n=t.charCodeAt(0)||0:t.hasOwnProperty(Pu)&&(n=t[Pu]),null==n&&(n=t[Pu]=gO++);const r=255&n;e.data[i+(r>>5)]|=1<<r}(i,e,t)}function mS(i,e,t){if(t&st.Optional)return i;Jd(e,"NodeInjector")}function gS(i,e,t,n){if(t&st.Optional&&void 0===n&&(n=null),0==(t&(st.Self|st.Host))){const r=i[9],s=fo(void 0);try{return r?r.get(e,n,t&st.Optional):UM(e,n,t&st.Optional)}finally{fo(s)}}return mS(n,e,t)}function yS(i,e,t,n=st.Default,r){if(null!==i){const s=function wO(i){if("string"==typeof i)return i.charCodeAt(0)||0;const e=i.hasOwnProperty(Pu)?i[Pu]:void 0;return"number"==typeof e?e>=0?255&e:vO:e}(t);if("function"==typeof s){if(!rS(e,i,n))return n&st.Host?mS(r,t,n):gS(e,t,n,r);try{const o=s(n);if(null!=o||n&st.Optional)return o;Jd(t)}finally{lS()}}else if("number"==typeof s){let o=null,a=a0(i,e),l=-1,c=n&st.Host?e[16][6]:null;for((-1===a||n&st.SkipSelf)&&(l=-1===a?xf(i,e):e[a+8],-1!==l&&xS(n,!1)?(o=e[1],a=El(l),e=Cl(l,e)):a=-1);-1!==a;){const u=e[1];if(vS(s,a,u.data)){const h=xO(a,e,t,o,n,c);if(h!==_S)return h}l=e[a+8],-1!==l&&xS(n,e[1].data[a+8]===c)&&vS(s,a,e)?(o=u,a=El(l),e=Cl(l,e)):a=-1}}}return gS(e,t,n,r)}const _S={};function vO(){return new Tl(Tn(),fe())}function xO(i,e,t,n,r,s){const o=e[1],a=o.data[i+8],u=bf(a,o,t,null==n?of(a)&&s0:n!=o&&0!=(3&a.type),r&st.Host&&s===a);return null!==u?Uu(e,o,u,a):_S}function bf(i,e,t,n,r){const s=i.providerIndexes,o=e.data,a=1048575&s,l=i.directiveStart,u=s>>20,d=r?a+u:i.directiveEnd;for(let f=n?a:a+u;f<d;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Cr(f)&&f.type===t)return l}return null}function Uu(i,e,t,n){let r=i[t];const s=e.data;if(function hO(i){return i instanceof ku}(r)){const o=r;o.resolving&&function f3(i,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new We(-200,`Circular dependency in DI detected for ${i}${t}`)}(ci(s[t]));const a=vf(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?fo(o.injectImpl):null;rS(i,n,st.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&function cO(i,e,t){const{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){const o=$M(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(i,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-i,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i,s))}(t,s[t],e)}finally{null!==l&&fo(l),vf(a),o.resolving=!1,lS()}}return r}function vS(i,e,t){return!!(t[e+(i>>5)]&1<<i)}function xS(i,e){return!(i&st.Self||i&st.Host&&e)}class Tl{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return yS(this._tNode,this._lView,e,n,t)}}const Dl="__parameters__";function Rl(i,e,t){return po(()=>{const n=function c0(i){return function(...t){if(i){const n=i(...t);for(const r in n)this[r]=n[r]}}}(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const h=l.hasOwnProperty(Dl)?l[Dl]:Object.defineProperty(l,Dl,{value:[]})[Dl];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}class At{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=mt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const SO=new At("AnalyzeForEntryComponents");function ir(i,e){void 0===e&&(e=i);for(let t=0;t<i.length;t++){let n=i[t];Array.isArray(n)?(e===i&&(e=i.slice(0,t)),ir(n,e)):e!==i&&e.push(n)}return e}function es(i,e){i.forEach(t=>Array.isArray(t)?es(t,e):e(t))}function bS(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Mf(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Ni(i,e,t){let n=Pl(i,e);return n>=0?i[1|n]=t:(n=~n,function TO(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(1===r)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;)i[r]=i[r-2],r--;i[e]=t,i[e+1]=n}}(i,n,e,t)),n}function h0(i,e){const t=Pl(i,e);if(t>=0)return i[1|t]}function Pl(i,e){return function ES(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){const s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}(i,e,1)}const ju={},f0="__NG_DI_FLAG__",Ef="ngTempTokenPath",FO=/\n/gm,TS="__source",NO=zt({provide:String,useValue:zt});let qu;function AS(i){const e=qu;return qu=i,e}function kO(i,e=st.Default){if(void 0===qu)throw new We(203,"");return null===qu?UM(i,void 0,e):qu.get(i,e&st.Optional?null:void 0,e)}function je(i,e=st.Default){return(function x3(){return Oy}()||kO)(ct(i),e)}const BO=je;function p0(i){const e=[];for(let t=0;t<i.length;t++){const n=ct(i[t]);if(Array.isArray(n)){if(0===n.length)throw new We(900,"");let r,s=st.Default;for(let o=0;o<n.length;o++){const a=n[o],l=zO(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(je(r,s))}else e.push(je(n))}return e}function $u(i,e){return i[f0]=e,i.prototype[f0]=e,i}function zO(i){return i[f0]}const Cf=$u(Rl("Inject",i=>({token:i})),-1),xo=$u(Rl("Optional"),8),Xu=$u(Rl("SkipSelf"),4);class kS{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function wo(i){return i instanceof kS?i.changingThisBreaksApplicationSecurity:i}const aN=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,lN=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var vn=(()=>((vn=vn||{})[vn.NONE=0]="NONE",vn[vn.HTML=1]="HTML",vn[vn.STYLE=2]="STYLE",vn[vn.SCRIPT=3]="SCRIPT",vn[vn.URL=4]="URL",vn[vn.RESOURCE_URL=5]="RESOURCE_URL",vn))();function Qu(i){const e=function Ju(){const i=fe();return i&&i[12]}();return e?e.sanitize(vn.URL,i)||"":function Yu(i,e){const t=function iN(i){return i instanceof kS&&i.getTypeName()||null}(i);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}(i,"URL")?wo(i):function If(i){return(i=String(i)).match(aN)||i.match(lN)?i:"unsafe:"+i}(ot(i))}const $S="__ngContext__";function ii(i,e){i[$S]=e}function M0(i){const e=function eh(i){return i[$S]||null}(i);return e?Array.isArray(e)?e:e.lView:null}function E0(i){return i.ngOriginalError}function RN(i,...e){i.error(...e)}class th{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=function IN(i){return i&&i.ngErrorLogger||RN}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&E0(e);for(;t&&E0(t);)t=E0(t);return t||null}}const VN=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Bt))();function QS(i){return i.ownerDocument.defaultView}function ns(i){return i instanceof Function?i():i}var ki=(()=>((ki=ki||{})[ki.Important=1]="Important",ki[ki.DashCase=2]="DashCase",ki))();function T0(i,e){return undefined(i,e)}function nh(i){const e=i[3];return Er(e)?e[3]:e}function A0(i){return i1(i[13])}function D0(i){return i1(i[4])}function i1(i){for(;null!==i&&!Er(i);)i=i[4];return i}function Nl(i,e,t,n,r){if(null!=n){let s,o=!1;Er(n)?s=n:Qr(n)&&(o=!0,n=n[0]);const a=_n(n);0===i&&null!==t?null==r?c1(e,t,a):va(e,t,a,r||null,!0):1===i&&null!==t?va(e,t,a,r||null,!0):2===i?function g1(i,e,t){const n=Pf(i,e);n&&function ek(i,e,t,n){an(i)?i.removeChild(e,t,n):e.removeChild(t)}(i,n,e,t)}(e,a,o):3===i&&e.destroyNode(a),null!=s&&function ik(i,e,t,n,r){const s=t[7];s!==_n(t)&&Nl(e,i,n,s,r);for(let a=10;a<t.length;a++){const l=t[a];ih(l[1],l,i,e,n,s)}}(e,i,s,t,r)}}function R0(i,e,t){if(an(i))return i.createElement(e,t);{const n=null!==t?function U3(i){const e=i.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(t):null;return null===n?i.createElement(e):i.createElementNS(n,e)}}function s1(i,e){const t=i[9],n=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Zy(r,-1)),t.splice(n,1)}function P0(i,e){if(i.length<=10)return;const t=10+e,n=i[t];if(n){const r=n[17];null!==r&&r!==i&&s1(r,n),e>0&&(i[t-1][4]=n[4]);const s=Mf(i,10+e);!function qN(i,e){ih(i,e,e[11],2,null,null),e[0]=null,e[6]=null}(n[1],n);const o=s[19];null!==o&&o.detachView(s[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}function o1(i,e){if(!(256&e[2])){const t=e[11];an(t)&&t.destroyNode&&ih(i,e,t,3,null,null),function ZN(i){let e=i[13];if(!e)return L0(i[1],i);for(;e;){let t=null;if(Qr(e))t=e[13];else{const n=e[10];n&&(t=n)}if(!t){for(;e&&!e[4]&&e!==i;)Qr(e)&&L0(e[1],e),e=e[3];null===e&&(e=i),Qr(e)&&L0(e[1],e),t=e&&e[4]}e=t}}(e)}}function L0(i,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function JN(i,e){let t;if(null!=i&&null!=(t=i.destroyHooks))for(let n=0;n<t.length;n+=2){const r=e[t[n]];if(!(r instanceof ku)){const s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(i,e),function QN(i,e){const t=i.cleanup,n=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):_n(e[o]),l=n[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?n[r=c]():n[r=-c].unsubscribe(),s+=2}else{const o=n[r=t[s+1]];t[s].call(o)}if(null!==n){for(let s=r+1;s<n.length;s++)n[s]();e[7]=null}}(i,e),1===e[1].type&&an(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Er(e[3])){t!==e[3]&&s1(t,e);const n=e[19];null!==n&&n.detachView(i)}}}function a1(i,e,t){return function l1(i,e,t){let n=e;for(;null!==n&&40&n.type;)n=(e=n).parent;if(null===n)return t[0];if(2&n.flags){const r=i.data[n.directiveStart].encapsulation;if(r===Mr.None||r===Mr.Emulated)return null}return nr(n,t)}(i,e.parent,t)}function va(i,e,t,n,r){an(i)?i.insertBefore(e,t,n,r):e.insertBefore(t,n,r)}function c1(i,e,t){an(i)?i.appendChild(e,t):e.appendChild(t)}function u1(i,e,t,n,r){null!==n?va(i,e,t,n,r):c1(i,e,t)}function Pf(i,e){return an(i)?i.parentNode(e):e.parentNode}let f1=function d1(i,e,t){return 40&i.type?nr(i,t):null};function Lf(i,e,t,n){const r=a1(i,n,e),s=e[11],a=function h1(i,e,t){return f1(i,e,t)}(n.parent||e[6],n,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)u1(s,r,t[l],a,!1);else u1(s,r,t,a,!1)}function Ff(i,e){if(null!==e){const t=e.type;if(3&t)return nr(e,i);if(4&t)return O0(-1,i[e.index]);if(8&t){const n=e.child;if(null!==n)return Ff(i,n);{const r=i[e.index];return Er(r)?O0(-1,r):_n(r)}}if(32&t)return T0(e,i)()||_n(i[e.index]);{const n=m1(i,e);return null!==n?Array.isArray(n)?n[0]:Ff(nh(i[16]),n):Ff(i,e.next)}}return null}function m1(i,e){return null!==e?i[16][6].projection[e.projection]:null}function O0(i,e){const t=10+i+1;if(t<e.length){const n=e[t],r=n[1].firstChild;if(null!==r)return Ff(n,r)}return e[7]}function N0(i,e,t,n,r,s,o){for(;null!=t;){const a=n[t.index],l=t.type;if(o&&0===e&&(a&&ii(_n(a),n),t.flags|=4),64!=(64&t.flags))if(8&l)N0(i,e,t.child,n,r,s,!1),Nl(e,i,r,a,s);else if(32&l){const c=T0(t,n);let u;for(;u=c();)Nl(e,i,r,u,s);Nl(e,i,r,a,s)}else 16&l?y1(i,e,n,t,r,s):Nl(e,i,r,a,s);t=o?t.projectionNext:t.next}}function ih(i,e,t,n,r,s){N0(t,n,i.firstChild,e,r,s,!1)}function y1(i,e,t,n,r,s){const o=t[16],l=o[6].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)Nl(e,i,r,l[c],s);else N0(i,e,l,o[3],r,s,!0)}function _1(i,e,t){an(i)?i.setAttribute(e,"style",t):e.style.cssText=t}function k0(i,e,t){an(i)?""===t?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t):e.className=t}function v1(i,e,t){let n=i.length;for(;;){const r=i.indexOf(e,t);if(-1===r)return r;if(0===r||i.charCodeAt(r-1)<=32){const s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}const x1="ng-template";function sk(i,e,t){let n=0;for(;n<i.length;){let r=i[n++];if(t&&"class"===r){if(r=i[n],-1!==v1(r.toLowerCase(),e,0))return!0}else if(1===r){for(;n<i.length&&"string"==typeof(r=i[n++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function w1(i){return 4===i.type&&i.value!==x1}function ok(i,e,t){return e===(4!==i.type||t?i.value:x1)}function ak(i,e,t){let n=4;const r=i.attrs||[],s=function uk(i){for(let e=0;e<i.length;e++)if(uS(i[e]))return e;return i.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&n){if(n=2|1&n,""!==l&&!ok(i,l,t)||""===l&&1===e.length){if(Tr(n))return!1;o=!0}}else{const c=8&n?l:e[++a];if(8&n&&null!==i.attrs){if(!sk(i.attrs,c,t)){if(Tr(n))return!1;o=!0}continue}const h=lk(8&n?"class":l,r,w1(i),t);if(-1===h){if(Tr(n))return!1;o=!0;continue}if(""!==c){let d;d=h>s?"":r[h+1].toLowerCase();const f=8&n?d:null;if(f&&-1!==v1(f,c,0)||2&n&&c!==d){if(Tr(n))return!1;o=!0}}}}else{if(!o&&!Tr(n)&&!Tr(l))return!1;if(o&&Tr(l))continue;o=!1,n=l|1&n}}return Tr(n)||o}function Tr(i){return 0==(1&i)}function lk(i,e,t,n){if(null===e)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===i)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function hk(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){const n=i[t];if("number"==typeof n)return-1;if(n===e)return t;t++}return-1}(e,i)}function b1(i,e,t=!1){for(let n=0;n<e.length;n++)if(ak(i,e[n],t))return!0;return!1}function M1(i,e){return i?":not("+e.trim()+")":e}function fk(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if("string"==typeof o)if(2&n){const a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&n?r+="."+o:4&n&&(r+=" "+o);else""!==r&&!Tr(o)&&(e+=M1(s,r),r=""),n=o,s=s||!Tr(n);t++}return""!==r&&(e+=M1(s,r)),e}const at={};function xn(i){S1(Tt(),fe(),hi()+i,uf())}function S1(i,e,t,n){if(!n)if(3==(3&e[2])){const s=i.preOrderCheckHooks;null!==s&&mf(e,s,t)}else{const s=i.preOrderHooks;null!==s&&gf(e,s,0,t)}_o(t)}function Of(i,e){return i<<17|e<<2}function Ar(i){return i>>17&32767}function B0(i){return 2|i}function Ts(i){return(131068&i)>>2}function z0(i,e){return-131069&i|e<<2}function U0(i){return 1|i}function O1(i,e){const t=i.contentQueries;if(null!==t)for(let n=0;n<t.length;n+=2){const r=t[n],s=t[n+1];if(-1!==s){const o=i.data[s];e0(r),o.contentQueries(2,e[s],s)}}}function rh(i,e,t,n,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|n,QM(u),u[3]=u[15]=i,u[8]=t,u[10]=o||i&&i[10],u[11]=a||i&&i[11],u[12]=l||i&&i[12]||null,u[9]=c||i&&i[9]||null,u[6]=s,u[16]=2==e.type?i[16]:u,u}function kl(i,e,t,n,r){let s=i.data[e];if(null===s)s=function Z0(i,e,t,n,r){const s=eS(),o=Yy(),l=i.data[e]=function Rk(i,e,t,n,r,s){return{type:t,index:n,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,n,r);return null===i.firstChild&&(i.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(i,e,t,n,r),function Q3(){return it.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=n,s.attrs=r;const o=function Nu(){const i=it.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Jr(s,!0),s}function Bl(i,e,t,n){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function sh(i,e,t){df(e);try{const n=i.viewQuery;null!==n&&r_(1,n,t);const r=i.template;null!==r&&N1(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),i.staticContentQueries&&O1(i,e),i.staticViewQueries&&r_(2,i.viewQuery,t);const s=i.components;null!==s&&function Ak(i,e){for(let t=0;t<e.length;t++)Zk(i,e[t])}(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[2]&=-5,ff()}}function zl(i,e,t,n){const r=e[2];if(256==(256&r))return;df(e);const s=uf();try{QM(e),function tS(i){return it.lFrame.bindingIndex=i}(i.bindingStartIndex),null!==t&&N1(i,e,t,2,n);const o=3==(3&r);if(!s)if(o){const c=i.preOrderCheckHooks;null!==c&&mf(e,c,null)}else{const c=i.preOrderHooks;null!==c&&gf(e,c,0,null),t0(e,0)}if(function $k(i){for(let e=A0(i);null!==e;e=D0(e)){if(!e[2])continue;const t=e[9];for(let n=0;n<t.length;n++){const r=t[n],s=r[3];0==(1024&r[2])&&Zy(s,1),r[2]|=1024}}}(e),function qk(i){for(let e=A0(i);null!==e;e=D0(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];Xy(n)&&zl(r,n,r.template,n[8])}}(e),null!==i.contentQueries&&O1(i,e),!s)if(o){const c=i.contentCheckHooks;null!==c&&mf(e,c)}else{const c=i.contentHooks;null!==c&&gf(e,c,1),t0(e,1)}!function Ck(i,e){const t=i.hostBindingOpCodes;if(null!==t)try{for(let n=0;n<t.length;n++){const r=t[n];if(r<0)_o(~r);else{const s=r,o=t[++n],a=t[++n];J3(o,s),a(2,e[s])}}}finally{_o(-1)}}(i,e);const a=i.components;null!==a&&function Tk(i,e){for(let t=0;t<e.length;t++)Xk(i,e[t])}(e,a);const l=i.viewQuery;if(null!==l&&r_(2,l,n),!s)if(o){const c=i.viewCheckHooks;null!==c&&mf(e,c)}else{const c=i.viewHooks;null!==c&&gf(e,c,2),t0(e,2)}!0===i.firstUpdatePass&&(i.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Zy(e[3],-1))}finally{ff()}}function Dk(i,e,t,n){const r=e[10],s=!uf(),o=KM(e);try{s&&!o&&r.begin&&r.begin(),o&&sh(i,e,n),zl(i,e,t,n)}finally{s&&!o&&r.end&&r.end()}}function N1(i,e,t,n,r){const s=hi(),o=2&n;try{_o(-1),o&&e.length>20&&S1(i,e,20,uf()),t(n,r)}finally{_o(s)}}function k1(i,e,t){if(Uy(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=i.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function Y0(i,e,t){!JM()||(function Bk(i,e,t,n){const r=t.directiveStart,s=t.directiveEnd;i.firstCreatePass||zu(t,e),ii(n,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=i.data[a],c=Cr(l);c&&Gk(e,t,l);const u=Uu(e,i,a,t);ii(u,e),null!==o&&Wk(0,a-r,u,l,0,o),c&&(Oi(t.index,e)[8]=u)}}(i,e,t,nr(t,e)),128==(128&t.flags)&&function zk(i,e,t){const n=t.directiveStart,r=t.directiveEnd,o=t.index,a=function eO(){return it.lFrame.currentDirectiveIndex}();try{_o(o);for(let l=n;l<r;l++){const c=i.data[l],u=e[l];Qy(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&j1(c,u)}}finally{_o(-1),Qy(a)}}(i,e,t))}function K0(i,e,t=nr){const n=e.localNames;if(null!==n){let r=e.index+1;for(let s=0;s<n.length;s+=2){const o=n[s+1],a=-1===o?t(e,i):i[o];i[r++]=a}}}function B1(i){const e=i.tView;return null===e||e.incompleteFirstPass?i.tView=Bf(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts):e}function Bf(i,e,t,n,r,s,o,a,l,c){const u=20+n,h=u+r,d=function Ik(i,e){const t=[];for(let n=0;n<e;n++)t.push(n<i?null:at);return t}(u,h),f="function"==typeof c?c():c;return d[1]={type:i,blueprint:d,template:t,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function V1(i,e,t,n){const r=K1(e);null===t?r.push(n):(r.push(t),i.firstCreatePass&&Q1(i).push(n,r.length-1))}function H1(i,e,t){for(let n in i)if(i.hasOwnProperty(n)){const r=i[n];(t=null===t?{}:t).hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}return t}function Q0(i,e,t,n){let r=!1;if(JM()){const s=function Uk(i,e,t){const n=i.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const o=n[s];b1(t,o.selectors,!1)&&(r||(r=[]),wf(zu(t,e),i,o.type),Cr(o)?(q1(i,t),r.unshift(o)):r.push(o))}return r}(i,e,t),o=null===n?null:{"":-1};if(null!==s){r=!0,$1(t,i.data.length,s.length);for(let u=0;u<s.length;u++){const h=s[u];h.providersResolver&&h.providersResolver(h)}let a=!1,l=!1,c=Bl(i,e,s.length,null);for(let u=0;u<s.length;u++){const h=s[u];t.mergedAttrs=_f(t.mergedAttrs,h.hostAttrs),X1(i,t,e,c,h),Hk(c,h,o),null!==h.contentQueries&&(t.flags|=8),(null!==h.hostBindings||null!==h.hostAttrs||0!==h.hostVars)&&(t.flags|=128);const d=h.type.prototype;!a&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t.index),a=!0),!l&&(d.ngOnChanges||d.ngDoCheck)&&((i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function Pk(i,e){const n=e.directiveEnd,r=i.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<n;c++){const u=r[c],h=u.inputs,d=null===s||w1(e)?null:jk(h,s);o.push(d),a=H1(h,c,a),l=H1(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(i,t)}o&&function Vk(i,e,t){if(e){const n=i.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new We(-301,!1);n.push(e[r],s)}}}(t,n,o)}return t.mergedAttrs=_f(t.mergedAttrs,t.attrs),r}function W1(i,e,t,n,r,s){const o=s.hostBindings;if(o){let a=i.hostBindingOpCodes;null===a&&(a=i.hostBindingOpCodes=[]);const l=~e.index;(function kk(i){let e=i.length;for(;e>0;){const t=i[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(n,r,o)}}function j1(i,e){null!==i.hostBindings&&i.hostBindings(1,e)}function q1(i,e){e.flags|=2,(i.components||(i.components=[])).push(e.index)}function Hk(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Cr(e)&&(t[""]=i)}}function $1(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function X1(i,e,t,n,r){i.data[n]=r;const s=r.factory||(r.factory=_a(r.type)),o=new ku(s,Cr(r),null);i.blueprint[n]=o,t[n]=o,W1(i,e,0,n,Bl(i,t,r.hostVars,at),r)}function Gk(i,e,t){const n=nr(e,i),r=B1(t),s=i[10],o=zf(i,rh(i,r,null,t.onPush?64:16,n,e,s,s.createRenderer(n,t),null,null));i[e.index]=o}function Wk(i,e,t,n,r,s){const o=s[e];if(null!==o){const a=n.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],h=o[l++];null!==a?n.setInput(t,h,c,u):t[u]=h}}}function jk(i,e){let t=null,n=0;for(;n<e.length;){const r=e[n];if(0!==r)if(5!==r){if("number"==typeof r)break;i.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,i[r],e[n+1])),n+=2}else n+=2;else n+=4}return t}function Z1(i,e,t,n){return new Array(i,!0,!1,e,null,0,n,t,null,null)}function Xk(i,e){const t=Oi(e,i);if(Xy(t)){const n=t[1];80&t[2]?zl(n,t,n.template,t[8]):t[5]>0&&e_(t)}}function e_(i){for(let n=A0(i);null!==n;n=D0(n))for(let r=10;r<n.length;r++){const s=n[r];if(1024&s[2]){const o=s[1];zl(o,s,o.template,s[8])}else s[5]>0&&e_(s)}const t=i[1].components;if(null!==t)for(let n=0;n<t.length;n++){const r=Oi(t[n],i);Xy(r)&&r[5]>0&&e_(r)}}function Zk(i,e){const t=Oi(e,i),n=t[1];(function Yk(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])})(n,t),sh(n,t,t[8])}function zf(i,e){return i[13]?i[14][4]=e:i[13]=e,i[14]=e,e}function t_(i){for(;i;){i[2]|=64;const e=nh(i);if(I3(i)&&!e)return i;i=e}return null}function i_(i,e,t){const n=e[10];n.begin&&n.begin();try{zl(i,e,i.template,t)}catch(r){throw eE(e,r),r}finally{n.end&&n.end()}}function Y1(i){!function n_(i){for(let e=0;e<i.components.length;e++){const t=i.components[e],n=M0(t),r=n[1];Dk(r,n,r.template,t)}}(i[8])}function r_(i,e,t){e0(0),e(i,t)}const eB=(()=>Promise.resolve(null))();function K1(i){return i[7]||(i[7]=[])}function Q1(i){return i.cleanup||(i.cleanup=[])}function eE(i,e){const t=i[9],n=t?t.get(th,null):null;n&&n.handleError(e)}function tE(i,e,t,n,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=i.data[o];null!==c.setInput?c.setInput(l,r,n,a):l[a]=r}}function As(i,e,t){const n=lf(e,i);!function r1(i,e,t){an(i)?i.setValue(e,t):e.textContent=t}(i[11],n,t)}function Uf(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=Iy(r,a):2==s&&(n=Iy(n,a+": "+e[++o]+";"))}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}const s_=new At("INJECTOR",-1);class nE{get(e,t=ju){if(t===ju){const n=new Error(`NullInjectorError: No provider for ${Nt(e)}!`);throw n.name="NullInjectorError",n}return t}}const o_=new At("Set Injector scope."),oh={},iB={};let a_;function iE(){return void 0===a_&&(a_=new nE),a_}function rE(i,e=null,t=null,n){const r=sE(i,e,t,n);return r._resolveInjectorDefTypes(),r}function sE(i,e=null,t=null,n){return new rB(i,t,e||iE(),n)}class rB{constructor(e,t,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&es(t,a=>this.processProvider(a,e,t)),es([e],a=>this.processInjectorType(a,[],s)),this.records.set(s_,Ul(void 0,this));const o=this.records.get(o_);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:Nt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=ju,n=st.Default){this.assertNotDestroyed();const r=AS(this),s=fo(void 0);try{if(!(n&st.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function dB(i){return"function"==typeof i||"object"==typeof i&&i instanceof At}(e)&&Ly(e);a=l&&this.injectableDefInScope(l)?Ul(l_(e),oh):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&st.Self?iE():this.parent).get(e,t=n&st.Optional&&t===ju?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[Ef]=o[Ef]||[]).unshift(Nt(e)),r)throw o;return function UO(i,e,t,n){const r=i[Ef];throw e[TS]&&r.unshift(e[TS]),i.message=function VO(i,e,t,n=null){i=i&&"\n"===i.charAt(0)&&"\u0275"==i.charAt(1)?i.substr(2):i;let r=Nt(e);if(Array.isArray(e))r=e.map(Nt).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):Nt(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(FO,"\n  ")}`}("\n"+i.message,r,t,n),i.ngTokenPath=r,i[Ef]=null,i}(o,e,"R3InjectorError",this.source)}throw o}finally{fo(s),AS(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((n,r)=>e.push(Nt(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new We(205,!1)}processInjectorType(e,t,n){if(!(e=ct(e)))return!1;let r=BM(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==n.indexOf(o);if(void 0!==s&&(r=BM(s)),null==r)return!1;if(null!=r.imports&&!a){let u;n.push(o);try{es(r.imports,h=>{this.processInjectorType(h,t,n)&&(void 0===u&&(u=[]),u.push(h))})}finally{}if(void 0!==u)for(let h=0;h<u.length;h++){const{ngModule:d,providers:f}=u[h];es(f,p=>this.processProvider(p,d,f||Ut))}}this.injectorDefTypes.add(o);const l=_a(o)||(()=>new o);this.records.set(o,Ul(l,oh));const c=r.providers;if(null!=c&&!a){const u=e;es(c,h=>this.processProvider(h,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,n){let r=Vl(e=ct(e))?e:ct(e&&e.provide);const s=function oB(i,e,t){return aE(i)?Ul(void 0,i.useValue):Ul(function oE(i,e,t){let n;if(Vl(i)){const r=ct(i);return _a(r)||l_(r)}if(aE(i))n=()=>ct(i.useValue);else if(function lB(i){return!(!i||!i.useFactory)}(i))n=()=>i.useFactory(...p0(i.deps||[]));else if(function aB(i){return!(!i||!i.useExisting)}(i))n=()=>je(ct(i.useExisting));else{const r=ct(i&&(i.useClass||i.provide));if(!function uB(i){return!!i.deps}(i))return _a(r)||l_(r);n=()=>new r(...p0(i.deps))}return n}(i),oh)}(e);if(Vl(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Ul(void 0,oh,!0),o.factory=()=>p0(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===oh&&(t.value=iB,t.value=t.factory()),"object"==typeof t.value&&t.value&&function hB(i){return null!==i&&"object"==typeof i&&"function"==typeof i.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=ct(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function l_(i){const e=Ly(i),t=null!==e?e.factory:_a(i);if(null!==t)return t;if(i instanceof At)throw new We(204,!1);if(i instanceof Function)return function sB(i){const e=i.length;if(e>0)throw function Wu(i,e){const t=[];for(let n=0;n<i;n++)t.push(e);return t}(e,"?"),new We(204,!1);const t=function y3(i){const e=i&&(i[ef]||i[zM]);if(e){const t=function _3(i){if(i.hasOwnProperty("name"))return i.name;const e=(""+i).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(i);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(i);return null!==t?()=>t.factory(i):()=>new i}(i);throw new We(204,!1)}function Ul(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function aE(i){return null!==i&&"object"==typeof i&&NO in i}function Vl(i){return"function"==typeof i}let Mi=(()=>{class i{static create(t,n){var r;if(Array.isArray(t))return rE({name:""},n,t,"");{const s=null!==(r=t.name)&&void 0!==r?r:"";return rE({name:s},t.parent,t.providers,s)}}}return i.THROW_IF_NOT_FOUND=ju,i.NULL=new nE,i.\u0275prov=mt({token:i,providedIn:"any",factory:()=>je(s_)}),i.__NG_ELEMENT_ID__=-1,i})();function xB(i,e){pf(M0(i)[1],Tn())}let Vf=null;function Hl(){if(!Vf){const i=Bt.Symbol;if(i&&i.iterator)Vf=i.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(Vf=n)}}}return Vf}function ah(i){return!!d_(i)&&(Array.isArray(i)||!(i instanceof Map)&&Hl()in i)}function d_(i){return null!==i&&("function"==typeof i||"object"==typeof i)}function ri(i,e,t){return!Object.is(i[e],t)&&(i[e]=t,!0)}function zi(i,e,t,n,r,s,o,a){const l=fe(),c=Tt(),u=i+20,h=c.firstCreatePass?function RB(i,e,t,n,r,s,o,a,l){const c=e.consts,u=kl(e,i,4,o||null,yo(c,a));Q0(e,t,u,yo(c,l)),pf(e,u);const h=u.tViews=Bf(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,n,r,s,o):c.data[u];Jr(h,!1);const d=l[11].createComment("");Lf(c,l,d,h),ii(d,l),zf(l,l[u]=Z1(d,l,d,h)),af(h)&&Y0(c,l,h),null!=o&&K0(l,h,a)}function Oe(i,e=st.Default){const t=fe();return null===t?je(i,e):yS(Tn(),t,ct(i),e)}function __(){throw new Error("invalid")}function Rt(i,e,t){const n=fe();return ri(n,Sl(),e)&&function Bi(i,e,t,n,r,s,o,a){const l=nr(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[n])?(tE(i,t,u,n,r),of(e)&&function Fk(i,e){const t=Oi(e,i);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(n=function Lk(i){return"class"===i?"className":"for"===i?"htmlFor":"formaction"===i?"formAction":"innerHtml"===i?"innerHTML":"readonly"===i?"readOnly":"tabindex"===i?"tabIndex":i}(n),r=null!=o?o(r,e.value||"",n):r,an(s)?s.setProperty(l,n,r):r0(n)||(l.setProperty?l.setProperty(n,r):l[n]=r))}(Tt(),function ln(){const i=it.lFrame;return $y(i.tView,i.selectedIndex)}(),n,i,e,n[11],t,!1),Rt}function v_(i,e,t,n,r){const o=r?"class":"style";tE(i,t,e.inputs[o],o,n)}function en(i,e,t,n){const r=fe(),s=Tt(),o=20+i,a=r[11],l=r[o]=R0(a,e,function lO(){return it.lFrame.currentNamespace}()),c=s.firstCreatePass?function JB(i,e,t,n,r,s,o){const a=e.consts,c=kl(e,i,2,r,yo(a,s));return Q0(e,t,c,yo(a,o)),null!==c.attrs&&Uf(c,c.attrs,!1),null!==c.mergedAttrs&&Uf(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,n):s.data[o];Jr(c,!0);const u=c.mergedAttrs;null!==u&&yf(a,l,u);const h=c.classes;null!==h&&k0(a,l,h);const d=c.styles;return null!==d&&_1(a,l,d),64!=(64&c.flags)&&Lf(s,r,l,c),0===function q3(){return it.lFrame.elementDepthCount}()&&ii(l,r),function $3(){it.lFrame.elementDepthCount++}(),af(c)&&(Y0(s,r,c),k1(s,c,r)),null!==n&&K0(r,c),en}function tn(){let i=Tn();Yy()?Ky():(i=i.parent,Jr(i,!1));const e=i;!function X3(){it.lFrame.elementDepthCount--}();const t=Tt();return t.firstCreatePass&&(pf(t,i),Uy(i)&&t.queries.elementEnd(i)),null!=e.classesWithoutHost&&function fO(i){return 0!=(16&i.flags)}(e)&&v_(t,e,fe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function pO(i){return 0!=(32&i.flags)}(e)&&v_(t,e,fe(),e.stylesWithoutHost,!1),tn}function si(i,e,t,n){return en(i,e,t,n),tn(),si}function Wf(i,e,t){const n=fe(),r=Tt(),s=i+20,o=r.firstCreatePass?function ez(i,e,t,n,r){const s=e.consts,o=yo(s,n),a=kl(e,i,8,"ng-container",o);return null!==o&&Uf(a,o,!0),Q0(e,t,a,yo(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,n,e,t):r.data[s];Jr(o,!0);const a=n[s]=n[11].createComment("");return Lf(r,n,a,o),ii(a,n),af(o)&&(Y0(r,n,o),k1(r,o,n)),null!=t&&K0(n,o),Wf}function jf(){let i=Tn();const e=Tt();return Yy()?Ky():(i=i.parent,Jr(i,!1)),e.firstCreatePass&&(pf(e,i),Uy(i)&&e.queries.elementEnd(i)),jf}function qf(){return fe()}function $f(i){return!!i&&"function"==typeof i.then}const HE=function VE(i){return!!i&&"function"==typeof i.subscribe};function Si(i,e,t,n){const r=fe(),s=Tt(),o=Tn();return function WE(i,e,t,n,r,s,o,a){const l=af(n),u=i.firstCreatePass&&Q1(i),h=e[8],d=K1(e);let f=!0;if(3&n.type||a){const g=nr(n,e),y=a?a(g):g,_=d.length,v=a?x=>a(_n(x[n.index])):n.index;if(an(t)){let x=null;if(!a&&l&&(x=function tz(i,e,t,n){const r=i.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===n){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(i,e,r,n.index)),null!==x)(x.__ngLastListenerFn__||x).__ngNextListenerFn__=s,x.__ngLastListenerFn__=s,f=!1;else{s=x_(n,e,h,s,!1);const b=t.listen(y,r,s);d.push(s,b),u&&u.push(r,v,_,_+1)}}else s=x_(n,e,h,s,!0),y.addEventListener(r,s,o),d.push(s),u&&u.push(r,v,_,o)}else s=x_(n,e,h,s,!1);const p=n.outputs;let m;if(f&&null!==p&&(m=p[r])){const g=m.length;if(g)for(let y=0;y<g;y+=2){const S=e[m[y]][m[y+1]].subscribe(s),E=d.length;d.push(s,S),u&&u.push(r,n.index,E,-(E+1))}}}(s,r,r[11],o,i,e,!!t,n),Si}function jE(i,e,t,n){try{return!1!==t(n)}catch(r){return eE(i,r),!1}}function x_(i,e,t,n,r){return function s(o){if(o===Function)return n;const a=2&i.flags?Oi(i.index,e):e;0==(32&e[2])&&t_(a);let l=jE(e,0,n,o),c=s.__ngNextListenerFn__;for(;c;)l=jE(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function Ui(i=1){return function nO(i){return(it.lFrame.contextLView=function iO(i,e){for(;i>0;)e=e[15],i--;return e}(i,it.lFrame.contextLView))[8]}(i)}function tC(i,e,t,n,r){const s=i[t+1],o=null===e;let a=n?Ar(s):Ts(s),l=!1;for(;0!==a&&(!1===l||o);){const u=i[a+1];az(i[a],e)&&(l=!0,i[a+1]=n?U0(u):B0(u)),a=n?Ar(u):Ts(u)}l&&(i[t+1]=n?B0(s):U0(s))}function az(i,e){return null===i||null==e||(Array.isArray(i)?i[1]:i)===e||!(!Array.isArray(i)||"string"!=typeof e)&&Pl(i,e)>=0}function ec(i,e){return function Ir(i,e,t,n){const r=fe(),s=Tt(),o=function Cs(i){const e=it.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}(2);s.firstUpdatePass&&function uC(i,e,t,n){const r=i.data;if(null===r[t+1]){const s=r[hi()],o=function cC(i,e){return e>=i.expandoStartIndex}(i,t);(function pC(i,e){return 0!=(i.flags&(e?16:32))})(s,n)&&null===e&&!o&&(e=!1),e=function gz(i,e,t,n){const r=function Jy(i){const e=it.lFrame.currentDirectiveIndex;return-1===e?null:i[e]}(i);let s=n?e.residualClasses:e.residualStyles;if(null===r)0===(n?e.classBindings:e.styleBindings)&&(t=ch(t=b_(null,i,e,t,n),e.attrs,n),s=null);else{const o=e.directiveStylingLast;if(-1===o||i[o]!==r)if(t=b_(r,i,e,t,n),null===s){let l=function yz(i,e,t){const n=t?e.classBindings:e.styleBindings;if(0!==Ts(n))return i[Ar(n)]}(i,e,n);void 0!==l&&Array.isArray(l)&&(l=b_(null,i,e,l[1],n),l=ch(l,e.attrs,n),function _z(i,e,t,n){i[Ar(t?e.classBindings:e.styleBindings)]=n}(i,e,n,l))}else s=function vz(i,e,t){let n;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)n=ch(n,i[s].hostAttrs,t);return ch(n,e.attrs,t)}(i,e,n)}return void 0!==s&&(n?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,n),function sz(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Ar(o),l=Ts(o);i[n]=t;let u,c=!1;if(Array.isArray(t)){const h=t;u=h[1],(null===u||Pl(h,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const d=Ar(i[a+1]);i[n+1]=Of(d,a),0!==d&&(i[d+1]=z0(i[d+1],n)),i[a+1]=function gk(i,e){return 131071&i|e<<17}(i[a+1],n)}else i[n+1]=Of(a,0),0!==a&&(i[a+1]=z0(i[a+1],n)),a=n;else i[n+1]=Of(l,0),0===a?a=n:i[l+1]=z0(i[l+1],n),l=n;c&&(i[n+1]=B0(i[n+1])),tC(i,u,n,!0),tC(i,u,n,!1),function oz(i,e,t,n,r){const s=r?i.residualClasses:i.residualStyles;null!=s&&"string"==typeof e&&Pl(s,e)>=0&&(t[n+1]=U0(t[n+1]))}(e,u,i,n,s),o=Of(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,n)}}(s,i,o,n),e!==at&&ri(r,o,e)&&function dC(i,e,t,n,r,s,o,a){if(!(3&e.type))return;const l=i.data,c=l[a+1];Xf(function T1(i){return 1==(1&i)}(c)?fC(l,e,t,r,Ts(c),o):void 0)||(Xf(s)||function C1(i){return 2==(2&i)}(c)&&(s=fC(l,null,t,r,a,o)),function rk(i,e,t,n,r){const s=an(i);if(e)r?s?i.addClass(t,n):t.classList.add(n):s?i.removeClass(t,n):t.classList.remove(n);else{let o=-1===n.indexOf("-")?void 0:ki.DashCase;if(null==r)s?i.removeStyle(t,n,o):t.style.removeProperty(n);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=ki.Important),s?i.setStyle(t,n,r,o):t.style.setProperty(n,r,a?"important":"")}}}(n,o,lf(hi(),t),r,s))}(s,s.data[hi()],r,r[11],i,r[o+1]=function bz(i,e){return null==i||("string"==typeof e?i+=e:"object"==typeof i&&(i=Nt(wo(i)))),i}(e,t),n,o)}(i,e,null,!0),ec}function b_(i,e,t,n,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],n=ch(n,s.hostAttrs,r),s!==i);)a++;return null!==i&&(t.directiveStylingLast=a),n}function ch(i,e,t){const n=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===n&&(Array.isArray(i)||(i=void 0===i?[]:["",i]),Ni(i,o,!!t||e[++s]))}return void 0===i?null:i}function fC(i,e,t,n,r,s){const o=null===e;let a;for(;r>0;){const l=i[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u;let d=t[r+1];d===at&&(d=h?Ut:void 0);let f=h?h0(d,n):u===n?d:void 0;if(c&&!Xf(f)&&(f=h0(l,n)),Xf(f)&&(a=f,o))return a;const p=i[r+1];r=o?Ar(p):Ts(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=h0(l,n))}return a}function Xf(i){return void 0!==i}function wa(i,e=""){const t=fe(),n=Tt(),r=i+20,s=n.firstCreatePass?kl(n,r,1,e,null):n.data[r],o=t[r]=function I0(i,e){return an(i)?i.createText(e):i.createTextNode(e)}(t[11],e);Lf(n,t,o,s),Jr(s,!1)}function M_(i){return S_("",i,""),M_}function S_(i,e,t){const n=fe(),r=function Wl(i,e,t,n){return ri(i,Sl(),t)?e+ot(t)+n:at}(n,i,e,t);return r!==at&&As(n,hi(),r),S_}const Zf="en-US";let NC=Zf;class aT{}class jU{resolveComponentFactory(e){throw function WU(i){const e=Error(`No component factory found for ${Nt(i)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=i,e}(e)}}let ph=(()=>{class i{}return i.NULL=new jU,i})();function qU(){return ic(Tn(),fe())}function ic(i,e){return new So(nr(i,e))}let So=(()=>{class i{constructor(t){this.nativeElement=t}}return i.__NG_ELEMENT_ID__=qU,i})();function $U(i){return i instanceof So?i.nativeElement:i}class mh{}let ep=(()=>{class i{}return i.__NG_ELEMENT_ID__=()=>function ZU(){const i=fe(),t=Oi(Tn().index,i);return function XU(i){return i[11]}(Qr(t)?t:i)}(),i})(),YU=(()=>{class i{}return i.\u0275prov=mt({token:i,providedIn:"root",factory:()=>null}),i})();class tp{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const KU=new tp("13.3.1"),R_={};function np(i,e,t,n,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&n.push(_n(s)),Er(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&np(l[1],l,c,n)}const o=t.type;if(8&o)np(i,e,t.child,n);else if(32&o){const a=T0(t,e);let l;for(;l=a();)n.push(l)}else if(16&o){const a=m1(e,t);if(Array.isArray(a))n.push(...a);else{const l=nh(e[16]);np(l[1],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}class gh{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return np(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Er(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(P0(e,n),Mf(t,n))}this._attachedToViewContainer=!1}o1(this._lView[1],this._lView)}onDestroy(e){V1(this._lView[1],this._lView,null,e)}markForCheck(){t_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){i_(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Qk(i,e,t){hf(!0);try{i_(i,e,t)}finally{hf(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new We(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function XN(i,e){ih(i,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new We(902,"");this._appRef=e}}class QU extends gh{constructor(e){super(e),this._view=e}detectChanges(){Y1(this._view)}checkNoChanges(){!function Jk(i){hf(!0);try{Y1(i)}finally{hf(!1)}}(this._view)}get context(){return null}}class cT extends ph{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=ti(e);return new P_(t,this.ngModule)}}function uT(i){const e=[];for(let t in i)i.hasOwnProperty(t)&&e.push({propName:i[t],templateName:t});return e}class P_ extends aT{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function pk(i){return i.map(fk).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return uT(this.componentDef.inputs)}get outputs(){return uT(this.componentDef.outputs)}create(e,t,n,r){const s=(r=r||this.ngModule)?function eV(i,e){return{get:(t,n,r)=>{const s=i.get(t,R_,r);return s!==R_||n===R_?s:e.get(t,n,r)}}}(e,r.injector):e,o=s.get(mh,YM),a=s.get(YU,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=n?function U1(i,e,t){if(an(i))return i.selectRootElement(e,t===Mr.ShadowDom);let n="string"==typeof e?i.querySelector(e):e;return n.textContent="",n}(l,n,this.componentDef.encapsulation):R0(o.createRenderer(null,this.componentDef),c,function JU(i){const e=i.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(c)),h=this.componentDef.onPush?576:528,d=function _E(i,e){return{components:[],scheduler:i||VN,clean:eB,playerHandler:e||null,flags:0}}(),f=Bf(0,null,null,1,0,null,null,null,null,null),p=rh(null,f,d,h,null,null,o,l,a,s);let m,g;df(p);try{const y=function gE(i,e,t,n,r,s){const o=t[1];t[20]=i;const l=kl(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(Uf(l,c,!0),null!==i&&(yf(r,i,c),null!==l.classes&&k0(r,i,l.classes),null!==l.styles&&_1(r,i,l.styles)));const u=n.createRenderer(i,e),h=rh(t,B1(e),null,e.onPush?64:16,t[20],l,n,u,s||null,null);return o.firstCreatePass&&(wf(zu(l,t),o,e.type),q1(o,l),$1(l,t.length,1)),zf(t,h),t[20]=h}(u,this.componentDef,p,o,l);if(u)if(n)yf(l,u,["ng-version",KU.full]);else{const{attrs:_,classes:v}=function mk(i){const e=[],t=[];let n=1,r=2;for(;n<i.length;){let s=i[n];if("string"==typeof s)2===r?""!==s&&e.push(s,i[++n]):8===r&&t.push(s);else{if(!Tr(r))break;r=s}n++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);_&&yf(l,u,_),v&&v.length>0&&k0(l,u,v.join(" "))}if(g=$y(f,20),void 0!==t){const _=g.projection=[];for(let v=0;v<this.ngContentSelectors.length;v++){const x=t[v];_.push(null!=x?Array.from(x):null)}}m=function yE(i,e,t,n,r){const s=t[1],o=function Nk(i,e,t){const n=Tn();i.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),X1(i,n,e,Bl(i,e,1,null),t));const r=Uu(e,i,n.directiveStart,n);ii(r,e);const s=nr(n,e);return s&&ii(s,e),r}(s,t,e);if(n.components.push(o),i[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=Tn();e.contentQueries(1,o,l.directiveStart)}const a=Tn();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(_o(a.index),W1(t[1],a,0,a.directiveStart,a.directiveEnd,e),j1(e,o)),o}(y,this.componentDef,p,d,[xB]),sh(f,p,null)}finally{ff()}return new nV(this.componentType,m,ic(g,p),p,g)}}class nV extends class GU{}{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new QU(r),this.componentType=e}get injector(){return new Tl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Ds{}class hT{}const rc=new Map;class pT extends Ds{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new cT(this);const n=Ji(e);this._bootstrapComponents=ns(n.bootstrap),this._r3Injector=sE(e,t,[{provide:Ds,useValue:this},{provide:ph,useValue:this.componentFactoryResolver}],Nt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Mi.THROW_IF_NOT_FOUND,n=st.Default){return e===Mi||e===Ds||e===s_?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class L_ extends hT{constructor(e){super(),this.moduleType=e,null!==Ji(e)&&function rV(i){const e=new Set;!function t(n){const r=Ji(n,!0),s=r.id;null!==s&&(function dT(i,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${i} - ${Nt(e)} vs ${Nt(e.name)}`)}(s,rc.get(s),n),rc.set(s,n));const o=ns(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(i)}(e)}create(e){return new pT(this.moduleType,e)}}function ip(i,e,t,n){return function mT(i,e,t,n,r,s){const o=e+t;return ri(i,o,r)?function rs(i,e,t){return i[e]=t}(i,o+1,s?n.call(s,r):n(r)):function yh(i,e){const t=i[e];return t===at?void 0:t}(i,o+1)}(fe(),function ui(){const i=it.lFrame;let e=i.bindingRootIndex;return-1===e&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}(),i,e,t,n)}function F_(i){return e=>{setTimeout(i,void 0,e)}}const qn=class wV extends Kr{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){var r,s,o;let a=e,l=t||(()=>null),c=n;if(e&&"object"==typeof e){const h=e;a=null===(r=h.next)||void 0===r?void 0:r.bind(h),l=null===(s=h.error)||void 0===s?void 0:s.bind(h),c=null===(o=h.complete)||void 0===o?void 0:o.bind(h)}this.__isAsync&&(l=F_(l),a&&(a=F_(a)),c&&(c=F_(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof Qi&&e.add(u),u}};function bV(){return this._results[Hl()]()}class O_{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Hl(),n=O_.prototype;n[t]||(n[t]=bV)}get changes(){return this._changes||(this._changes=new qn)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const n=this;n.dirty=!1;const r=ir(e);(this._changesDetected=!function EO(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(n._results,r,t))&&(n._results=r,n.length=r.length,n.last=r[this.length-1],n.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Is=(()=>{class i{}return i.__NG_ELEMENT_ID__=EV,i})();const MV=Is,SV=class extends MV{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=rh(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(n[19]=s.createEmbeddedView(t)),sh(t,n,e),new gh(n)}};function EV(){return rp(Tn(),fe())}function rp(i,e){return 4&i.type?new SV(e,i,ic(i,e)):null}let Pr=(()=>{class i{}return i.__NG_ELEMENT_ID__=CV,i})();function CV(){return bT(Tn(),fe())}const TV=Pr,xT=class extends TV{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ic(this._hostTNode,this._hostLView)}get injector(){return new Tl(this._hostTNode,this._hostLView)}get parentInjector(){const e=xf(this._hostTNode,this._hostLView);if(dS(e)){const t=Cl(e,this._hostLView),n=El(e);return new Tl(t[1].data[n+8],t)}return new Tl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=wT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const r=e.createEmbeddedView(t||{});return this.insert(r,n),r}createComponent(e,t,n,r,s){const o=e&&!function Gu(i){return"function"==typeof i}(e);let a;if(o)a=t;else{const h=t||{};a=h.index,n=h.injector,r=h.projectableNodes,s=h.ngModuleRef}const l=o?e:new P_(ti(e)),c=n||this.parentInjector;if(!s&&null==l.ngModule){const d=(o?c:this.parentInjector).get(Ds,null);d&&(s=d)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const n=e._lView,r=n[1];if(function j3(i){return Er(i[3])}(n)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const h=n[3],d=new xT(h,h[6],h[3]);d.detach(d.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function YN(i,e,t,n){const r=10+n,s=t.length;n>0&&(t[r-1][4]=e),n<s-10?(e[4]=t[r],bS(t,10+n,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function KN(i,e){const t=i[9];e[16]!==e[3][3][16]&&(i[2]=!0),null===t?i[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(i),e[2]|=128}(r,n,o,s);const a=O0(s,o),l=n[11],c=Pf(l,o[7]);return null!==c&&function $N(i,e,t,n,r,s){n[0]=r,n[6]=e,ih(i,n,t,1,r,s)}(r,o[6],l,n,c,a),e.attachToViewContainerRef(),bS(N_(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=wT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=P0(this._lContainer,t);n&&(Mf(N_(this._lContainer),t),o1(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=P0(this._lContainer,t);return n&&null!=Mf(N_(this._lContainer),t)?new gh(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function wT(i){return i[8]}function N_(i){return i[8]||(i[8]=[])}function bT(i,e){let t;const n=e[i.index];if(Er(n))t=n;else{let r;if(8&i.type)r=_n(n);else{const s=e[11];r=s.createComment("");const o=nr(i,e);va(s,Pf(s,o),r,function tk(i,e){return an(i)?i.nextSibling(e):e.nextSibling}(s,o),!1)}e[i.index]=t=Z1(n,e,r,i),zf(e,t)}return new xT(t,i,e)}class k_{constructor(e){this.queryList=e,this.matches=null}clone(){return new k_(this.queryList)}setDirty(){this.queryList.setDirty()}}class B_{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new B_(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==TT(e,t).matches&&this.queries[t].setDirty()}}class MT{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class z_{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const r=null!==t?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,null!==t?t.push(s):t=[s])}return null!==t?new z_(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class U_{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new U_(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){const s=n[r];this.matchTNodeWithReadOption(e,t,IV(t,s)),this.matchTNodeWithReadOption(e,t,bf(t,e,s,!1,!1))}else n===Is?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,bf(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===So||r===Pr||r===Is&&4&t.type)this.addMatch(t.index,-2);else{const s=bf(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function IV(i,e){const t=i.localNames;if(null!==t)for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1];return null}function PV(i,e,t,n){return-1===t?function RV(i,e){return 11&i.type?ic(i,e):4&i.type?rp(i,e):null}(e,i):-2===t?function LV(i,e,t){return t===So?ic(e,i):t===Is?rp(e,i):t===Pr?bT(e,i):void 0}(i,e,n):Uu(i,i[1],t,e)}function ST(i,e,t,n){const r=e[19].queries[n];if(null===r.matches){const s=i.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:PV(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function V_(i,e,t,n){const r=i.queries.getByIndex(t),s=r.matches;if(null!==s){const o=ST(i,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)n.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let h=10;h<u.length;h++){const d=u[h];d[17]===d[3]&&V_(d[1],d,c,n)}if(null!==u[9]){const h=u[9];for(let d=0;d<h.length;d++){const f=h[d];V_(f[1],f,c,n)}}}}}return n}function Rs(i){const e=fe(),t=Tt(),n=iS();e0(n+1);const r=TT(t,n);if(i.dirty&&KM(e)===(2==(2&r.metadata.flags))){if(null===r.matches)i.reset([]);else{const s=r.crossesNgTemplate?V_(t,e,n,[]):ST(t,e,r,n);i.reset(s,$U),i.notifyOnChanges()}return!0}return!1}function Ma(i,e,t){const n=Tt();n.firstCreatePass&&(function CT(i,e,t){null===i.queries&&(i.queries=new z_),i.queries.track(new U_(e,t))}(n,new MT(i,e,t),-1),2==(2&e)&&(n.staticViewQueries=!0)),function ET(i,e,t){const n=new O_(4==(4&t));V1(i,e,n,n.destroy),null===e[19]&&(e[19]=new B_),e[19].queries.push(new k_(n))}(n,fe(),e)}function Ps(){return function FV(i,e){return i[19].queries[e].queryList}(fe(),iS())}function TT(i,e){return i.queries.getByIndex(e)}function ap(...i){}const X_=new At("Application Initializer");let Z_=(()=>{class i{constructor(t){this.appInits=t,this.resolve=ap,this.reject=ap,this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],n=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if($f(s))t.push(s);else if(HE(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),0===t.length&&n(),this.initialized=!0}}return i.\u0275fac=function(t){return new(t||i)(je(X_,8))},i.\u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const xh=new At("AppId",{providedIn:"root",factory:function WT(){return`${Y_()}${Y_()}${Y_()}`}});function Y_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const jT=new At("Platform Initializer"),K_=new At("Platform ID"),qT=new At("appBootstrapListener");let $T=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const Eo=new At("LocaleId",{providedIn:"root",factory:()=>BO(Eo,st.Optional|st.SkipSelf)||function JV(){return"undefined"!=typeof $localize&&$localize.locale||Zf}()});class t4{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let XT=(()=>{class i{compileModuleSync(t){return new L_(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const n=this.compileModuleSync(t),s=ns(Ji(t).declarations).reduce((o,a)=>{const l=ti(a);return l&&o.push(new P_(l)),o},[]);return new t4(n,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const i4=(()=>Promise.resolve(0))();function Q_(i){"undefined"==typeof Zone?i4.then(()=>{i&&i.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",i)}class nn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qn(!1),this.onMicrotaskEmpty=new qn(!1),this.onStable=new qn(!1),this.onError=new qn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function r4(){let i=Bt.requestAnimationFrame,e=Bt.cancelAnimationFrame;if("undefined"!=typeof Zone&&i&&e){const t=i[Zone.__symbol__("OriginalDelegate")];t&&(i=t);const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function a4(i){const e=()=>{!function o4(i){i.isCheckStableRunning||-1!==i.lastRequestAnimationFrameId||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Bt,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,ev(i),i.isCheckStableRunning=!0,J_(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),ev(i))}(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{try{return ZT(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||i.shouldCoalesceRunChangeDetection)&&e(),YT(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return ZT(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),YT(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&("microTask"==s.change?(i._hasPendingMicrotasks=s.microTask,ev(i),J_(i)):"macroTask"==s.change&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!nn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(nn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,s4,ap,ap);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const s4={};function J_(i){if(0==i._nesting&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function ev(i){i.hasPendingMicrotasks=!!(i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&-1!==i.lastRequestAnimationFrameId)}function ZT(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function YT(i){i._nesting--,J_(i)}class l4{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qn,this.onMicrotaskEmpty=new qn,this.onStable=new qn,this.onError=new qn}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}}let tv=(()=>{class i{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{nn.assertNotInAngularZone(),Q_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Q_(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(n=>!n.updateCb||!n.updateCb(t)||(clearTimeout(n.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,n,r){let s=-1;n&&n>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},n)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,n,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,n,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,n,r){return[]}}return i.\u0275fac=function(t){return new(t||i)(je(nn))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),KT=(()=>{class i{constructor(){this._applications=new Map,nv.addToWindow(this)}registerApplication(t,n){this._applications.set(t,n)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,n=!0){return nv.findTestabilityInTree(this,t,n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();class c4{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Lr,nv=new c4;const QT=new At("AllowMultipleToken");class JT{constructor(e,t){this.name=e,this.token=t}}function eA(i,e,t=[]){const n=`Platform: ${e}`,r=new At(n);return(s=[])=>{let o=tA();if(!o||o.injector.get(QT,!1))if(i)i(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:o_,useValue:"platform"});!function f4(i){if(Lr&&!Lr.destroyed&&!Lr.injector.get(QT,!1))throw new We(400,"");Lr=i.get(nA);const e=i.get(jT,null);e&&e.forEach(t=>t())}(Mi.create({providers:a,name:n}))}return function p4(i){const e=tA();if(!e)throw new We(401,"");return e}()}}function tA(){return Lr&&!Lr.destroyed?Lr:null}let nA=(()=>{class i{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,n){const a=function m4(i,e){let t;return t="noop"===i?new l4:("zone.js"===i?void 0:i)||new nn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(n?n.ngZone:void 0,{ngZoneEventCoalescing:n&&n.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:n&&n.ngZoneRunCoalescing||!1}),l=[{provide:nn,useValue:a}];return a.run(()=>{const c=Mi.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),h=u.injector.get(th,null);if(!h)throw new We(402,"");return a.runOutsideAngular(()=>{const d=a.onError.subscribe({next:f=>{h.handleError(f)}});u.onDestroy(()=>{rv(this._modules,u),d.unsubscribe()})}),function g4(i,e,t){try{const n=t();return $f(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}(h,a,()=>{const d=u.injector.get(Z_);return d.runInitializers(),d.donePromise.then(()=>(function $z(i){Li(i,"Expected localeId to be defined"),"string"==typeof i&&(NC=i.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Eo,Zf)||Zf),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,n=[]){const r=iA({},n);return function h4(i,e,t){const n=new L_(t);return Promise.resolve(n)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const n=t.injector.get(iv);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>n.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new We(403,"");t.instance.ngDoBootstrap(n)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new We(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return i.\u0275fac=function(t){return new(t||i)(je(Mi))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();function iA(i,e){return Array.isArray(e)?e.reduce(iA,i):Object.assign(Object.assign({},i),e)}let iv=(()=>{class i{constructor(t,n,r,s,o){this._zone=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new Cn(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new Cn(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{nn.assertNotInAngularZone(),Q_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const h=this._zone.onUnstable.subscribe(()=>{nn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),h.unsubscribe()}});this.isStable=function u3(...i){const e=Ru(i),t=function i3(i,e){return"number"==typeof Ty(i)?i.pop():e}(i,1/0),n=i;return n.length?1===n.length?xs(n[0]):Iu(t)(jn(n,e)):bs}(a,l.pipe(function h3(i={}){const{connector:e=(()=>new Kr),resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o=null,a=null,l=null,c=0,u=!1,h=!1;const d=()=>{null==a||a.unsubscribe(),a=null},f=()=>{d(),o=l=null,u=h=!1},p=()=>{const m=o;f(),null==m||m.unsubscribe()};return Gn((m,g)=>{c++,!h&&!u&&d();const y=l=null!=l?l:e();g.add(()=>{c--,0===c&&!h&&!u&&(a=Ay(p,r))}),y.subscribe(g),o||(o=new Yd({next:_=>y.next(_),error:_=>{h=!0,d(),a=Ay(f,t,_),y.error(_)},complete:()=>{u=!0,d(),a=Ay(f,n),y.complete()}}),jn(m).subscribe(o))})(s)}}()))}bootstrap(t,n){if(!this._initStatus.done)throw new We(405,"");let r;r=t instanceof aT?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function d4(i){return i.isBoundToModule}(r)?void 0:this._injector.get(Ds),a=r.create(Mi.NULL,[],n||r.selector,s),l=a.location.nativeElement,c=a.injector.get(tv,null),u=c&&a.injector.get(KT);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),rv(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new We(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){const n=t;rv(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(qT,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return i.\u0275fac=function(t){return new(t||i)(je(nn),je(Mi),je(th),je(ph),je(Z_))},i.\u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function rv(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}let sA=!0,lp=(()=>{class i{}return i.__NG_ELEMENT_ID__=v4,i})();function v4(i){return function x4(i,e,t){if(of(i)&&!t){const n=Oi(i.index,e);return new gh(n,n)}return 47&i.type?new gh(e[16],e):null}(Tn(),fe(),16==(16&i))}class uA{constructor(){}supports(e){return ah(e)}create(e){return new C4(e)}}const E4=(i,e)=>e;class C4{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||E4}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){const o=!n||t&&t.currentIndex<dA(n,r,s)?t:n,a=dA(o,r,s),l=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let d=0;d<c;d++){const f=d<s.length?s[d]:s[d]=0,p=f+d;u<=p&&p<c&&(s[d]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!ah(e))throw new We(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,n=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),n=!0),t=t._next}else r=0,function IB(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{const t=i[Hl()]();let n;for(;!(n=t.next()).done;)e(n.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),n=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new T4(t,n),s,r),e}_verifyReinsertion(e,t,n,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new hA),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new hA),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class T4{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class A4{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class hA{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new A4,this.map.set(t,n)),n.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function dA(i,e,t){const n=i.previousIndex;if(null===n)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}class fA{constructor(){}supports(e){return e instanceof Map||d_(e)}create(){return new D4}}class D4{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||d_(e)))throw new We(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(n,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,n),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,n);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let n=t;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const n=new I4(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class I4{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function pA(){return new hp([new uA])}let hp=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(null!=n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||pA()),deps:[[i,new Xu,new xo]]}}find(t){const n=this.factories.find(r=>r.supports(t));if(null!=n)return n;throw new We(901,"")}}return i.\u0275prov=mt({token:i,providedIn:"root",factory:pA}),i})();function mA(){return new wh([new fA])}let wh=(()=>{class i{constructor(t){this.factories=t}static create(t,n){if(n){const r=n.factories.slice();t=t.concat(r)}return new i(t)}static extend(t){return{provide:i,useFactory:n=>i.create(t,n||mA()),deps:[[i,new Xu,new xo]]}}find(t){const n=this.factories.find(s=>s.supports(t));if(n)return n;throw new We(901,"")}}return i.\u0275prov=mt({token:i,providedIn:"root",factory:mA}),i})();const L4=eA(null,"core",[{provide:K_,useValue:"unknown"},{provide:nA,deps:[Mi]},{provide:KT,deps:[]},{provide:$T,deps:[]}]);let F4=(()=>{class i{constructor(t){}}return i.\u0275fac=function(t){return new(t||i)(je(iv))},i.\u0275mod=fa({type:i}),i.\u0275inj=ho({}),i})(),dp=null;function Co(){return dp}const Ei=new At("DocumentToken");let Ea=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:function(){return function B4(){return je(gA)}()},providedIn:"platform"}),i})();const z4=new At("Location Initialized");let gA=(()=>{class i extends Ea{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Co().getBaseHref(this._doc)}onPopState(t){const n=Co().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Co().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){yA()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){yA()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(je(Ei))},i.\u0275prov=mt({token:i,factory:function(){return function U4(){return new gA(je(Ei))}()},providedIn:"platform"}),i})();function yA(){return!!window.history.pushState}function cv(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function _A(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function Ls(i){return i&&"?"!==i[0]?"?"+i:i}let oc=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:function(){return function V4(i){const e=je(Ei).location;return new vA(je(Ea),e&&e.origin||"")}()},providedIn:"root"}),i})();const uv=new At("appBaseHref");let vA=(()=>{class i extends oc{constructor(t,n){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return cv(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+Ls(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const o=this.prepareExternalUrl(r+Ls(s));this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){const o=this.prepareExternalUrl(r+Ls(s));this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(je(Ea),je(uv,8))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),H4=(()=>{class i extends oc{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=cv(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let o=this.prepareExternalUrl(r+Ls(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,n,o)}replaceState(t,n,r,s){let o=this.prepareExternalUrl(r+Ls(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(je(Ea),je(uv,8))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),hv=(()=>{class i{constructor(t,n){this._subject=new qn,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=_A(xA(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+Ls(n))}normalize(t){return i.stripTrailingSlash(function W4(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,xA(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ls(n)),r)}replaceState(t,n="",r=null){this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ls(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformStrategy).historyGo)||void 0===r||r.call(n,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=Ls,i.joinWithSlash=cv,i.stripTrailingSlash=_A,i.\u0275fac=function(t){return new(t||i)(je(oc),je(Ea))},i.\u0275prov=mt({token:i,factory:function(){return function G4(){return new hv(je(oc),je(Ea))}()},providedIn:"root"}),i})();function xA(i){return i.replace(/\/index.html$/,"")}let DA=(()=>{class i{constructor(t,n,r,s){this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(ah(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachChangedItem(n=>this._toggleClass(n.key,n.currentValue)),t.forEachRemovedItem(n=>{n.previousValue&&this._toggleClass(n.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(n=>{if("string"!=typeof n.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Nt(n.item)}`);this._toggleClass(n.item,!0)}),t.forEachRemovedItem(n=>this._toggleClass(n.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!0)):Object.keys(t).forEach(n=>this._toggleClass(n,!!t[n])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(n=>this._toggleClass(n,!1)):Object.keys(t).forEach(n=>this._toggleClass(n,!1)))}_toggleClass(t,n){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{n?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return i.\u0275fac=function(t){return new(t||i)(Oe(hp),Oe(wh),Oe(So),Oe(ep))},i.\u0275dir=ei({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),i})();class DH{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Sh=(()=>{class i{constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new DH(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)n.remove(null===s?void 0:s);else if(null!==s){const a=n.get(s);n.move(a,o),IA(a,r)}});for(let r=0,s=n.length;r<s;r++){const a=n.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{IA(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(Oe(Pr),Oe(Is),Oe(hp))},i.\u0275dir=ei({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function IA(i,e){i.context.$implicit=e.item}let bp=(()=>{class i{constructor(t,n){this._viewContainer=t,this._context=new IH,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){RA("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){RA("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(Oe(Pr),Oe(Is))},i.\u0275dir=ei({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),i})();class IH{constructor(){this.$implicit=null,this.ngIf=null}}function RA(i,e){if(e&&!e.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${Nt(e)}'.`)}class wv{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Mp=(()=>{class i{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const n=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||n,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),n}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let n=0;n<this._defaultViews.length;n++)this._defaultViews[n].enforceState(t)}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275dir=ei({type:i,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),i})(),PA=(()=>{class i{constructor(t,n,r){this.ngSwitch=r,r._addCase(),this._view=new wv(t,n)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return i.\u0275fac=function(t){return new(t||i)(Oe(Pr),Oe(Is),Oe(Mp,9))},i.\u0275dir=ei({type:i,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),i})(),bv=(()=>{class i{constructor(t,n,r){this._ngEl=t,this._differs=n,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,n){const[r,s]=t.split(".");null!=(n=null!=n&&s?`${n}${s}`:n)?this._renderer.setStyle(this._ngEl.nativeElement,r,n):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(t){t.forEachRemovedItem(n=>this._setStyle(n.key,null)),t.forEachAddedItem(n=>this._setStyle(n.key,n.currentValue)),t.forEachChangedItem(n=>this._setStyle(n.key,n.currentValue))}}return i.\u0275fac=function(t){return new(t||i)(Oe(So),Oe(wh),Oe(ep))},i.\u0275dir=ei({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),i})(),t5=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=fa({type:i}),i.\u0275inj=ho({}),i})();let s5=(()=>{class i{}return i.\u0275prov=mt({token:i,providedIn:"root",factory:()=>new o5(je(Ei),window)}),i})();class o5{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function a5(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=NA(this.window.history)||NA(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function NA(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Ev extends class c5 extends class k4{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function N4(i){dp||(dp=i)}(new Ev)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function u5(){return Eh=Eh||document.querySelector("base"),Eh?Eh.getAttribute("href"):null}();return null==t?null:function h5(i){Sp=Sp||document.createElement("a"),Sp.setAttribute("href",i);const e=Sp.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Eh=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function TH(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}(document.cookie,e)}}let Sp,Eh=null;const kA=new At("TRANSITION_ID"),f5=[{provide:X_,useFactory:function d5(i,e,t){return()=>{t.get(Z_).donePromise.then(()=>{const n=Co(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[kA,Ei,Mi],multi:!0}];class Cv{static init(){!function u4(i){nv=i}(new Cv)}addToWindow(e){Bt.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},Bt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Bt.getAllAngularRootElements=()=>e.getAllRootElements(),Bt.frameworkStabilizers||(Bt.frameworkStabilizers=[]),Bt.frameworkStabilizers.push(n=>{const r=Bt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&n(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?Co().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let p5=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const Ep=new At("EventManagerPlugins");let Cp=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(je(Ep),je(nn))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();class BA{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Co().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let zA=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),Ch=(()=>{class i extends zA{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(n.appendChild(o))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(UA),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(UA))}}return i.\u0275fac=function(t){return new(t||i)(je(Ei))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();function UA(i){Co().remove(i)}const Tv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Av=/%COMP%/g;function Tp(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?Tp(i,r,t):(r=r.replace(Av,i),t.push(r))}return t}function GA(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let Ap=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Dv(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case Mr.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new x5(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case Mr.ShadowDom:return new w5(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=Tp(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(je(Cp),je(Ch),je(xh))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();class Dv{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Tv[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=Tv[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Tv[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(ki.DashCase|ki.Important)?e.style.setProperty(t,n,r&ki.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&ki.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,GA(n)):this.eventManager.addEventListener(e,t,GA(n))}}class x5 extends Dv{constructor(e,t,n,r){super(e),this.component=n;const s=Tp(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function y5(i){return"_ngcontent-%COMP%".replace(Av,i)}(r+"-"+n.id),this.hostAttr=function _5(i){return"_nghost-%COMP%".replace(Av,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class w5 extends Dv{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Tp(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let b5=(()=>{class i extends BA{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(je(Ei))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const jA=["alt","control","meta","shift"],S5={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qA={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},E5={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let C5=(()=>{class i extends BA{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),o=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Co().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let o="";if(jA.forEach(l=>{const c=n.indexOf(l);c>-1&&(n.splice(c,1),o+=l+".")}),o+=s,0!=n.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let n="",r=function T5(i){let e=i.key;if(null==e){if(e=i.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===i.location&&qA.hasOwnProperty(e)&&(e=qA[e]))}return S5[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),jA.forEach(s=>{s!=r&&E5[s](t)&&(n+=s+".")}),n+=r,n}static eventCallback(t,n,r){return s=>{i.getEventFullKey(s)===t&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(je(Ei))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const R5=eA(L4,"browser",[{provide:K_,useValue:"browser"},{provide:jT,useValue:function A5(){Ev.makeCurrent(),Cv.init()},multi:!0},{provide:Ei,useFactory:function I5(){return function V3(i){jy=i}(document),document},deps:[]}]),P5=[{provide:o_,useValue:"root"},{provide:th,useFactory:function D5(){return new th},deps:[]},{provide:Ep,useClass:b5,multi:!0,deps:[Ei,nn,K_]},{provide:Ep,useClass:C5,multi:!0,deps:[Ei]},{provide:Ap,useClass:Ap,deps:[Cp,Ch,xh]},{provide:mh,useExisting:Ap},{provide:zA,useExisting:Ch},{provide:Ch,useClass:Ch,deps:[Ei]},{provide:tv,useClass:tv,deps:[nn]},{provide:Cp,useClass:Cp,deps:[Ep,nn]},{provide:class l5{},useClass:p5,deps:[]}];let $A=(()=>{class i{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:i,providers:[{provide:xh,useValue:t.appId},{provide:kA,useExisting:xh},f5]}}}return i.\u0275fac=function(t){return new(t||i)(je(i,12))},i.\u0275mod=fa({type:i}),i.\u0275inj=ho({providers:P5,imports:[t5,F4]}),i})();function dt(...i){return jn(i,Ru(i))}"undefined"!=typeof window&&window;class Nr extends Kr{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const{isArray:G5}=Array,{getPrototypeOf:W5,prototype:j5,keys:q5}=Object;const{isArray:Z5}=Array;function J5(...i){const e=Ru(i),t=function n3(i){return Jt(Ty(i))?i.pop():void 0}(i),{args:n,keys:r}=function $5(i){if(1===i.length){const e=i[0];if(G5(e))return{args:e,keys:null};if(function X5(i){return i&&"object"==typeof i&&W5(i)===j5}(e)){const t=q5(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}(i);if(0===n.length)return jn([],e);const s=new Cn(function e8(i,e,t=ua){return n=>{YA(e,()=>{const{length:r}=i,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)YA(e,()=>{const c=jn(i[l],e);let u=!1;c.subscribe(Wn(n,h=>{s[l]=h,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}(n,e,r?o=>function Q5(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}(r,o):ua));return t?s.pipe(function K5(i){return $t(e=>function Y5(i,e){return Z5(e)?i(...e):i(e)}(i,e))}(t)):s}function YA(i,e,t){i?ws(t,i,e):e()}function Dp(i,e){const t=Jt(i)?i:()=>i,n=r=>r.error(t());return new Cn(e?r=>e.schedule(n,0,r):n)}const Ip=_y(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function Rv(...i){return function t8(){return Iu(1)}()(jn(i,Ru(i)))}function KA(i){return new Cn(e=>{xs(i()).subscribe(e)})}function QA(){return Gn((i,e)=>{let t=null;i._refCount++;const n=Wn(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class n8 extends Cn{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,_M(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Qi;const t=this.getSubject();e.add(this.source.subscribe(Wn(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Qi.EMPTY)}return e}refCount(){return QA()(this)}}function Ca(i,e){return Gn((t,n)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&n.complete();t.subscribe(Wn(n,l=>{null==r||r.unsubscribe();let c=0;const u=s++;xs(i(l,u)).subscribe(r=Wn(n,h=>n.next(e?e(l,h,u,c++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function r8(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(Wn(o,u=>{const h=c++;l=a?i(l,u,h):(a=!0,u),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function JA(i,e){return Gn(r8(i,e,arguments.length>=2,!0))}function ac(i,e){return Gn((t,n)=>{let r=0;t.subscribe(Wn(n,s=>i.call(e,s,r++)&&n.next(s)))})}function Ao(i){return Gn((e,t)=>{let s,n=null,r=!1;n=e.subscribe(Wn(t,void 0,void 0,o=>{s=xs(i(o,Ao(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function Th(i,e){return Jt(e)?Fn(i,e,1):Fn(i,1)}function Pv(i){return i<=0?()=>bs:Gn((e,t)=>{let n=[];e.subscribe(Wn(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function eD(i=s8){return Gn((e,t)=>{let n=!1;e.subscribe(Wn(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function s8(){return new Ip}function tD(i){return Gn((e,t)=>{let n=!1;e.subscribe(Wn(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function lc(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ac((r,s)=>i(r,s,n)):ua,Qd(1),t?tD(e):eD(()=>new Ip))}function Vi(i,e,t){const n=Jt(i)||e||t?{next:i,error:e,complete:t}:i;return n?Gn((r,s)=>{var o;null===(o=n.subscribe)||void 0===o||o.call(n);let a=!0;r.subscribe(Wn(s,l=>{var c;null===(c=n.next)||void 0===c||c.call(n,l),s.next(l)},()=>{var l;a=!1,null===(l=n.complete)||void 0===l||l.call(n),s.complete()},l=>{var c;a=!1,null===(c=n.error)||void 0===c||c.call(n,l),s.error(l)},()=>{var l,c;a&&(null===(l=n.unsubscribe)||void 0===l||l.call(n)),null===(c=n.finalize)||void 0===c||c.call(n)}))}):ua}class Os{constructor(e,t){this.id=e,this.url=t}}class Lv extends Os{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ah extends Os{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class nD extends Os{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class l8 extends Os{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class c8 extends Os{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class u8 extends Os{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class h8 extends Os{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class d8 extends Os{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class f8 extends Os{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class iD{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class rD{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class p8{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class m8{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class g8{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class y8{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class sD{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const yt="primary";class _8{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function cc(i){return new _8(i)}const oD="ngNavigationCancelingError";function Fv(i){const e=Error("NavigationCancelingError: "+i);return e[oD]=!0,e}function x8(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function as(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!aD(i[r],e[r]))return!1;return!0}function aD(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function lD(i){return Array.prototype.concat.apply([],i)}function cD(i){return i.length>0?i[i.length-1]:null}function $n(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function ls(i){return HE(i)?i:$f(i)?jn(Promise.resolve(i)):dt(i)}const M8={exact:function dD(i,e,t){if(!Aa(i.segments,e.segments)||!Rp(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!dD(i.children[n],e.children[n],t))return!1;return!0},subset:fD},uD={exact:function S8(i,e){return as(i,e)},subset:function E8(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>aD(i[t],e[t]))},ignored:()=>!0};function hD(i,e,t){return M8[t.paths](i.root,e.root,t.matrixParams)&&uD[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function fD(i,e,t){return pD(i,e,e.segments,t)}function pD(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!Aa(r,t)||e.hasChildren()||!Rp(r,t,n))}if(i.segments.length===t.length){if(!Aa(i.segments,t)||!Rp(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!fD(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(Aa(i.segments,r)&&Rp(i.segments,r,n)&&i.children[yt])&&pD(i.children[yt],e,s,n)}}function Rp(i,e,t){return e.every((n,r)=>uD[t](i[r].parameters,n.parameters))}class Ta{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cc(this.queryParams)),this._queryParamMap}toString(){return A8.serialize(this)}}class bt{constructor(e,t){this.segments=e,this.children=t,this.parent=null,$n(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Pp(this)}}class Dh{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=cc(this.parameters)),this._parameterMap}toString(){return vD(this)}}function Aa(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}class mD{}class gD{parse(e){const t=new k8(e);return new Ta(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Ih(e.root,!0)}`,n=function R8(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${Lp(t)}=${Lp(r)}`).join("&"):`${Lp(t)}=${Lp(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${n}${"string"==typeof e.fragment?`#${function D8(i){return encodeURI(i)}(e.fragment)}`:""}`}}const A8=new gD;function Pp(i){return i.segments.map(e=>vD(e)).join("/")}function Ih(i,e){if(!i.hasChildren())return Pp(i);if(e){const t=i.children[yt]?Ih(i.children[yt],!1):"",n=[];return $n(i.children,(r,s)=>{s!==yt&&n.push(`${s}:${Ih(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function T8(i,e){let t=[];return $n(i.children,(n,r)=>{r===yt&&(t=t.concat(e(n,r)))}),$n(i.children,(n,r)=>{r!==yt&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===yt?[Ih(i.children[yt],!1)]:[`${r}:${Ih(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[yt]?`${Pp(i)}/${t[0]}`:`${Pp(i)}/(${t.join("//")})`}}function yD(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Lp(i){return yD(i).replace(/%3B/gi,";")}function Ov(i){return yD(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Fp(i){return decodeURIComponent(i)}function _D(i){return Fp(i.replace(/\+/g,"%20"))}function vD(i){return`${Ov(i.path)}${function I8(i){return Object.keys(i).map(e=>`;${Ov(e)}=${Ov(i[e])}`).join("")}(i.parameters)}`}const P8=/^[^\/()?;=#]+/;function Op(i){const e=i.match(P8);return e?e[0]:""}const L8=/^[^=?&#]+/,O8=/^[^&#]+/;class k8{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new bt([],{}):new bt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[yt]=new bt(e,t)),n}parseSegment(){const e=Op(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new Dh(Fp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Op(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=Op(this.remaining);r&&(n=r,this.capture(n))}e[Fp(t)]=Fp(n)}parseQueryParam(e){const t=function F8(i){const e=i.match(L8);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const o=function N8(i){const e=i.match(O8);return e?e[0]:""}(this.remaining);o&&(n=o,this.capture(n))}const r=_D(t),s=_D(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Op(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=yt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[yt]:new bt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class xD{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Nv(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=Nv(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=kv(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return kv(e,this._root).map(t=>t.value)}}function Nv(i,e){if(i===e.value)return e;for(const t of e.children){const n=Nv(i,t);if(n)return n}return null}function kv(i,e){if(i===e.value)return[e];for(const t of e.children){const n=kv(i,t);if(n.length)return n.unshift(e),n}return[]}class Ns{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function uc(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class wD extends xD{constructor(e,t){super(e),this.snapshot=t,Bv(this,e)}toString(){return this.snapshot.toString()}}function bD(i,e){const t=function B8(i,e){const o=new Np([],{},{},"",{},yt,e,null,i.root,-1,{});return new SD("",new Ns(o,[]))}(i,e),n=new Nr([new Dh("",{})]),r=new Nr({}),s=new Nr({}),o=new Nr({}),a=new Nr(""),l=new Do(n,r,o,a,s,yt,e,t.root);return l.snapshot=t.root,new wD(new Ns(l,[]),t)}class Do{constructor(e,t,n,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe($t(e=>cc(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe($t(e=>cc(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function MD(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function z8(i){return i.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(n))}class Np{constructor(e,t,n,r,s,o,a,l,c,u,h){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=cc(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=cc(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class SD extends xD{constructor(e,t){super(t),this.url=e,Bv(this,t)}toString(){return ED(this._root)}}function Bv(i,e){e.value._routerState=i,e.children.forEach(t=>Bv(i,t))}function ED(i){const e=i.children.length>0?` { ${i.children.map(ED).join(", ")} } `:"";return`${i.value}${e}`}function zv(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,as(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),as(e.params,t.params)||i.params.next(t.params),function w8(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!as(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),as(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function Uv(i,e){const t=as(i.params,e.params)&&function C8(i,e){return Aa(i,e)&&i.every((t,n)=>as(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||Uv(i.parent,e.parent))}function Rh(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function V8(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Rh(i,n,r);return Rh(i,n)})}(i,e,t);return new Ns(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Rh(i,a)),o}}const n=function H8(i){return new Do(new Nr(i.url),new Nr(i.params),new Nr(i.queryParams),new Nr(i.fragment),new Nr(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>Rh(i,s));return new Ns(n,r)}}function kp(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function Ph(i){return"object"==typeof i&&null!=i&&i.outlets}function Vv(i,e,t,n,r){let s={};if(n&&$n(n,(a,l)=>{s[l]=Array.isArray(a)?a.map(c=>`${c}`):`${a}`}),i===e)return new Ta(t,s,r);const o=CD(i,e,t);return new Ta(o,s,r)}function CD(i,e,t){const n={};return $n(i.children,(r,s)=>{n[s]=r===e?t:CD(r,e,t)}),new bt(i.segments,n)}class TD{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&kp(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(Ph);if(r&&r!==cD(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Hv{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function AD(i,e,t){if(i||(i=new bt([],{})),0===i.segments.length&&i.hasChildren())return Bp(i,e,t);const n=function X8(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const o=i.segments[r],a=t[n];if(Ph(a))break;const l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!ID(l,c,o))return s;n+=2}else{if(!ID(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new bt(i.segments.slice(0,n.pathIndex),{});return s.children[yt]=new bt(i.segments.slice(n.pathIndex),i.children),Bp(s,0,r)}return n.match&&0===r.length?new bt(i.segments,{}):n.match&&!i.hasChildren()?Gv(i,e,t):n.match?Bp(i,0,r):Gv(i,e,t)}function Bp(i,e,t){if(0===t.length)return new bt(i.segments,{});{const n=function $8(i){return Ph(i[0])?i[0].outlets:{[yt]:i}}(t),r={};return $n(n,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=AD(i.children[o],e,s))}),$n(i.children,(s,o)=>{void 0===n[o]&&(r[o]=s)}),new bt(i.segments,r)}}function Gv(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(Ph(s)){const l=Z8(s.outlets);return new bt(n,l)}if(0===r&&kp(t[0])){n.push(new Dh(i.segments[e].path,DD(t[0]))),r++;continue}const o=Ph(s)?s.outlets[yt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&kp(a)?(n.push(new Dh(o,DD(a))),r+=2):(n.push(new Dh(o,{})),r++)}return new bt(n,{})}function Z8(i){const e={};return $n(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=Gv(new bt([],{}),0,t))}),e}function DD(i){const e={};return $n(i,(t,n)=>e[n]=`${t}`),e}function ID(i,e,t){return i==t.path&&as(e,t.parameters)}class K8{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),zv(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=uc(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),$n(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=uc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(n&&n.outlet){const o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=uc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=uc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new y8(s.value.snapshot))}),e.children.length&&this.forwardEvent(new m8(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(zv(r),r===s)if(r.component){const o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),zv(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function Q8(i){for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}class Wv{constructor(e,t){this.routes=e,this.module=t}}function Io(i){return"function"==typeof i}function Da(i){return i instanceof Ta}const Lh=Symbol("INITIAL_VALUE");function Fh(){return Ca(i=>J5(i.map(e=>e.pipe(Qd(1),function i8(...i){const e=Ru(i);return Gn((t,n)=>{(e?Rv(i,t,e):Rv(i,t)).subscribe(n)})}(Lh)))).pipe(JA((e,t)=>{let n=!1;return t.reduce((r,s,o)=>r!==Lh?r:(s===Lh&&(n=!0),n||!1!==s&&o!==t.length-1&&!Da(s)?r:s),e)},Lh),ac(e=>e!==Lh),$t(e=>Da(e)?e:!0===e),Qd(1)))}class r6{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Oh,this.attachRef=null}}class Oh{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new r6,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let jv=(()=>{class i{constructor(t,n,r,s,o){this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new qn,this.deactivateEvents=new qn,this.attachEvents=new qn,this.detachEvents=new qn,this.name=s||yt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(n=n||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new s6(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)(Oe(Oh),Oe(Pr),Oe(ph),function Vu(i){return function _O(i,e){if("class"===e)return i.classes;if("style"===e)return i.styles;const t=i.attrs;if(t){const n=t.length;let r=0;for(;r<n;){const s=t[r];if(uS(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<n&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(Tn(),i)}("name"),Oe(lp))},i.\u0275dir=ei({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class s6{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Do?this.route:e===Oh?this.childContexts:this.parent.get(e,t)}}let RD=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=Jn({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&si(0,"router-outlet")},directives:[jv],encapsulation:2}),i})();function PD(i,e=""){for(let t=0;t<i.length;t++){const n=i[t];o6(n,a6(e,n))}}function o6(i,e){i.children&&PD(i.children,e)}function a6(i,e){return e?i||e.path?i&&!e.path?`${i}/`:!i&&e.path?e.path:`${i}/${e.path}`:"":i}function qv(i){const e=i.children&&i.children.map(qv),t=e?Object.assign(Object.assign({},i),{children:e}):Object.assign({},i);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==yt&&(t.component=RD),t}function ar(i){return i.outlet||yt}function LD(i,e){const t=i.filter(n=>ar(n)===e);return t.push(...i.filter(n=>ar(n)!==e)),t}const FD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function zp(i,e,t){var n;if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?Object.assign({},FD):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||x8)(t,i,e);if(!s)return Object.assign({},FD);const o={};$n(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:a,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function Up(i,e,t,n,r="corrected"){if(t.length>0&&function u6(i,e,t){return t.some(n=>Vp(i,e,n)&&ar(n)!==yt)}(i,t,n)){const o=new bt(e,function c6(i,e,t,n){const r={};r[yt]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&ar(s)!==yt){const o=new bt([],{});o._sourceSegment=i,o._segmentIndexShift=e.length,r[ar(s)]=o}return r}(i,e,n,new bt(t,i.children)));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function h6(i,e,t){return t.some(n=>Vp(i,e,n))}(i,t,n)){const o=new bt(i.segments,function l6(i,e,t,n,r,s){const o={};for(const a of n)if(Vp(i,t,a)&&!r[ar(a)]){const l=new bt([],{});l._sourceSegment=i,l._segmentIndexShift="legacy"===s?i.segments.length:e.length,o[ar(a)]=l}return Object.assign(Object.assign({},r),o)}(i,e,t,n,i.children,r));return o._sourceSegment=i,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new bt(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function Vp(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function OD(i,e,t,n){return!!(ar(i)===n||n!==yt&&Vp(e,t,i))&&("**"===i.path||zp(e,i,t).matched)}function ND(i,e,t){return 0===e.length&&!i.children[t]}class Hp{constructor(e){this.segmentGroup=e||null}}class kD{constructor(e){this.urlTree=e}}function Nh(i){return Dp(new Hp(i))}function BD(i){return Dp(new kD(i))}class m6{constructor(e,t,n,r,s){this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Ds)}apply(){const e=Up(this.urlTree.root,[],[],this.config).segmentGroup,t=new bt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,yt).pipe($t(s=>this.createUrlTree($v(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ao(s=>{if(s instanceof kD)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof Hp?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,yt).pipe($t(r=>this.createUrlTree($v(r),e.queryParams,e.fragment))).pipe(Ao(r=>{throw r instanceof Hp?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new bt([],{[yt]:e}):e;return new Ta(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe($t(s=>new bt([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return jn(r).pipe(Th(s=>{const o=n.children[s],a=LD(t,s);return this.expandSegmentGroup(e,a,o,s).pipe($t(l=>({segment:l,outlet:s})))}),JA((s,o)=>(s[o.outlet]=o.segment,s),{}),function o8(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ac((r,s)=>i(r,s,n)):ua,Pv(1),t?tD(e):eD(()=>new Ip))}())}expandSegment(e,t,n,r,s,o){return jn(n).pipe(Th(a=>this.expandSegmentAgainstRoute(e,t,n,a,r,s,o).pipe(Ao(c=>{if(c instanceof Hp)return dt(null);throw c}))),lc(a=>!!a),Ao((a,l)=>{if(a instanceof Ip||"EmptyError"===a.name)return ND(t,r,s)?dt(new bt([],{})):Nh(t);throw a}))}expandSegmentAgainstRoute(e,t,n,r,s,o,a){return OD(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o):Nh(t):Nh(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?BD(s):this.lineralizeSegments(n,s).pipe(Fn(o=>{const a=new bt(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){const{matched:a,consumedSegments:l,remainingSegments:c,positionalParamSegments:u}=zp(t,r,s);if(!a)return Nh(t);const h=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?BD(h):this.lineralizeSegments(r,h).pipe(Fn(d=>this.expandSegment(e,t,n,d.concat(c),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){if("**"===n.path)return n.loadChildren?(n._loadedConfig?dt(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe($t(h=>(n._loadedConfig=h,new bt(r,{})))):dt(new bt(r,{}));const{matched:o,consumedSegments:a,remainingSegments:l}=zp(t,n,r);return o?this.getChildConfig(e,n,r).pipe(Fn(u=>{const h=u.module,d=u.routes,{segmentGroup:f,slicedSegments:p}=Up(t,a,l,d),m=new bt(f.segments,f.children);if(0===p.length&&m.hasChildren())return this.expandChildren(h,d,m).pipe($t(v=>new bt(a,v)));if(0===d.length&&0===p.length)return dt(new bt(a,{}));const g=ar(n)===s;return this.expandSegment(h,m,d,p,g?yt:s,!0).pipe($t(_=>new bt(a.concat(_.segments),_.children)))})):Nh(t)}getChildConfig(e,t,n){return t.children?dt(new Wv(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?dt(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe(Fn(r=>r?this.configLoader.load(e.injector,t).pipe($t(s=>(t._loadedConfig=s,s))):function f6(i){return Dp(Fv(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(t))):dt(new Wv([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;return r&&0!==r.length?dt(r.map(o=>{const a=e.get(o);let l;if(function e6(i){return i&&Io(i.canLoad)}(a))l=a.canLoad(t,n);else{if(!Io(a))throw new Error("Invalid CanLoad guard");l=a(t,n)}return ls(l)})).pipe(Fh(),Vi(o=>{if(!Da(o))return;const a=Fv(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),$t(o=>!0===o)):dt(!0)}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return dt(n);if(r.numberOfChildren>1||!r.children[yt])return Dp(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));r=r.children[yt]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new Ta(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return $n(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);n[s]=t[a]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let o={};return $n(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,n,r)}),new bt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function $v(i){const e={};for(const n of Object.keys(i.children)){const s=$v(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function g6(i){if(1===i.numberOfChildren&&i.children[yt]){const e=i.children[yt];return new bt(i.segments.concat(e.segments),e.children)}return i}(new bt(i.segments,e))}class zD{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Gp{constructor(e,t){this.component=e,this.route=t}}function _6(i,e,t){const n=i._root;return kh(n,e?e._root:null,t,[n.value])}function Wp(i,e,t){const n=function x6(i){if(!i)return null;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:t).get(i)}function kh(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=uc(e);return i.children.forEach(o=>{(function w6(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function b6(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!Aa(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Aa(i.url,e.url)||!as(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Uv(i,e)||!as(i.queryParams,e.queryParams);default:return!Uv(i,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new zD(n)):(s.data=o.data,s._resolvedData=o._resolvedData),kh(i,e,s.component?a?a.children:null:t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Gp(a.outlet.component,o))}else o&&Bh(e,a,r),r.canActivateChecks.push(new zD(n)),kh(i,null,s.component?a?a.children:null:t,n,r)})(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),$n(s,(o,a)=>Bh(o,t.getContext(a),r)),r}function Bh(i,e,t){const n=uc(i),r=i.value;$n(n,(s,o)=>{Bh(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Gp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class R6{}function UD(i){return new Cn(e=>e.error(i))}class L6{constructor(e,t,n,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=Up(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,yt);if(null===t)return null;const n=new Np([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},yt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Ns(n,t),s=new SD(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,n=MD(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=LD(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;n.push(...l)}const r=VD(n);return function F6(i){i.sort((e,t)=>e.value.outlet===yt?-1:t.value.outlet===yt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,n,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,n,r);if(null!==o)return o}return ND(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!OD(e,t,n,r))return null;let s,o=[],a=[];if("**"===e.path){const f=n.length>0?cD(n).parameters:{};s=new Np(n,f,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,WD(e),ar(e),e.component,e,HD(t),GD(t)+n.length,jD(e))}else{const f=zp(t,e,n);if(!f.matched)return null;o=f.consumedSegments,a=f.remainingSegments,s=new Np(o,f.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,WD(e),ar(e),e.component,e,HD(t),GD(t)+o.length,jD(e))}const l=function O6(i){return i.children?i.children:i.loadChildren?i._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=Up(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new Ns(s,f)]}if(0===l.length&&0===u.length)return[new Ns(s,[])];const h=ar(e)===r,d=this.processSegment(l,c,u,h?yt:r);return null===d?null:[new Ns(s,d)]}}function N6(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function VD(i){const e=[],t=new Set;for(const n of i){if(!N6(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=VD(n.children);e.push(new Ns(n.value,r))}return e.filter(n=>!t.has(n))}function HD(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function GD(i){let e=i,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function WD(i){return i.data||{}}function jD(i){return i.resolve||{}}function qD(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function Xv(i){return Ca(e=>{const t=i(e);return t?jn(t).pipe($t(()=>e)):dt(e)})}class W6 extends class G6{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Zv=new At("ROUTES");class $D{constructor(e,t,n,r){this.injector=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe($t(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new Wv(lD(o.injector.get(Zv,void 0,st.Self|st.Optional)).map(qv),o)}),Ao(s=>{throw t._loader$=void 0,s}));return t._loader$=new n8(r,()=>new Kr).pipe(QA()),t._loader$}loadModuleFactory(e){return ls(e()).pipe(Fn(t=>t instanceof hT?dt(t):jn(this.compiler.compileModuleAsync(t))))}}class q6{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function $6(i){throw i}function X6(i,e,t){return e.parse("/")}function XD(i,e){return dt(null)}const Z6={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Y6={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let mi=(()=>{class i{constructor(t,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Kr,this.errorHandler=$6,this.malformedUriErrorHandler=X6,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:XD,afterPreactivation:XD},this.urlHandlingStrategy=new q6,this.routeReuseStrategy=new W6,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Ds),this.console=o.get($T);const h=o.get(nn);this.isNgZoneEnabled=h instanceof nn&&nn.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function b8(){return new Ta(new bt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new $D(o,a,d=>this.triggerEvent(new iD(d)),d=>this.triggerEvent(new rD(d))),this.routerState=bD(this.currentUrlTree,this.rootComponentType),this.transitions=new Nr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(ac(r=>0!==r.id),$t(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Ca(r=>{let s=!1,o=!1;return dt(r).pipe(Vi(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ca(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return ZD(a.source)&&(this.browserUrlTree=a.extractedUrl),dt(a).pipe(Ca(h=>{const d=this.transitions.getValue();return n.next(new Lv(h.id,this.serializeUrl(h.extractedUrl),h.source,h.restoredState)),d!==this.transitions.getValue()?bs:Promise.resolve(h)}),function y6(i,e,t,n){return Ca(r=>function p6(i,e,t,n,r){return new m6(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe($t(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Vi(h=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:h.urlAfterRedirects})}),function k6(i,e,t,n,r){return Fn(s=>function P6(i,e,t,n,r="emptyOnly",s="legacy"){try{const o=new L6(i,e,t,n,r,s).recognize();return null===o?UD(new R6):dt(o)}catch(o){return UD(o)}}(i,e,s.urlAfterRedirects,t(s.urlAfterRedirects),n,r).pipe($t(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,h=>this.serializeUrl(h),this.paramsInheritanceStrategy,this.relativeLinkResolution),Vi(h=>{if("eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(f,h)}this.browserUrlTree=h.urlAfterRedirects}const d=new c8(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);n.next(d)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:d,extractedUrl:f,source:p,restoredState:m,extras:g}=a,y=new Lv(d,this.serializeUrl(f),p,m);n.next(y);const _=bD(f,this.rootComponentType).snapshot;return dt(Object.assign(Object.assign({},a),{targetSnapshot:_,urlAfterRedirects:f,extras:Object.assign(Object.assign({},g),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),bs}),Xv(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:h,extras:{skipLocationChange:d,replaceUrl:f}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:h,skipLocationChange:!!d,replaceUrl:!!f})}),Vi(a=>{const l=new u8(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),$t(a=>Object.assign(Object.assign({},a),{guards:_6(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function M6(i,e){return Fn(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?dt(Object.assign(Object.assign({},t),{guardsResult:!0})):function S6(i,e,t,n){return jn(i).pipe(Fn(r=>function I6(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?dt(s.map(a=>{const l=Wp(a,e,r);let c;if(function i6(i){return i&&Io(i.canDeactivate)}(l))c=ls(l.canDeactivate(i,e,t,n));else{if(!Io(l))throw new Error("Invalid CanDeactivate guard");c=ls(l(i,e,t,n))}return c.pipe(lc())})).pipe(Fh()):dt(!0)}(r.component,r.route,t,e,n)),lc(r=>!0!==r,!0))}(o,n,r,i).pipe(Fn(a=>a&&function J8(i){return"boolean"==typeof i}(a)?function E6(i,e,t,n){return jn(e).pipe(Th(r=>Rv(function T6(i,e){return null!==i&&e&&e(new p8(i)),dt(!0)}(r.route.parent,n),function C6(i,e){return null!==i&&e&&e(new g8(i)),dt(!0)}(r.route,n),function D6(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function v6(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(o)).filter(o=>null!==o).map(o=>KA(()=>dt(o.guards.map(l=>{const c=Wp(l,o.node,t);let u;if(function n6(i){return i&&Io(i.canActivateChild)}(c))u=ls(c.canActivateChild(n,i));else{if(!Io(c))throw new Error("Invalid CanActivateChild guard");u=ls(c(n,i))}return u.pipe(lc())})).pipe(Fh())));return dt(s).pipe(Fh())}(i,r.path,t),function A6(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return dt(!0);const r=n.map(s=>KA(()=>{const o=Wp(s,e,t);let a;if(function t6(i){return i&&Io(i.canActivate)}(o))a=ls(o.canActivate(e,i));else{if(!Io(o))throw new Error("Invalid CanActivate guard");a=ls(o(e,i))}return a.pipe(lc())}));return dt(r).pipe(Fh())}(i,r.route,t))),lc(r=>!0!==r,!0))}(n,s,i,e):dt(a)),$t(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Vi(a=>{if(Da(a.guardsResult)){const c=Fv(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new h8(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),ac(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),Xv(a=>{if(a.guards.canActivateChecks.length)return dt(a).pipe(Vi(l=>{const c=new d8(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Ca(l=>{let c=!1;return dt(l).pipe(function B6(i,e){return Fn(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return dt(t);let s=0;return jn(r).pipe(Th(o=>function z6(i,e,t,n){return function U6(i,e,t,n){const r=qD(i);if(0===r.length)return dt({});const s={};return jn(r).pipe(Fn(o=>function V6(i,e,t,n){const r=Wp(i,e,n);return ls(r.resolve?r.resolve(e,t):r(e,t))}(i[o],e,t,n).pipe(Vi(a=>{s[o]=a}))),Pv(1),Fn(()=>qD(s).length===r.length?dt(s):bs))}(i._resolve,i,e,n).pipe($t(s=>(i._resolvedData=s,i.data=Object.assign(Object.assign({},i.data),MD(i,t).resolve),null)))}(o.route,n,i,e)),Vi(()=>s++),Pv(1),Fn(o=>s===r.length?dt(t):bs))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Vi({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Vi(l=>{const c=new f8(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),Xv(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:h,extras:{skipLocationChange:d,replaceUrl:f}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:h,skipLocationChange:!!d,replaceUrl:!!f})}),$t(a=>{const l=function U8(i,e,t){const n=Rh(i,e._root,t?t._root:void 0);return new wD(n,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),Vi(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((i,e,t)=>$t(n=>(new K8(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Vi({next(){s=!0},complete(){s=!0}}),function a8(i){return Gn((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Ao(a=>{if(o=!0,function v8(i){return i&&i[oD]}(a)){const l=Da(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new nD(r.id,this.serializeUrl(r.extractedUrl),a.message);n.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),h={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ZD(r.source)};this.scheduleNavigation(u,"imperative",null,h,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new l8(r.id,this.serializeUrl(r.extractedUrl),a);n.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return bs}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,n,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){PD(t),this.config=t.map(qv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=n,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let h=null;switch(a){case"merge":h=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}return null!==h&&(h=this.removeEmptyProps(h)),function G8(i,e,t,n,r){if(0===t.length)return Vv(e.root,e.root,e.root,n,r);const s=function W8(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new TD(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return $n(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new TD(t,e,n)}(t);if(s.toRoot())return Vv(e.root,e.root,new bt([],{}),n,r);const o=function j8(i,e,t){if(i.isAbsolute)return new Hv(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new Hv(s,s===e.root,0)}const n=kp(i.commands[0])?0:1;return function q8(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new Hv(n,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+n,i.numberOfDoubleDots)}(s,e,i),a=o.processChildren?Bp(o.segmentGroup,o.index,s.commands):AD(o.segmentGroup,o.index,s.commands);return Vv(e.root,o.segmentGroup,a,n,r)}(c,this.currentUrlTree,t,h,null!=u?u:null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=Da(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function K6(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?Object.assign({},Z6):!1===n?Object.assign({},Y6):n,Da(t))return hD(this.currentUrlTree,t,r);const s=this.parseUrl(t);return hD(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Ah(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,r,s,o){var a,l;if(this.disposed)return Promise.resolve(!1);let c,u,h;o?(c=o.resolve,u=o.reject,h=o.promise):h=new Promise((p,m)=>{c=p,u=m});const d=++this.navigationId;let f;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),f=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(a=this.browserPageId)&&void 0!==a?a:0:(null!==(l=this.browserPageId)&&void 0!==l?l:0)+1):f=0,this.setTransition({id:d,targetPageId:f,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(p=>Promise.reject(p))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n){const r=new nD(t.id,this.serializeUrl(t.extractedUrl),n);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){__()},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();function ZD(i){return"imperative"!==i}class YD{}class KD{preload(e,t){return dt(null)}}let QD=(()=>{class i{constructor(t,n,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new $D(r,n,l=>t.triggerEvent(new iD(l)),l=>t.triggerEvent(new rD(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(ac(t=>t instanceof Ah),Th(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ds);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return jn(r).pipe(Iu(),$t(s=>{}))}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?dt(n._loadedConfig):this.loader.load(t.injector,n)).pipe(Fn(s=>(n._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return i.\u0275fac=function(t){return new(t||i)(je(mi),je(XT),je(Mi),je(YD))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),Qv=(()=>{class i{constructor(t,n,r={}){this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Lv?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ah&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof sD&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new sD(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(t){__()},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const Ia=new At("ROUTER_CONFIGURATION"),JD=new At("ROUTER_FORROOT_GUARD"),tG=[hv,{provide:mD,useClass:gD},{provide:mi,useFactory:function aG(i,e,t,n,r,s,o={},a,l){const c=new mi(null,i,e,t,n,r,lD(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function lG(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(e.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(u=>{var h,d;null===(h=console.group)||void 0===h||h.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(d=console.groupEnd)||void 0===d||d.call(console)}),c},deps:[mD,Oh,hv,Mi,XT,Zv,Ia,[class j6{},new xo],[class H6{},new xo]]},Oh,{provide:Do,useFactory:function cG(i){return i.routerState.root},deps:[mi]},QD,KD,class eG{preload(e,t){return t().pipe(Ao(()=>dt(null)))}},{provide:Ia,useValue:{enableTracing:!1}}];function nG(){return new JT("Router",mi)}let iG=(()=>{class i{constructor(t,n){}static forRoot(t,n){return{ngModule:i,providers:[tG,eI(t),{provide:JD,useFactory:oG,deps:[[mi,new xo,new Xu]]},{provide:Ia,useValue:n||{}},{provide:oc,useFactory:sG,deps:[Ea,[new Cf(uv),new xo],Ia]},{provide:Qv,useFactory:rG,deps:[mi,s5,Ia]},{provide:YD,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:KD},{provide:JT,multi:!0,useFactory:nG},[Jv,{provide:X_,multi:!0,useFactory:uG,deps:[Jv]},{provide:tI,useFactory:hG,deps:[Jv]},{provide:qT,multi:!0,useExisting:tI}]]}}static forChild(t){return{ngModule:i,providers:[eI(t)]}}}return i.\u0275fac=function(t){return new(t||i)(je(JD,8),je(mi,8))},i.\u0275mod=fa({type:i}),i.\u0275inj=ho({}),i})();function rG(i,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new Qv(i,e,t)}function sG(i,e,t={}){return t.useHash?new H4(i,e):new vA(i,e)}function oG(i){return"guarded"}function eI(i){return[{provide:SO,multi:!0,useValue:i},{provide:Zv,multi:!0,useValue:i}]}let Jv=(()=>{class i{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Kr}appInitializer(){return this.injector.get(z4,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(a=>n=a),s=this.injector.get(mi),o=this.injector.get(Ia);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?dt(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),r})}bootstrapListener(t){const n=this.injector.get(Ia),r=this.injector.get(QD),s=this.injector.get(Qv),o=this.injector.get(mi),a=this.injector.get(iv);t===a.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(t){return new(t||i)(je(Mi))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();function uG(i){return i.appInitializer.bind(i)}function hG(i){return i.bootstrapListener.bind(i)}const tI=new At("Router Initializer");let fG=(()=>{class i{constructor(){this.title="product-configurator"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=Jn({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){1&t&&si(0,"router-outlet")},directives:[jv],styles:["container-3D[_ngcontent-%COMP%]{position:relative;height:100%}"]}),i})();class nI{}const ks="*";function iI(i,e){return{type:7,name:i,definitions:e,options:{}}}function ex(i,e=null){return{type:4,styles:e,timings:i}}function rI(i,e=null){return{type:2,steps:i,options:e}}function dc(i){return{type:6,styles:i,offset:null}}function sI(i,e,t){return{type:0,name:i,styles:e,options:t}}function oI(i,e,t=null){return{type:1,expr:i,animation:e,options:t}}function aI(i,e,t=null){return{type:11,selector:i,animation:e,options:t}}function lI(i){Promise.resolve(null).then(i)}class zh{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){lI(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class cI{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0;const s=this.players.length;0==s?lI(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(n=>{const r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){const e=this.players.reduce((t,n)=>null===t||n.totalTime>t.totalTime?n:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}const Mt=!1;function uI(i){return new We(3e3,Mt)}function XG(){return"undefined"!=typeof window&&void 0!==window.document}function nx(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Ro(i){switch(i.length){case 0:return new zh;case 1:return i[0];default:return new cI(i)}}function hI(i,e,t,n,r={},s={}){const o=[],a=[];let l=-1,c=null;if(n.forEach(u=>{const h=u.offset,d=h==l,f=d&&c||{};Object.keys(u).forEach(p=>{let m=p,g=u[p];if("offset"!==p)switch(m=e.normalizePropertyName(m,o),g){case"!":g=r[p];break;case ks:g=s[p];break;default:g=e.normalizeStyleValue(p,m,g,o)}f[m]=g}),d||a.push(f),c=f,l=h}),o.length)throw function kG(i){return new We(3502,Mt)}();return a}function ix(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&rx(t,"start",i)));break;case"done":i.onDone(()=>n(t&&rx(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&rx(t,"destroy",i)))}}function rx(i,e,t){const n=t.totalTime,s=sx(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,null==n?i.totalTime:n,!!t.disabled),o=i._data;return null!=o&&(s._data=o),s}function sx(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function Hi(i,e,t){let n;return i instanceof Map?(n=i.get(e),n||i.set(e,n=t)):(n=i[e],n||(n=i[e]=t)),n}function dI(i){const e=i.indexOf(":");return[i.substring(1,e),i.substr(e+1)]}let ox=(i,e)=>!1,fI=(i,e,t)=>[],pI=null;function ax(i){const e=i.parentNode||i.host;return e===pI?null:e}(nx()||"undefined"!=typeof Element)&&(XG()?(pI=(()=>document.documentElement)(),ox=(i,e)=>{for(;e;){if(e===i)return!0;e=ax(e)}return!1}):ox=(i,e)=>i.contains(e),fI=(i,e,t)=>{if(t)return Array.from(i.querySelectorAll(e));const n=i.querySelector(e);return n?[n]:[]});let Ra=null,mI=!1;function gI(i){Ra||(Ra=function YG(){return"undefined"!=typeof document?document.body:null}()||{},mI=!!Ra.style&&"WebkitAppearance"in Ra.style);let e=!0;return Ra.style&&!function ZG(i){return"ebkit"==i.substring(1,6)}(i)&&(e=i in Ra.style,!e&&mI&&(e="Webkit"+i.charAt(0).toUpperCase()+i.substr(1)in Ra.style)),e}const yI=ox,_I=fI;let vI=(()=>{class i{validateStyleProperty(t){return gI(t)}matchesElement(t,n){return!1}containsElement(t,n){return yI(t,n)}getParentElement(t){return ax(t)}query(t,n,r){return _I(t,n,r)}computeStyle(t,n,r){return r||""}animate(t,n,r,s,o,a=[],l){return new zh(r,s)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})(),lx=(()=>{class i{}return i.NOOP=new vI,i})();const cx="ng-enter",qp="ng-leave",$p="ng-trigger",Xp=".ng-trigger",wI="ng-animating",ux=".ng-animating";function Pa(i){if("number"==typeof i)return i;const e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:hx(parseFloat(e[1]),e[2])}function hx(i,e){return"s"===e?1e3*i:i}function Zp(i,e,t){return i.hasOwnProperty("duration")?i:function JG(i,e,t){let r,s=0,o="";if("string"==typeof i){const a=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(uI()),{duration:0,delay:0,easing:""};r=hx(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=hx(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(function mG(){return new We(3100,Mt)}()),a=!0),s<0&&(e.push(function gG(){return new We(3101,Mt)}()),a=!0),a&&e.splice(l,0,uI())}return{duration:r,delay:s,easing:o}}(i,e,t)}function fc(i,e={}){return Object.keys(i).forEach(t=>{e[t]=i[t]}),e}function Po(i,e,t={}){if(e)for(let n in i)t[n]=i[n];else fc(i,t);return t}function MI(i,e,t){return t?e+":"+t+";":""}function SI(i){let e="";for(let t=0;t<i.style.length;t++){const n=i.style.item(t);e+=MI(0,n,i.style.getPropertyValue(n))}for(const t in i.style)i.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=MI(0,nW(t),i.style[t]));i.setAttribute("style",e)}function cs(i,e,t){i.style&&(Object.keys(e).forEach(n=>{const r=fx(n);t&&!t.hasOwnProperty(n)&&(t[n]=i.style[r]),i.style[r]=e[n]}),nx()&&SI(i))}function La(i,e){i.style&&(Object.keys(e).forEach(t=>{const n=fx(t);i.style[n]=""}),nx()&&SI(i))}function Uh(i){return Array.isArray(i)?1==i.length?i[0]:rI(i):i}const dx=new RegExp("{{\\s*(.+?)\\s*}}","g");function EI(i){let e=[];if("string"==typeof i){let t;for(;t=dx.exec(i);)e.push(t[1]);dx.lastIndex=0}return e}function Yp(i,e,t){const n=i.toString(),r=n.replace(dx,(s,o)=>{let a=e[o];return e.hasOwnProperty(o)||(t.push(function _G(i){return new We(3003,Mt)}()),a=""),a.toString()});return r==n?i:r}function Kp(i){const e=[];let t=i.next();for(;!t.done;)e.push(t.value),t=i.next();return e}const tW=/-+([a-z0-9])/g;function fx(i){return i.replace(tW,(...e)=>e[1].toUpperCase())}function nW(i){return i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Gi(i,e,t){switch(e.type){case 7:return i.visitTrigger(e,t);case 0:return i.visitState(e,t);case 1:return i.visitTransition(e,t);case 2:return i.visitSequence(e,t);case 3:return i.visitGroup(e,t);case 4:return i.visitAnimate(e,t);case 5:return i.visitKeyframes(e,t);case 6:return i.visitStyle(e,t);case 8:return i.visitReference(e,t);case 9:return i.visitAnimateChild(e,t);case 10:return i.visitAnimateRef(e,t);case 11:return i.visitQuery(e,t);case 12:return i.visitStagger(e,t);default:throw function vG(i){return new We(3004,Mt)}()}}function CI(i,e){return window.getComputedStyle(i)[e]}function lW(i,e){const t=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(n=>function cW(i,e,t){if(":"==i[0]){const l=function uW(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(function LG(i){return new We(3016,Mt)}()),"* => *"}}(i,t);if("function"==typeof l)return void e.push(l);i=l}const n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==n||n.length<4)return t.push(function PG(i){return new We(3015,Mt)}()),e;const r=n[1],s=n[2],o=n[3];e.push(TI(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(TI(o,r))}(n,t,e)):t.push(i),t}const tm=new Set(["true","1"]),nm=new Set(["false","0"]);function TI(i,e){const t=tm.has(i)||nm.has(i),n=tm.has(e)||nm.has(e);return(r,s)=>{let o="*"==i||i==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?tm.has(i):nm.has(i)),!a&&n&&"boolean"==typeof s&&(a=s?tm.has(e):nm.has(e)),o&&a}}const hW=new RegExp("s*:selfs*,?","g");function px(i,e,t,n){return new dW(i).build(e,t,n)}class dW{constructor(e){this._driver=e}build(e,t,n){const r=new mW(t);this._resetContextStyleTimingState(r);const s=Gi(this,Uh(e),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push(function wG(){return new We(3006,Mt)}()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(function bG(){return new We(3007,Mt)}())}),{type:7,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){const s=new Set,o=r||{};n.styles.forEach(a=>{if(im(a)){const l=a;Object.keys(l).forEach(c=>{EI(l[c]).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}}),s.size&&(Kp(s.values()),t.errors.push(function MG(i,e){return new We(3008,Mt)}()))}return{type:0,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=Gi(this,Uh(e.animation),t);return{type:1,matchers:lW(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:Fa(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(n=>Gi(this,n,t)),options:Fa(e.options)}}visitGroup(e,t){const n=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=n;const a=Gi(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:Fa(e.options)}}visitAnimate(e,t){const n=function yW(i,e){let t=null;if(i.hasOwnProperty("duration"))t=i;else if("number"==typeof i)return mx(Zp(i,e).duration,0,"");const n=i;if(n.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=mx(0,0,"");return s.dynamic=!0,s.strValue=n,s}return t=t||Zp(n,e),mx(t.duration,t.delay,t.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:dc({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};n.easing&&(c.easing=n.easing),o=dc(c)}t.currentTime+=n.duration+n.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(o=>{"string"==typeof o?o==ks?n.push(o):t.errors.push(function SG(i){return new We(3002,Mt)}()):n.push(o)}):n.push(e.styles);let r=!1,s=null;return n.forEach(o=>{if(im(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let c in a)if(a[c].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:s,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void t.unsupportedCSSPropertiesFound.add(a);const l=t.collectedStyles[t.currentQuerySelector],c=l[a];let u=!0;c&&(s!=r&&s>=c.startTime&&r<=c.endTime&&(t.errors.push(function EG(i,e,t,n,r){return new We(3010,Mt)}()),u=!1),s=c.startTime),u&&(l[a]={startTime:s,endTime:r}),t.options&&function eW(i,e,t){const n=e.params||{},r=EI(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(function yG(i){return new We(3001,Mt)}())})}(o[a],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function CG(){return new We(3011,Mt)}()),n;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(y=>{const _=this._makeStyleAst(y,t);let v=null!=_.offset?_.offset:function gW(i){if("string"==typeof i)return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(im(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(im(i)&&i.hasOwnProperty("offset")){const t=i;e=parseFloat(t.offset),delete t.offset}return e}(_.styles),x=0;return null!=v&&(s++,x=_.offset=v),l=l||x<0||x>1,a=a||x<c,c=x,o.push(x),_});l&&t.errors.push(function TG(){return new We(3012,Mt)}()),a&&t.errors.push(function AG(){return new We(3200,Mt)}());const h=e.steps.length;let d=0;s>0&&s<h?t.errors.push(function DG(){return new We(3202,Mt)}()):0==s&&(d=1/(h-1));const f=h-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((y,_)=>{const v=d>0?_==f?1:d*_:o[_],x=v*g;t.currentTime=p+m.delay+x,m.duration=x,this._validateStyleAst(y,t),y.offset=v,n.styles.push(y)}),n}visitReference(e,t){return{type:8,animation:Gi(this,Uh(e.animation),t),options:Fa(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:Fa(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:Fa(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function fW(i){const e=!!i.split(/\s*,\s*/).find(t=>":self"==t);return e&&(i=i.replace(hW,"")),i=i.replace(/@\*/g,Xp).replace(/@\w+/g,t=>Xp+"-"+t.substr(1)).replace(/:animating/g,ux),[i,e]}(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,Hi(t.collectedStyles,t.currentQuerySelector,{});const a=Gi(this,Uh(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:Fa(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function IG(){return new We(3013,Mt)}());const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Zp(e.timings,t.errors,!0);return{type:12,animation:Gi(this,Uh(e.animation),t),timings:n,options:null}}}class mW{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function im(i){return!Array.isArray(i)&&"object"==typeof i}function Fa(i){return i?(i=fc(i)).params&&(i.params=function pW(i){return i?fc(i):null}(i.params)):i={},i}function mx(i,e,t){return{duration:i,delay:e,easing:t}}function gx(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class rm{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const xW=new RegExp(":enter","g"),bW=new RegExp(":leave","g");function yx(i,e,t,n,r,s={},o={},a,l,c=[]){return(new MW).buildKeyframes(i,e,t,n,r,s,o,a,l,c)}class MW{buildKeyframes(e,t,n,r,s,o,a,l,c,u=[]){c=c||new rm;const h=new _x(e,t,c,r,s,u,[]);h.options=l,h.currentTimeline.setStyles([o],null,h.errors,l),Gi(this,n,h);const d=h.timelines.filter(f=>f.containsAnimation());if(Object.keys(a).length){let f;for(let p=d.length-1;p>=0;p--){const m=d[p];if(m.element===t){f=m;break}}f&&!f.allowOnlyTimelineStyles()&&f.setStyles([a],null,h.errors,l)}return d.length?d.map(f=>f.buildKeyframes()):[gx(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.get(t.element);if(n){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime;const o=null!=n.duration?Pa(n.duration):null,a=null!=n.delay?Pa(n.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Gi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=sm);const o=Pa(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Gi(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?Pa(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Gi(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Zp(t.params?Yp(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Pa(r.delay):0;s&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=sm);let o=n;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const h=t.createSubContext(e.options,c);s&&h.delayNextStep(s),c===t.element&&(l=h.currentTimeline),Gi(this,e.animation,h),h.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,h.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const h=u.currentTime;Gi(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-h+(r.startTime-n.currentTimeline.startTime)}}const sm={};class _x{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=sm,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new om(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let r=this.options;null!=n.duration&&(r.duration=Pa(n.duration)),null!=n.delay&&(r.delay=Pa(n.delay));const s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Yp(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){const r=t||this.element,s=new _x(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=sm,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},s=new SW(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(xW,"."+this._enterClassName)).replace(bW,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=n);0!==n&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&0==a.length&&o.push(function RG(i){return new We(3014,Mt)}()),a}}class om{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new om(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||ks,this._currentKeyframe[t]=ks}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&(this._previousKeyframe.easing=t);const s=r&&r.params||{},o=function EW(i,e){const t={};let n;return i.forEach(r=>{"*"===r?(n=n||Object.keys(e),n.forEach(s=>{t[s]=ks})):Po(r,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=Yp(o[a],s,n);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:ks),this._updateStyle(a,l)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(n=>{this._currentKeyframe[n]=e[n]}),Object.keys(this._localTimelineStyles).forEach(n=>{this._currentKeyframe.hasOwnProperty(n)||(this._currentKeyframe[n]=this._localTimelineStyles[n])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],r=e._styleSummary[t];(!n||r.time>n.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=Po(a,!0);Object.keys(c).forEach(u=>{const h=c[u];"!"==h?e.add(u):h==ks&&t.add(u)}),n||(c.offset=l/this.duration),r.push(c)});const s=e.size?Kp(e.values()):[],o=t.size?Kp(t.values()):[];if(n){const a=r[0],l=fc(a);a.offset=0,l.offset=1,r=[a,l]}return gx(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class SW extends om{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=n+t,a=t/o,l=Po(e[0],!1);l.offset=0,s.push(l);const c=Po(e[0],!1);c.offset=II(a),s.push(c);const u=e.length-1;for(let h=1;h<=u;h++){let d=Po(e[h],!1);d.offset=II((t+d.offset*n)/o),s.push(d)}n=o,t=0,r="",e=s}return gx(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}}function II(i,e=3){const t=Math.pow(10,e-1);return Math.round(i*t)/t}class vx{}class CW extends vx{normalizePropertyName(e,t){return fx(e)}normalizeStyleValue(e,t,n,r){let s="";const o=n.toString().trim();if(TW[t]&&0!==n&&"0"!==n)if("number"==typeof n)s="px";else{const a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function xG(i,e){return new We(3005,Mt)}())}return o+s}}const TW=(()=>function AW(i){const e={};return i.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function RI(i,e,t,n,r,s,o,a,l,c,u,h,d){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}const xx={};class PI{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return function DW(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){const r=this._stateStyles["*"],s=this._stateStyles[e],o=r?r.buildStyles(t,n):{};return s?s.buildStyles(t,n):o}build(e,t,n,r,s,o,a,l,c,u){const h=[],d=this.ast.options&&this.ast.options.params||xx,p=this.buildStyles(n,a&&a.params||xx,h),m=l&&l.params||xx,g=this.buildStyles(r,m,h),y=new Set,_=new Map,v=new Map,x="void"===r,b={params:Object.assign(Object.assign({},d),m)},S=u?[]:yx(e,t,this.ast.animation,s,o,p,g,b,c,h);let E=0;if(S.forEach(T=>{E=Math.max(T.duration+T.delay,E)}),h.length)return RI(t,this._triggerName,n,r,x,p,g,[],[],_,v,E,h);S.forEach(T=>{const I=T.element,k=Hi(_,I,{});T.preStyleProps.forEach($=>k[$]=!0);const W=Hi(v,I,{});T.postStyleProps.forEach($=>W[$]=!0),I!==t&&y.add(I)});const w=Kp(y.values());return RI(t,this._triggerName,n,r,x,p,g,S,w,_,v,E)}}class IW{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){const n={},r=fc(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=Yp(l,r,t));const c=this.normalizer.normalizePropertyName(a,t);l=this.normalizer.normalizeStyleValue(a,c,l,t),n[c]=l})}}),n}}class PW{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states={},t.states.forEach(r=>{this.states[r.name]=new IW(r.style,r.options&&r.options.params||{},n)}),LI(this.states,"true","1"),LI(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new PI(e,r,this.states))}),this.fallbackTransition=function LW(i,e,t){return new PI(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function LI(i,e,t){i.hasOwnProperty(e)?i.hasOwnProperty(t)||(i[t]=i[e]):i.hasOwnProperty(t)&&(i[e]=i[t])}const FW=new rm;class OW{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],s=px(this._driver,t,n,[]);if(n.length)throw function BG(i){return new We(3503,Mt)}();this._animations[e]=s}_buildPlayer(e,t,n){const r=e.element,s=hI(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const r=[],s=this._animations[e];let o;const a=new Map;if(s?(o=yx(this._driver,t,s,cx,qp,{},{},n,FW,r),o.forEach(u=>{const h=Hi(a,u.element,{});u.postStyleProps.forEach(d=>h[d]=null)})):(r.push(function zG(){return new We(3300,Mt)}()),o=[]),r.length)throw function UG(i){return new We(3504,Mt)}();a.forEach((u,h)=>{Object.keys(u).forEach(d=>{u[d]=this._driver.computeStyle(h,d,ks)})});const c=Ro(o.map(u=>{const h=a.get(u.element);return this._buildPlayer(u,{},h)}));return this._playersById[e]=c,c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw function VG(i){return new We(3301,Mt)}();return t}listen(e,t,n,r){const s=sx(t,"","","");return ix(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if("register"==n)return void this.register(e,r[0]);if("create"==n)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const FI="ng-animate-queued",wx="ng-animate-disabled",UW=[],OI={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},VW={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},lr="__ng_removed";class bx{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=function jW(i){return null!=i?i:null}(n?e.value:e),n){const s=fc(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const n=this.options.params;Object.keys(t).forEach(r=>{null==n[r]&&(n[r]=t[r])})}}}const Vh="void",Mx=new bx(Vh);class HW{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,cr(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.hasOwnProperty(t))throw function HG(i,e){return new We(3302,Mt)}();if(null==n||0==n.length)throw function GG(i){return new We(3303,Mt)}();if(!function qW(i){return"start"==i||"done"==i}(n))throw function WG(i,e){return new We(3400,Mt)}();const s=Hi(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);const a=Hi(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(cr(e,$p),cr(e,$p+"-"+t),a[t]=Mx),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw function jG(i){return new We(3401,Mt)}();return t}trigger(e,t,n,r=!0){const s=this._getTrigger(t),o=new Sx(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(cr(e,$p),cr(e,$p+"-"+t),this._engine.statesByElement.set(e,a={}));let l=a[t];const c=new bx(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a[t]=c,l||(l=Mx),c.value!==Vh&&l.value===c.value){if(!function ZW(i,e){const t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}(l.params,c.params)){const m=[],g=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{La(e,g),cs(e,y)})}return}const d=Hi(this._engine.playersByElement,e,[]);d.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(cr(e,FI),o.onStart(()=>{pc(e,FI)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const g=this._engine.playersByElement.get(e);if(g){let y=g.indexOf(o);y>=0&&g.splice(y,1)}}),this.players.push(o),d.push(o),o}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,Xp,!0);n.forEach(r=>{if(r[lr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const c=this.trigger(e,l,Vh,r);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&Ro(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,c=n[o]||Mx,u=new bx(Vh),h=new Sx(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:h,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){const s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{const s=e[lr];(!s||s===OI)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){cr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){const l=sx(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,ix(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{const s=n.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(n=>n.element===e)||t,t}}class GW{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){const n=new HW(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList,r=this.namespacesByHostElement,s=n.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(t);for(;a;){const l=r.get(a);if(l){const c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(n[a].hostElement,t)){n.splice(a+1,0,e),o=!0;break}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const r=Object.keys(n);for(let s=0;s<r.length;s++){const o=n[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&t.add(a)}}}return t}trigger(e,t,n,r){if(am(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!am(t))return;const s=t[lr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),cr(e,wx)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),pc(e,wx))}removeNode(e,t,n,r){if(am(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),n){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[lr]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return am(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Xp,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,ux,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ro(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const n=e[lr];if(n&&n.setForRemoval){if(e[lr]=OI,n.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(wx))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)cr(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){const n=this._whenQuietFns;this._whenQuietFns=[],t.length?Ro(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw function qG(i){return new We(3402,Mt)}()}_flushAnimations(e,t){const n=new rm,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(F=>{u.add(F);const z=this.driver.query(F,".ng-animate-queued",!0);for(let V=0;V<z.length;V++)u.add(z[V])});const h=this.bodyNode,d=Array.from(this.statesByElement.keys()),f=BI(d,this.collectedEnterElements),p=new Map;let m=0;f.forEach((F,z)=>{const V=cx+m++;p.set(z,V),F.forEach(U=>cr(U,V))});const g=[],y=new Set,_=new Set;for(let F=0;F<this.collectedLeaveElements.length;F++){const z=this.collectedLeaveElements[F],V=z[lr];V&&V.setForRemoval&&(g.push(z),y.add(z),V.hasAnimation?this.driver.query(z,".ng-star-inserted",!0).forEach(U=>y.add(U)):_.add(z))}const v=new Map,x=BI(d,Array.from(y));x.forEach((F,z)=>{const V=qp+m++;v.set(z,V),F.forEach(U=>cr(U,V))}),e.push(()=>{f.forEach((F,z)=>{const V=p.get(z);F.forEach(U=>pc(U,V))}),x.forEach((F,z)=>{const V=v.get(z);F.forEach(U=>pc(U,V))}),g.forEach(F=>{this.processLeaveNode(F)})});const b=[],S=[];for(let F=this._namespaceList.length-1;F>=0;F--)this._namespaceList[F].drainQueuedTransitions(t).forEach(V=>{const U=V.player,j=V.element;if(b.push(U),this.collectedEnterElements.length){const He=j[lr];if(He&&He.setForMove){if(He.previousTriggersValues&&He.previousTriggersValues.has(V.triggerName)){const Be=He.previousTriggersValues.get(V.triggerName),$e=this.statesByElement.get(V.element);$e&&$e[V.triggerName]&&($e[V.triggerName].value=Be)}return void U.destroy()}}const te=!h||!this.driver.containsElement(h,j),Q=v.get(j),he=p.get(j),ce=this._buildInstruction(V,n,he,Q,te);if(ce.errors&&ce.errors.length)return void S.push(ce);if(te)return U.onStart(()=>La(j,ce.fromStyles)),U.onDestroy(()=>cs(j,ce.toStyles)),void r.push(U);if(V.isFallbackTransition)return U.onStart(()=>La(j,ce.fromStyles)),U.onDestroy(()=>cs(j,ce.toStyles)),void r.push(U);const De=[];ce.timelines.forEach(He=>{He.stretchStartingKeyframe=!0,this.disabledNodes.has(He.element)||De.push(He)}),ce.timelines=De,n.append(j,ce.timelines),o.push({instruction:ce,player:U,element:j}),ce.queriedElements.forEach(He=>Hi(a,He,[]).push(U)),ce.preStyleProps.forEach((He,Be)=>{const $e=Object.keys(He);if($e.length){let ye=l.get(Be);ye||l.set(Be,ye=new Set),$e.forEach(Ke=>ye.add(Ke))}}),ce.postStyleProps.forEach((He,Be)=>{const $e=Object.keys(He);let ye=c.get(Be);ye||c.set(Be,ye=new Set),$e.forEach(Ke=>ye.add(Ke))})});if(S.length){const F=[];S.forEach(z=>{F.push(function $G(i,e){return new We(3505,Mt)}())}),b.forEach(z=>z.destroy()),this.reportError(F)}const E=new Map,w=new Map;o.forEach(F=>{const z=F.element;n.has(z)&&(w.set(z,z),this._beforeAnimationBuild(F.player.namespaceId,F.instruction,E))}),r.forEach(F=>{const z=F.element;this._getPreviousPlayers(z,!1,F.namespaceId,F.triggerName,null).forEach(U=>{Hi(E,z,[]).push(U),U.destroy()})});const T=g.filter(F=>UI(F,l,c)),I=new Map;kI(I,this.driver,_,c,ks).forEach(F=>{UI(F,l,c)&&T.push(F)});const W=new Map;f.forEach((F,z)=>{kI(W,this.driver,new Set(F),l,"!")}),T.forEach(F=>{const z=I.get(F),V=W.get(F);I.set(F,Object.assign(Object.assign({},z),V))});const $=[],N=[],G={};o.forEach(F=>{const{element:z,player:V,instruction:U}=F;if(n.has(z)){if(u.has(z))return V.onDestroy(()=>cs(z,U.toStyles)),V.disabled=!0,V.overrideTotalTime(U.totalTime),void r.push(V);let j=G;if(w.size>1){let Q=z;const he=[];for(;Q=Q.parentNode;){const ce=w.get(Q);if(ce){j=ce;break}he.push(Q)}he.forEach(ce=>w.set(ce,j))}const te=this._buildAnimation(V.namespaceId,U,E,s,W,I);if(V.setRealPlayer(te),j===G)$.push(V);else{const Q=this.playersByElement.get(j);Q&&Q.length&&(V.parentPlayer=Ro(Q)),r.push(V)}}else La(z,U.fromStyles),V.onDestroy(()=>cs(z,U.toStyles)),N.push(V),u.has(z)&&r.push(V)}),N.forEach(F=>{const z=s.get(F.element);if(z&&z.length){const V=Ro(z);F.setRealPlayer(V)}}),r.forEach(F=>{F.parentPlayer?F.syncPlayerEvents(F.parentPlayer):F.destroy()});for(let F=0;F<g.length;F++){const z=g[F],V=z[lr];if(pc(z,qp),V&&V.hasAnimation)continue;let U=[];if(a.size){let te=a.get(z);te&&te.length&&U.push(...te);let Q=this.driver.query(z,ux,!0);for(let he=0;he<Q.length;he++){let ce=a.get(Q[he]);ce&&ce.length&&U.push(...ce)}}const j=U.filter(te=>!te.destroyed);j.length?$W(this,z,j):this.processLeaveNode(z)}return g.length=0,$.forEach(F=>{this.players.push(F),F.onDone(()=>{F.destroy();const z=this.players.indexOf(F);this.players.splice(z,1)}),F.play()}),$}elementContainsData(e,t){let n=!1;const r=t[lr];return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==Vh;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,h=Hi(n,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),h.push(f)})}La(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,h=new Set,d=t.timelines.map(p=>{const m=p.element;u.add(m);const g=m[lr];if(g&&g.removedBeforeQueried)return new zh(p.duration,p.delay);const y=m!==l,_=function XW(i){const e=[];return zI(i,e),e}((n.get(m)||UW).map(E=>E.getRealPlayer())).filter(E=>!!E.element&&E.element===m),v=s.get(m),x=o.get(m),b=hI(0,this._normalizer,0,p.keyframes,v,x),S=this._buildPlayer(p,b,_);if(p.subTimeline&&r&&h.add(m),y){const E=new Sx(e,a,m);E.setRealPlayer(S),c.push(E)}return S});c.forEach(p=>{Hi(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function WW(i,e,t){let n;if(i instanceof Map){if(n=i.get(e),n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&i.delete(e)}}else if(n=i[e],n){if(n.length){const r=n.indexOf(t);n.splice(r,1)}0==n.length&&delete i[e]}return n}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>cr(p,wI));const f=Ro(d);return f.onDestroy(()=>{u.forEach(p=>pc(p,wI)),cs(l,t.toStyles)}),h.forEach(p=>{Hi(r,p,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new zh(e.duration,e.delay)}}class Sx{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new zh,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>ix(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Hi(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function am(i){return i&&1===i.nodeType}function NI(i,e){const t=i.style.display;return i.style.display=null!=e?e:"none",t}function kI(i,e,t,n,r){const s=[];t.forEach(l=>s.push(NI(l)));const o=[];n.forEach((l,c)=>{const u={};l.forEach(h=>{const d=u[h]=e.computeStyle(c,h,r);(!d||0==d.length)&&(c[lr]=VW,o.push(c))}),i.set(c,u)});let a=0;return t.forEach(l=>NI(l,s[a++])),o}function BI(i,e){const t=new Map;if(i.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function cr(i,e){var t;null===(t=i.classList)||void 0===t||t.add(e)}function pc(i,e){var t;null===(t=i.classList)||void 0===t||t.remove(e)}function $W(i,e,t){Ro(t).onDone(()=>i.processLeaveNode(e))}function zI(i,e){for(let t=0;t<i.length;t++){const n=i[t];n instanceof cI?zI(n.players,e):e.push(n)}}function UI(i,e,t){const n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}class lm{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new GW(e,t,n),this._timelineEngine=new OW(e,t,n),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,n,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],u=px(this._driver,s,l,[]);if(l.length)throw function NG(i,e){return new We(3404,Mt)}();a=function RW(i,e,t){return new PW(i,e,t)}(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n,r){this._transitionEngine.removeNode(e,t,r||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if("@"==n.charAt(0)){const[s,o]=dI(n);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if("@"==n.charAt(0)){const[o,a]=dI(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let KW=(()=>{class i{constructor(t,n,r){this._element=t,this._startStyles=n,this._endStyles=r,this._state=0;let s=i.initialStylesByElement.get(t);s||i.initialStylesByElement.set(t,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&cs(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(cs(this._element,this._initialStyles),this._endStyles&&(cs(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(La(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(La(this._element,this._endStyles),this._endStyles=null),cs(this._element,this._initialStyles),this._state=3)}}return i.initialStylesByElement=new WeakMap,i})();function Ex(i){let e=null;const t=Object.keys(i);for(let n=0;n<t.length;n++){const r=t[n];QW(r)&&(e=e||{},e[r]=i[r])}return e}function QW(i){return"display"===i||"position"===i}class VI{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(n=>{"offset"!=n&&(e[n]=this._finished?t[n]:CI(this.element,n))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}}class JW{validateStyleProperty(e){return gI(e)}matchesElement(e,t){return!1}containsElement(e,t){return yI(e,t)}getParentElement(e){return ax(e)}query(e,t,n){return _I(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}animate(e,t,n,r,s,o=[]){const l={duration:n,delay:r,fill:0==r?"both":"forwards"};s&&(l.easing=s);const c={},u=o.filter(d=>d instanceof VI);(function iW(i,e){return 0===i||0===e})(n,r)&&u.forEach(d=>{let f=d.currentSnapshot;Object.keys(f).forEach(p=>c[p]=f[p])}),t=function rW(i,e,t){const n=Object.keys(t);if(n.length&&e.length){let s=e[0],o=[];if(n.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=t[a]}),o.length)for(var r=1;r<e.length;r++){let a=e[r];o.forEach(function(l){a[l]=CI(i,l)})}}return e}(e,t=t.map(d=>Po(d,!1)),c);const h=function YW(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Ex(e[0]),e.length>1&&(n=Ex(e[e.length-1]))):e&&(t=Ex(e)),t||n?new KW(i,t,n):null}(e,t);return new VI(e,t,l,h)}}let ej=(()=>{class i extends nI{constructor(t,n){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(n.body,{id:"0",encapsulation:Mr.None,styles:[],data:{animation:[]}})}build(t){const n=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?rI(t):t;return HI(this._renderer,null,n,"register",[r]),new tj(n,this._renderer)}}return i.\u0275fac=function(t){return new(t||i)(je(mh),je(Ei))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();class tj extends class pG{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new nj(this._id,e,t||{},this._renderer)}}class nj{constructor(e,t,n,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return HI(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function HI(i,e,t,n,r){return i.setProperty(e,`@@${t}:${n}`,r)}const GI="@.disabled";let ij=(()=>{class i{constructor(t,n,r){this.delegate=t,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,n){const s=this.delegate.createRenderer(t,n);if(!(t&&n&&n.data&&n.data.animation)){let u=this._rendererCache.get(s);return u||(u=new WI("",s,this.engine),this._rendererCache.set(s,u)),u}const o=n.id,a=n.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return n.data.animation.forEach(l),new rj(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,n,r){t>=0&&t<this._microtaskId?this._zone.run(()=>n(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return i.\u0275fac=function(t){return new(t||i)(je(mh),je(lm),je(nn))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();class WI{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&t==GI?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class rj extends WI{constructor(e,t,n,r){super(t,n,r),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&t==GI?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const r=function sj(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(e);let s=t.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function oj(i){const e=i.indexOf(".");return[i.substring(0,e),i.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,n,a)})}return this.delegate.listen(e,t,n)}}let aj=(()=>{class i extends lm{constructor(t,n,r){super(t.body,n,r)}ngOnDestroy(){this.flush()}}return i.\u0275fac=function(t){return new(t||i)(je(Ei),je(lx),je(vx))},i.\u0275prov=mt({token:i,factory:i.\u0275fac}),i})();const jI=new At("AnimationModuleType"),qI=[{provide:nI,useClass:ej},{provide:vx,useFactory:function lj(){return new CW}},{provide:lm,useClass:aj},{provide:mh,useFactory:function cj(i,e,t){return new ij(i,e,t)},deps:[Ap,lm,nn]}],$I=[{provide:lx,useFactory:()=>new JW},{provide:jI,useValue:"BrowserAnimations"},...qI],uj=[{provide:lx,useClass:vI},{provide:jI,useValue:"NoopAnimations"},...qI];let hj=(()=>{class i{static withConfig(t){return{ngModule:i,providers:t.disableAnimations?uj:$I}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=fa({type:i}),i.\u0275inj=ho({providers:$I,imports:[$A]}),i})();function XI(i,e,t,n,r,s,o){try{var a=i[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(n,r)}const Fo=1e3,gi=1001,pn=1003,Kt=1006,Oo=1008,ka=1009,Ba=1014,kr=1015,Us=1016,vc=1020,Ti=1023,za=1026,xc=1027,jh=2300,wc=2301,hs=3e3,Pt=3001,Vs="srgb",Va="srgb-linear";class Ha{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Xn=[];for(let i=0;i<256;i++)Xn[i]=(i<16?"0":"")+i.toString(16);let DR=1234567;const Ga=Math.PI/180,qh=180/Math.PI;function Wi(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Xn[255&i]+Xn[i>>8&255]+Xn[i>>16&255]+Xn[i>>24&255]+"-"+Xn[255&e]+Xn[e>>8&255]+"-"+Xn[e>>16&15|64]+Xn[e>>24&255]+"-"+Xn[63&t|128]+Xn[t>>8&255]+"-"+Xn[t>>16&255]+Xn[t>>24&255]+Xn[255&n]+Xn[n>>8&255]+Xn[n>>16&255]+Xn[n>>24&255]).toLowerCase()}function mn(i,e,t){return Math.max(e,Math.min(t,i))}function zx(i,e){return(i%e+e)%e}function $h(i,e,t){return(1-t)*i+t*e}function Ux(i){return 0==(i&i-1)&&0!==i}function IR(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function ym(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var C9=Object.freeze({__proto__:null,DEG2RAD:Ga,RAD2DEG:qh,generateUUID:Wi,clamp:mn,euclideanModulo:zx,mapLinear:function h9(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function d9(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:$h,damp:function f9(i,e,t,n){return $h(i,e,1-Math.exp(-t*n))},pingpong:function p9(i,e=1){return e-Math.abs(zx(i,2*e)-e)},smoothstep:function m9(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function g9(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function y9(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function _9(i,e){return i+Math.random()*(e-i)},randFloatSpread:function v9(i){return i*(.5-Math.random())},seededRandom:function x9(i){void 0!==i&&(DR=i);let e=DR+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function w9(i){return i*Ga},radToDeg:function b9(i){return i*qh},isPowerOfTwo:Ux,ceilPowerOfTwo:IR,floorPowerOfTwo:ym,setQuaternionFromProperEuler:function M9(i,e,t,n,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),c=s((e+n)/2),u=o((e+n)/2),h=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),p=o((n-e)/2);switch(r){case"XYX":i.set(a*u,l*h,l*d,a*c);break;case"YZY":i.set(l*d,a*u,l*h,a*c);break;case"ZXZ":i.set(l*h,l*d,a*u,a*c);break;case"XZX":i.set(a*u,l*p,l*f,a*c);break;case"YXY":i.set(l*f,a*u,l*p,a*c);break;case"ZYZ":i.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function E9(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}},denormalize:function S9(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}});class ne{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Br{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],p=n[8],m=r[0],g=r[3],y=r[6],_=r[1],v=r[4],x=r[7],b=r[2],S=r[5],E=r[8];return s[0]=o*m+a*_+l*b,s[3]=o*g+a*v+l*S,s[6]=o*y+a*x+l*E,s[1]=c*m+u*_+h*b,s[4]=c*g+u*v+h*S,s[7]=c*y+u*x+h*E,s[2]=d*m+f*_+p*b,s[5]=d*g+f*v+p*S,s[8]=d*y+f*x+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+n*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*c-u*n)*m,e[2]=(a*n-r*o)*m,e[3]=d*m,e[4]=(u*t-r*l)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(n*l-c*t)*m,e[8]=(o*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+n*l,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*s+t*l,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function RR(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function Xh(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Wa(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function _m(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Vx={[Vs]:{[Va]:Wa},[Va]:{[Vs]:_m}},zr={legacyMode:!0,get workingColorSpace(){return Va},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Vx[e]&&void 0!==Vx[e][t]){const n=Vx[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},PR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Rn={r:0,g:0,b:0},Ur={h:0,s:0,l:0},vm={h:0,s:0,l:0};function Hx(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function xm(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let Ec,we=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Vs){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,zr.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=Va){return this.r=t,this.g=n,this.b=r,zr.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=Va){if(t=zx(t,1),n=mn(n,0,1),r=mn(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=Hx(a,o,t+1/3),this.g=Hx(a,o,t),this.b=Hx(a,o,t-1/3)}return zr.toWorkingColorSpace(this,s),this}setStyle(t,n=Vs){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,zr.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,zr.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,h=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(c,u,h,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,zr.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,zr.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=Vs){const r=PR[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Wa(t.r),this.g=Wa(t.g),this.b=Wa(t.b),this}copyLinearToSRGB(t){return this.r=_m(t.r),this.g=_m(t.g),this.b=_m(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Vs){return zr.fromWorkingColorSpace(xm(this,Rn),t),mn(255*Rn.r,0,255)<<16^mn(255*Rn.g,0,255)<<8^mn(255*Rn.b,0,255)<<0}getHexString(t=Vs){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Va){zr.fromWorkingColorSpace(xm(this,Rn),n);const r=Rn.r,s=Rn.g,o=Rn.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const d=a-l;switch(u=h<=.5?d/(a+l):d/(2-a-l),a){case r:c=(s-o)/d+(s<o?6:0);break;case s:c=(o-r)/d+2;break;case o:c=(r-s)/d+4}c/=6}return t.h=c,t.s=u,t.l=h,t}getRGB(t,n=Va){return zr.fromWorkingColorSpace(xm(this,Rn),n),t.r=Rn.r,t.g=Rn.g,t.b=Rn.b,t}getStyle(t=Vs){return zr.fromWorkingColorSpace(xm(this,Rn),t),t!==Vs?`color(${t} ${Rn.r} ${Rn.g} ${Rn.b})`:`rgb(${255*Rn.r|0},${255*Rn.g|0},${255*Rn.b|0})`}offsetHSL(t,n,r){return this.getHSL(Ur),Ur.h+=t,Ur.s+=n,Ur.l+=r,this.setHSL(Ur.h,Ur.s,Ur.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(Ur),t.getHSL(vm);const r=$h(Ur.h,vm.h,n),s=$h(Ur.s,vm.s,n),o=$h(Ur.l,vm.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=PR,i})();class LR{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Ec&&(Ec=Xh("canvas")),Ec.width=e.width,Ec.height=e.height;const n=Ec.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ec}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Xh("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*Wa(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Wa(t[n]/255)):Wa(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Cc{constructor(e=null){this.isSource=!0,this.uuid=Wi(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Gx(r[o].isDataTexture?r[o].image:r[o]))}else s=Gx(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function Gx(i){return"undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&i instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap?LR.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let A9=0,hr=(()=>{class i extends Ha{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=gi,s=gi,o=Kt,a=Oo,l=Ti,c=ka,u=1,h=hs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:A9++}),this.uuid=Wi(),this.name="",this.source=new Cc(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new ne(0,0),this.repeat=new ne(1,1),this.center=new ne(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Br,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Fo:t.x=t.x-Math.floor(t.x);break;case gi:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Fo:t.y=t.y-Math.floor(t.y);break;case gi:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i})();class Vt{constructor(e=0,t=0,n=0,r=1){this.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(c+1)/2,x=(f+1)/2,b=(y+1)/2,S=(u+d)/4,E=(h+m)/4,w=(p+g)/4;return v>x&&v>b?v<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(v),r=S/n,s=E/n):x>b?x<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),n=S/r,s=w/r):b<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),n=E/s,r=w/s),this.set(n,r,s,t),this}let _=Math.sqrt((g-p)*(g-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(_)<.001&&(_=1),this.x=(g-p)/_,this.y=(h-m)/_,this.z=(d-u)/_,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ai extends Ha{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Vt(0,0,e,t),this.scissorTest=!1,this.viewport=new Vt(0,0,e,t),this.texture=new hr({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:Kt,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Cc(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Wx extends hr{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=pn,this.minFilter=pn,this.wrapR=gi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class oi{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||l!==d||c!==f||u!==p){let g=1-a;const y=l*d+c*f+u*p+h*m,_=y>=0?1:-1,v=1-y*y;if(v>Number.EPSILON){const b=Math.sqrt(v),S=Math.atan2(b,y*_);g=Math.sin(g*S)/b,a=Math.sin(a*S)/b}const x=a*_;if(l=l*g+d*x,c=c*g+f*x,u=u*g+p*x,h=h*g+m*x,g===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=b,c*=b,u*=b,h*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=n+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>h){const f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-n-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(e=0,t=0,n=0){this.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(OR.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(OR.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,u=l*n+a*t-s*r,h=l*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return jx.copy(this).projectOnVector(e),this.sub(jx)}reflect(e){return this.sub(jx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(mn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-lM(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const jx=new D,OR=new oi;class Hs{constructor(e=new D(1/0,1/0,1/0),t=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],h=e[l+1],d=e[l+2];u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),h=e.getY(l),d=e.getZ(l);u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=ja.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)ja.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(ja)}else null===n.boundingBox&&n.computeBoundingBox(),qx.copy(n.boundingBox),qx.applyMatrix4(e.matrixWorld),this.union(qx);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ja),ja.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Zh),wm.subVectors(this.max,Zh),Tc.subVectors(e.a,Zh),Ac.subVectors(e.b,Zh),Dc.subVectors(e.c,Zh),No.subVectors(Ac,Tc),ko.subVectors(Dc,Ac),qa.subVectors(Tc,Dc);let t=[0,-No.z,No.y,0,-ko.z,ko.y,0,-qa.z,qa.y,No.z,0,-No.x,ko.z,0,-ko.x,qa.z,0,-qa.x,-No.y,No.x,0,-ko.y,ko.x,0,-qa.y,qa.x,0];return!(!$x(t,Tc,Ac,Dc,wm)||(t=[1,0,0,0,1,0,0,0,1],!$x(t,Tc,Ac,Dc,wm)))&&(bm.crossVectors(No,ko),t=[bm.x,bm.y,bm.z],$x(t,Tc,Ac,Dc,wm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return ja.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(ja).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Gs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Gs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Gs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Gs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Gs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Gs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Gs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Gs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Gs)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Gs=[new D,new D,new D,new D,new D,new D,new D,new D],ja=new D,qx=new Hs,Tc=new D,Ac=new D,Dc=new D,No=new D,ko=new D,qa=new D,Zh=new D,wm=new D,bm=new D,$a=new D;function $x(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){$a.fromArray(i,s);const a=r.x*Math.abs($a.x)+r.y*Math.abs($a.y)+r.z*Math.abs($a.z),l=e.dot($a),c=t.dot($a),u=n.dot($a);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}const D9=new Hs,NR=new D,Mm=new D,Xx=new D;class Xa{constructor(e=new D,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):D9.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Xx.subVectors(e,this.center);const t=Xx.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Xx.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?Mm.set(0,0,1).multiplyScalar(e.radius):Mm.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(NR.copy(e.center).add(Mm)),this.expandByPoint(NR.copy(e.center).sub(Mm)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ws=new D,Zx=new D,Sm=new D,Bo=new D,Yx=new D,Em=new D,Kx=new D;class Cm{constructor(e=new D,t=new D(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ws)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ws.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ws.copy(this.direction).multiplyScalar(t).add(this.origin),Ws.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Zx.copy(e).add(t).multiplyScalar(.5),Sm.copy(t).sub(e).normalize(),Bo.copy(this.origin).sub(Zx);const s=.5*e.distanceTo(t),o=-this.direction.dot(Sm),a=Bo.dot(this.direction),l=-Bo.dot(Sm),c=Bo.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(Sm).multiplyScalar(d).add(Zx),f}intersectSphere(e,t){Ws.subVectors(e.center,this.origin);const n=Ws.dot(this.direction),r=Ws.dot(Ws)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Ws)}intersectTriangle(e,t,n,r,s){Yx.subVectors(t,e),Em.subVectors(n,e),Kx.crossVectors(Yx,Em);let a,o=this.direction.dot(Kx);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Bo.subVectors(this.origin,e);const l=a*this.direction.dot(Em.crossVectors(Bo,Em));if(l<0)return null;const c=a*this.direction.dot(Yx.cross(Bo));if(c<0||l+c>o)return null;const u=-a*Bo.dot(Kx);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class ft{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c,u,h,d,f,p,m,g){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=d,y[3]=f,y[7]=p,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new ft).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/Ic.setFromMatrixColumn(e,0).length(),s=1/Ic.setFromMatrixColumn(e,1).length(),o=1/Ic.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-m*c,t[9]=-a*l,t[2]=m-d*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*l}else if("ZXY"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+m,t[1]=l*h,t[5]=m*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(I9,e,R9)}lookAt(e,t,n){const r=this.elements;return ji.subVectors(e,t),0===ji.lengthSq()&&(ji.z=1),ji.normalize(),zo.crossVectors(n,ji),0===zo.lengthSq()&&(1===Math.abs(n.z)?ji.x+=1e-4:ji.z+=1e-4,ji.normalize(),zo.crossVectors(n,ji)),zo.normalize(),Tm.crossVectors(ji,zo),r[0]=zo.x,r[4]=Tm.x,r[8]=ji.x,r[1]=zo.y,r[5]=Tm.y,r[9]=ji.y,r[2]=zo.z,r[6]=Tm.z,r[10]=ji.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],p=n[2],m=n[6],g=n[10],y=n[14],_=n[3],v=n[7],x=n[11],b=n[15],S=r[0],E=r[4],w=r[8],T=r[12],I=r[1],k=r[5],W=r[9],$=r[13],N=r[2],G=r[6],F=r[10],z=r[14],V=r[3],U=r[7],j=r[11],te=r[15];return s[0]=o*S+a*I+l*N+c*V,s[4]=o*E+a*k+l*G+c*U,s[8]=o*w+a*W+l*F+c*j,s[12]=o*T+a*$+l*z+c*te,s[1]=u*S+h*I+d*N+f*V,s[5]=u*E+h*k+d*G+f*U,s[9]=u*w+h*W+d*F+f*j,s[13]=u*T+h*$+d*z+f*te,s[2]=p*S+m*I+g*N+y*V,s[6]=p*E+m*k+g*G+y*U,s[10]=p*w+m*W+g*F+y*j,s[14]=p*T+m*$+g*z+y*te,s[3]=_*S+v*I+x*N+b*V,s[7]=_*E+v*k+x*G+b*U,s[11]=_*w+v*W+x*F+b*j,s[15]=_*T+v*$+x*z+b*te,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*l*h-r*c*h-s*a*d+n*c*d+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*h-t*a*f-s*o*h+n*o*f+s*a*u-n*c*u)+e[15]*(-r*a*u-t*l*h+t*a*d+r*o*h-n*o*d+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],_=h*g*c-m*d*c+m*l*f-a*g*f-h*l*y+a*d*y,v=p*d*c-u*g*c-p*l*f+o*g*f+u*l*y-o*d*y,x=u*m*c-p*h*c+p*a*f-o*m*f-u*a*y+o*h*y,b=p*h*l-u*m*l-p*a*d+o*m*d+u*a*g-o*h*g,S=t*_+n*v+r*x+s*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/S;return e[0]=_*E,e[1]=(m*d*s-h*g*s-m*r*f+n*g*f+h*r*y-n*d*y)*E,e[2]=(a*g*s-m*l*s+m*r*c-n*g*c-a*r*y+n*l*y)*E,e[3]=(h*l*s-a*d*s-h*r*c+n*d*c+a*r*f-n*l*f)*E,e[4]=v*E,e[5]=(u*g*s-p*d*s+p*r*f-t*g*f-u*r*y+t*d*y)*E,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*y-t*l*y)*E,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*E,e[8]=x*E,e[9]=(p*h*s-u*m*s-p*n*f+t*m*f+u*n*y-t*h*y)*E,e[10]=(o*m*s-p*a*s+p*n*c-t*m*c-o*n*y+t*a*y)*E,e[11]=(u*a*s-o*h*s-u*n*c+t*h*c+o*n*f-t*a*f)*E,e[12]=b*E,e[13]=(u*m*r-p*h*r+p*n*d-t*m*d-u*n*g+t*h*g)*E,e[14]=(p*a*r-o*m*r-p*n*l+t*m*l+o*n*g-t*a*g)*E,e[15]=(o*h*r-u*a*r+u*n*l-t*h*l-o*n*d+t*a*d)*E,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,m=o*u,g=o*h,y=a*h,_=l*c,v=l*u,x=l*h,b=n.x,S=n.y,E=n.z;return r[0]=(1-(m+y))*b,r[1]=(f+x)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(d+y))*S,r[6]=(g+_)*S,r[7]=0,r[8]=(p+v)*E,r[9]=(g-_)*E,r[10]=(1-(d+m))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=Ic.set(r[0],r[1],r[2]).length();const o=Ic.set(r[4],r[5],r[6]).length(),a=Ic.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Vr.copy(this);const c=1/s,u=1/o,h=1/a;return Vr.elements[0]*=c,Vr.elements[1]*=c,Vr.elements[2]*=c,Vr.elements[4]*=u,Vr.elements[5]*=u,Vr.elements[6]*=u,Vr.elements[8]*=h,Vr.elements[9]*=h,Vr.elements[10]*=h,t.setFromRotationMatrix(Vr),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),u=1/(o-s),h=(t+e)*l,d=(n+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const Ic=new D,Vr=new ft,I9=new D(0,0,0),R9=new D(1,1,1),zo=new D,Tm=new D,ji=new D,kR=new ft,BR=new oi;let Yh=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin(mn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-mn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(mn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-mn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(mn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-mn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return kR.makeRotationFromQuaternion(t),this.setFromRotationMatrix(kR,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return BR.setFromEuler(this),this.setFromQuaternion(BR,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class Qx{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let P9=0;const zR=new D,Rc=new oi,js=new ft,Am=new D,Kh=new D,L9=new D,F9=new oi,UR=new D(1,0,0),VR=new D(0,1,0),HR=new D(0,0,1),O9={type:"added"},GR={type:"removed"};class sn extends Ha{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:P9++}),this.uuid=Wi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=sn.DefaultUp.clone();const e=new D,t=new Yh,n=new oi,r=new D(1,1,1);t._onChange(function s(){n.setFromEuler(t,!1)}),n._onChange(function o(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ft},normalMatrix:{value:new Br}}),this.matrix=new ft,this.matrixWorld=new ft,this.matrixAutoUpdate=sn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Qx,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Rc.setFromAxisAngle(e,t),this.quaternion.multiply(Rc),this}rotateOnWorldAxis(e,t){return Rc.setFromAxisAngle(e,t),this.quaternion.premultiply(Rc),this}rotateX(e){return this.rotateOnAxis(UR,e)}rotateY(e){return this.rotateOnAxis(VR,e)}rotateZ(e){return this.rotateOnAxis(HR,e)}translateOnAxis(e,t){return zR.copy(e).applyQuaternion(this.quaternion),this.position.add(zR.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(UR,e)}translateY(e){return this.translateOnAxis(VR,e)}translateZ(e){return this.translateOnAxis(HR,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(js.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Am.copy(e):Am.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Kh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?js.lookAt(Kh,Am,this.up):js.lookAt(Am,Kh,this.up),this.quaternion.setFromRotationMatrix(js),r&&(js.extractRotation(r.matrixWorld),Rc.setFromRotationMatrix(js),this.quaternion.premultiply(Rc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(O9)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(GR)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(GR)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),js.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),js.multiply(e.parent.matrixWorld)),e.applyMatrix4(js),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,e,L9),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,F9,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),p.length>0&&(n.nodes=p)}return n.object=r,n;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}sn.DefaultUp=new D(0,1,0),sn.DefaultMatrixAutoUpdate=!0;const Hr=new D,qs=new D,Jx=new D,$s=new D,Pc=new D,Lc=new D,WR=new D,ew=new D,tw=new D,nw=new D;class Gr{constructor(e=new D,t=new D,n=new D){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Hr.subVectors(e,t),r.cross(Hr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Hr.subVectors(r,t),qs.subVectors(n,t),Jx.subVectors(e,t);const o=Hr.dot(Hr),a=Hr.dot(qs),l=Hr.dot(Jx),c=qs.dot(qs),u=qs.dot(Jx),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,$s),$s.x>=0&&$s.y>=0&&$s.x+$s.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,$s),l.set(0,0),l.addScaledVector(s,$s.x),l.addScaledVector(o,$s.y),l.addScaledVector(a,$s.z),l}static isFrontFacing(e,t,n,r){return Hr.subVectors(n,t),qs.subVectors(e,t),Hr.cross(qs).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Hr.subVectors(this.c,this.b),qs.subVectors(this.a,this.b),.5*Hr.cross(qs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gr.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return Gr.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Gr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;Pc.subVectors(r,n),Lc.subVectors(s,n),ew.subVectors(e,n);const l=Pc.dot(ew),c=Lc.dot(ew);if(l<=0&&c<=0)return t.copy(n);tw.subVectors(e,r);const u=Pc.dot(tw),h=Lc.dot(tw);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(Pc,o);nw.subVectors(e,s);const f=Pc.dot(nw),p=Lc.dot(nw);if(p>=0&&f<=p)return t.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(n).addScaledVector(Lc,a);const g=u*p-f*h;if(g<=0&&h-u>=0&&f-p>=0)return WR.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(WR,a);const y=1/(g+m+d);return o=m*y,a=d*y,t.copy(n).addScaledVector(Pc,o).addScaledVector(Lc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let N9=0,un=(()=>{class i extends Ha{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:N9++}),this.uuid=Wi(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const n in t){const r=t[n];if(void 0===r){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if("shading"===n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const s=this[n];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.")}}toJSON(t){const n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){const o=s(t.textures),a=s(t.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(null!==n){const s=n.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}return i.fromType=function(){return null},i})();class Di extends un{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new we(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Mn=new D,Dm=new ne;class Sn{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new we),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new ne),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new D),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Vt),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Dm.fromBufferAttribute(this,t),Dm.applyMatrix3(e),this.setXY(t,Dm.x,Dm.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyMatrix3(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyMatrix4(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.applyNormalMatrix(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Mn.fromBufferAttribute(this,t),Mn.transformDirection(e),this.setXYZ(t,Mn.x,Mn.y,Mn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class jR extends Sn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class qR extends Sn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class ke extends Sn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let k9=0;const dr=new ft,iw=new sn,Fc=new D,qi=new Hs,Qh=new Hs,Nn=new D;class lt extends Ha{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:k9++}),this.uuid=Wi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(RR(e)?qR:jR)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new Br).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return dr.makeRotationFromQuaternion(e),this.applyMatrix4(dr),this}rotateX(e){return dr.makeRotationX(e),this.applyMatrix4(dr),this}rotateY(e){return dr.makeRotationY(e),this.applyMatrix4(dr),this}rotateZ(e){return dr.makeRotationZ(e),this.applyMatrix4(dr),this}translate(e,t,n){return dr.makeTranslation(e,t,n),this.applyMatrix4(dr),this}scale(e,t,n){return dr.makeScale(e,t,n),this.applyMatrix4(dr),this}lookAt(e){return iw.lookAt(e),iw.updateMatrix(),this.applyMatrix4(iw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fc).negate(),this.translate(Fc.x,Fc.y,Fc.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ke(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Hs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new D(-1/0,-1/0,-1/0),new D(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)qi.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Nn.addVectors(this.boundingBox.min,qi.min),this.boundingBox.expandByPoint(Nn),Nn.addVectors(this.boundingBox.max,qi.max),this.boundingBox.expandByPoint(Nn)):(this.boundingBox.expandByPoint(qi.min),this.boundingBox.expandByPoint(qi.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Xa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new D,1/0);if(e){const n=this.boundingSphere.center;if(qi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Qh.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Nn.addVectors(qi.min,Qh.min),qi.expandByPoint(Nn),Nn.addVectors(qi.max,Qh.max),qi.expandByPoint(Nn)):(qi.expandByPoint(Qh.min),qi.expandByPoint(Qh.max));qi.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Nn.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Nn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Nn.fromBufferAttribute(a,c),l&&(Fc.fromBufferAttribute(e,c),Nn.add(Fc)),r=Math.max(r,n.distanceToSquared(Nn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Sn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new D,u[I]=new D;const h=new D,d=new D,f=new D,p=new ne,m=new ne,g=new ne,y=new D,_=new D;function v(I,k,W){h.fromArray(r,3*I),d.fromArray(r,3*k),f.fromArray(r,3*W),p.fromArray(o,2*I),m.fromArray(o,2*k),g.fromArray(o,2*W),d.sub(h),f.sub(h),m.sub(p),g.sub(p);const $=1/(m.x*g.y-g.x*m.y);!isFinite($)||(y.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar($),_.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar($),c[I].add(y),c[k].add(y),c[W].add(y),u[I].add(_),u[k].add(_),u[W].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let I=0,k=x.length;I<k;++I){const W=x[I],$=W.start;for(let G=$,F=$+W.count;G<F;G+=3)v(n[G+0],n[G+1],n[G+2])}const b=new D,S=new D,E=new D,w=new D;function T(I){E.fromArray(s,3*I),w.copy(E);const k=c[I];b.copy(k),b.sub(E.multiplyScalar(E.dot(k))).normalize(),S.crossVectors(w,k);const $=S.dot(u[I])<0?-1:1;l[4*I]=b.x,l[4*I+1]=b.y,l[4*I+2]=b.z,l[4*I+3]=$}for(let I=0,k=x.length;I<k;++I){const W=x[I],$=W.start;for(let G=$,F=$+W.count;G<F;G+=3)T(n[G+0]),T(n[G+1]),T(n[G+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new Sn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new D,s=new D,o=new D,a=new D,l=new D,c=new D,u=new D,h=new D;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),a.add(u),l.add(u),c.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const o=n[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let h=0,d=c;h<u;h++,d++)o[d]=l[h]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Nn.fromBufferAttribute(e,t),Nn.normalize(),e.setXYZ(t,Nn.x,Nn.y,Nn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){f=a.isInterleavedBufferAttribute?l[m]*a.data.stride+a.offset:l[m]*u;for(let y=0;y<u;y++)d[p++]=c[f++]}return new Sn(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new lt,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=e(c[u],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++)u.push(c[h].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const $R=new ft,Oc=new Cm,rw=new Xa,Uo=new D,Vo=new D,Ho=new D,sw=new D,ow=new D,aw=new D,Im=new D,Rm=new D,Pm=new D,Lm=new ne,Fm=new ne,Om=new ne,lw=new D,Nm=new D;class kn extends sn{constructor(e=new lt,t=new Di){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),rw.copy(n.boundingSphere),rw.applyMatrix4(s),!1===e.ray.intersectsSphere(rw))||($R.copy(s).invert(),Oc.copy(e.ray).applyMatrix4($R),null!==n.boundingBox&&!1===Oc.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,d=n.attributes.uv2,f=n.groups,p=n.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const y=f[m],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(a.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3){const E=a.getX(b),w=a.getX(b+1),T=a.getX(b+2);o=km(this,_,e,Oc,l,c,u,h,d,E,w,T),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}}else for(let y=Math.max(0,p.start),_=Math.min(a.count,p.start+p.count);y<_;y+=3){const v=a.getX(y),x=a.getX(y+1),b=a.getX(y+2);o=km(this,r,e,Oc,l,c,u,h,d,v,x,b),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const y=f[m],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(l.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3)o=km(this,_,e,Oc,l,c,u,h,d,b,b+1,b+2),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}else for(let y=Math.max(0,p.start),_=Math.min(l.count,p.start+p.count);y<_;y+=3)o=km(this,r,e,Oc,l,c,u,h,d,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}}function km(i,e,t,n,r,s,o,a,l,c,u,h){Uo.fromBufferAttribute(r,c),Vo.fromBufferAttribute(r,u),Ho.fromBufferAttribute(r,h);const d=i.morphTargetInfluences;if(s&&d){Im.set(0,0,0),Rm.set(0,0,0),Pm.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const g=d[p],y=s[p];0!==g&&(sw.fromBufferAttribute(y,c),ow.fromBufferAttribute(y,u),aw.fromBufferAttribute(y,h),o?(Im.addScaledVector(sw,g),Rm.addScaledVector(ow,g),Pm.addScaledVector(aw,g)):(Im.addScaledVector(sw.sub(Uo),g),Rm.addScaledVector(ow.sub(Vo),g),Pm.addScaledVector(aw.sub(Ho),g)))}Uo.add(Im),Vo.add(Rm),Ho.add(Pm)}i.isSkinnedMesh&&(i.boneTransform(c,Uo),i.boneTransform(u,Vo),i.boneTransform(h,Ho));const f=function B9(i,e,t,n,r,s,o,a){let l;if(l=1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;Nm.copy(a),Nm.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(Nm);return c<t.near||c>t.far?null:{distance:c,point:Nm.clone(),object:i}}(i,e,t,n,Uo,Vo,Ho,lw);if(f){a&&(Lm.fromBufferAttribute(a,c),Fm.fromBufferAttribute(a,u),Om.fromBufferAttribute(a,h),f.uv=Gr.getUV(lw,Uo,Vo,Ho,Lm,Fm,Om,new ne)),l&&(Lm.fromBufferAttribute(l,c),Fm.fromBufferAttribute(l,u),Om.fromBufferAttribute(l,h),f.uv2=Gr.getUV(lw,Uo,Vo,Ho,Lm,Fm,Om,new ne));const p={a:c,b:u,c:h,normal:new D,materialIndex:0};Gr.getNormal(Uo,Vo,Ho,p.normal),f.face=p}return f}class Za extends lt{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;function p(m,g,y,_,v,x,b,S,E,w,T){const I=x/E,k=b/w,W=x/2,$=b/2,N=S/2,G=E+1,F=w+1;let z=0,V=0;const U=new D;for(let j=0;j<F;j++){const te=j*k-$;for(let Q=0;Q<G;Q++)U[m]=(Q*I-W)*_,U[g]=te*v,U[y]=N,c.push(U.x,U.y,U.z),U[m]=0,U[g]=0,U[y]=S>0?1:-1,u.push(U.x,U.y,U.z),h.push(Q/E),h.push(1-j/w),z+=1}for(let j=0;j<w;j++)for(let te=0;te<E;te++){const he=d+te+G*(j+1),ce=d+(te+1)+G*(j+1),De=d+(te+1)+G*j;l.push(d+te+G*j,he,De),l.push(he,ce,De),V+=6}a.addGroup(f,V,T),f+=V,d+=z}p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new ke(c,3)),this.setAttribute("normal",new ke(u,3)),this.setAttribute("uv",new ke(h,2))}static fromJSON(e){return new Za(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Nc(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function ai(i){const e={};for(let t=0;t<i.length;t++){const n=Nc(i[t]);for(const r in n)e[r]=n[r]}return e}const cw={clone:Nc,merge:ai};class Ii extends un{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Nc(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class uw extends sn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ft,this.projectionMatrix=new ft,this.projectionMatrixInverse=new ft}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Bn extends uw{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*qh*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ga*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*qh*Math.atan(Math.tan(.5*Ga*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Ga*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class V9 extends sn{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new Bn(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new D(1,0,0)),this.add(r);const s=new Bn(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new D(-1,0,0)),this.add(s);const o=new Bn(90,1,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(new D(0,1,0)),this.add(o);const a=new Bn(90,1,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new D(0,-1,0)),this.add(a);const l=new Bn(90,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new D(0,0,1)),this.add(l);const c=new Bn(90,1,e,t);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new D(0,0,-1)),this.add(c)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,o,a,l,c]=this.children,u=e.getRenderTarget(),h=e.toneMapping,d=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,a),e.setRenderTarget(n,4),e.render(t,l),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,c),e.setRenderTarget(u),e.toneMapping=h,e.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}class Bm extends hr{constructor(e,t,n,r,s,o,a,l,c,u){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,r,s,o,a,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class H9 extends Ai{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new Bm([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:Kt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Za(5,5,5),s=new Ii({name:"CubemapFromEquirect",uniforms:Nc(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const o=new kn(r,s),a=t.minFilter;return t.minFilter===Oo&&(t.minFilter=Kt),new V9(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}}const hw=new D,G9=new D,W9=new Br;class Ya{constructor(e=new D(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=hw.subVectors(n,t).cross(G9.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(hw),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||W9.getNormalMatrix(e),r=this.coplanarPoint(hw).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const zc=new Xa,zm=new D;class dw{constructor(e=new Ya,t=new Ya,n=new Ya,r=new Ya,s=new Ya,o=new Ya){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],f=n[9],p=n[10],m=n[11],g=n[12],y=n[13],_=n[14],v=n[15];return t[0].setComponents(a-r,h-l,m-d,v-g).normalize(),t[1].setComponents(a+r,h+l,m+d,v+g).normalize(),t[2].setComponents(a+s,h+c,m+f,v+y).normalize(),t[3].setComponents(a-s,h-c,m-f,v-y).normalize(),t[4].setComponents(a-o,h-u,m-p,v-_).normalize(),t[5].setComponents(a+o,h+u,m+p,v+_).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),zc.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSprite(e){return zc.center.set(0,0,0),zc.radius=.7071067811865476,zc.applyMatrix4(e.matrixWorld),this.intersectsSphere(zc)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(zm.x=r.normal.x>0?e.max.x:e.min.x,zm.y=r.normal.y>0?e.max.y:e.min.y,zm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(zm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function XR(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function j9(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)},remove:function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(i.deleteBuffer(u.buffer),n.delete(c))},update:function l(c,u){if(c.isGLBufferAttribute){const d=n.get(c);return void((!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version}))}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);void 0===h?n.set(c,function r(c,u){const h=c.array,d=c.usage,f=i.createBuffer();let p;if(i.bindBuffer(u,f),i.bufferData(u,h,d),c.onUploadCallback(),h instanceof Float32Array)p=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");p=5131}else p=5123;else if(h instanceof Int16Array)p=5122;else if(h instanceof Uint32Array)p=5125;else if(h instanceof Int32Array)p=5124;else if(h instanceof Int8Array)p=5120;else if(h instanceof Uint8Array)p=5121;else{if(!(h instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);p=5121}return{buffer:f,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}(c,u)):h.version<c.version&&(function s(c,u,h){const d=u.array,f=u.updateRange;i.bindBuffer(h,c),-1===f.count?i.bufferSubData(h,0,d):(t?i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):i.bufferSubData(h,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1)}(h.buffer,c,u),h.version=c.version)}}}class Jh extends lt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(n),l=Math.floor(r),c=a+1,u=l+1,h=e/a,d=t/l,f=[],p=[],m=[],g=[];for(let y=0;y<u;y++){const _=y*d-o;for(let v=0;v<c;v++)p.push(v*h-s,-_,0),m.push(0,0,1),g.push(v/a),g.push(1-y/l)}for(let y=0;y<l;y++)for(let _=0;_<a;_++){const x=_+c*(y+1),b=_+1+c*(y+1),S=_+1+c*y;f.push(_+c*y,x,S),f.push(x,b,S)}this.setIndex(f),this.setAttribute("position",new ke(p,3)),this.setAttribute("normal",new ke(m,3)),this.setAttribute("uv",new ke(g,2))}static fromJSON(e){return new Jh(e.width,e.height,e.widthSegments,e.heightSegments)}}const xt={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Pe={common:{diffuse:{value:new we(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Br},uv2Transform:{value:new Br},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new ne(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new we(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new we(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Br}},sprite:{diffuse:{value:new we(16777215)},opacity:{value:1},center:{value:new ne(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Br}}},ds={basic:{uniforms:ai([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:xt.meshbasic_vert,fragmentShader:xt.meshbasic_frag},lambert:{uniforms:ai([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.fog,Pe.lights,{emissive:{value:new we(0)}}]),vertexShader:xt.meshlambert_vert,fragmentShader:xt.meshlambert_frag},phong:{uniforms:ai([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new we(0)},specular:{value:new we(1118481)},shininess:{value:30}}]),vertexShader:xt.meshphong_vert,fragmentShader:xt.meshphong_frag},standard:{uniforms:ai([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new we(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag},toon:{uniforms:ai([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new we(0)}}]),vertexShader:xt.meshtoon_vert,fragmentShader:xt.meshtoon_frag},matcap:{uniforms:ai([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:xt.meshmatcap_vert,fragmentShader:xt.meshmatcap_frag},points:{uniforms:ai([Pe.points,Pe.fog]),vertexShader:xt.points_vert,fragmentShader:xt.points_frag},dashed:{uniforms:ai([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xt.linedashed_vert,fragmentShader:xt.linedashed_frag},depth:{uniforms:ai([Pe.common,Pe.displacementmap]),vertexShader:xt.depth_vert,fragmentShader:xt.depth_frag},normal:{uniforms:ai([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:xt.meshnormal_vert,fragmentShader:xt.meshnormal_frag},sprite:{uniforms:ai([Pe.sprite,Pe.fog]),vertexShader:xt.sprite_vert,fragmentShader:xt.sprite_frag},background:{uniforms:{uvTransform:{value:new Br},t2D:{value:null}},vertexShader:xt.background_vert,fragmentShader:xt.background_frag},cube:{uniforms:ai([Pe.envmap,{opacity:{value:1}}]),vertexShader:xt.cube_vert,fragmentShader:xt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xt.equirect_vert,fragmentShader:xt.equirect_frag},distanceRGBA:{uniforms:ai([Pe.common,Pe.displacementmap,{referencePosition:{value:new D},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xt.distanceRGBA_vert,fragmentShader:xt.distanceRGBA_frag},shadow:{uniforms:ai([Pe.lights,Pe.fog,{color:{value:new we(0)},opacity:{value:1}}]),vertexShader:xt.shadow_vert,fragmentShader:xt.shadow_frag}};function Gq(i,e,t,n,r,s){const o=new we(0);let l,c,a=!0===r?0:1,u=null,h=0,d=null;function p(m,g){t.buffers.color.setClear(m.r,m.g,m.b,g,s)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),a=g,p(o,a)},getClearAlpha:function(){return a},setClearAlpha:function(m){a=m,p(o,a)},render:function f(m,g){let y=!1,_=!0===g.isScene?g.background:null;_&&_.isTexture&&(_=e.get(_));const v=i.xr,x=v.getSession&&v.getSession();x&&"additive"===x.environmentBlendMode&&(_=null),null===_?p(o,a):_&&_.isColor&&(p(_,1),y=!0),(i.autoClear||y)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),_&&(_.isCubeTexture||306===_.mapping)?(void 0===c&&(c=new kn(new Za(1,1,1),new Ii({name:"BackgroundCubeMaterial",uniforms:Nc(ds.cube.uniforms),vertexShader:ds.cube.vertexShader,fragmentShader:ds.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(b,S,E){this.matrixWorld.copyPosition(E.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),c.material.uniforms.envMap.value=_,c.material.uniforms.flipEnvMap.value=_.isCubeTexture&&!1===_.isRenderTargetTexture?-1:1,(u!==_||h!==_.version||d!==i.toneMapping)&&(c.material.needsUpdate=!0,u=_,h=_.version,d=i.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null)):_&&_.isTexture&&(void 0===l&&(l=new kn(new Jh(2,2),new Ii({name:"BackgroundMaterial",uniforms:Nc(ds.background.uniforms),vertexShader:ds.background.vertexShader,fragmentShader:ds.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(l)),l.material.uniforms.t2D.value=_,!0===_.matrixAutoUpdate&&_.updateMatrix(),l.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||h!==_.version||d!==i.toneMapping)&&(l.material.needsUpdate=!0,u=_,h=_.version,d=i.toneMapping),l.layers.enableAll(),m.unshift(l,l.geometry,l.material,0,0,null))}}}function Wq(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),o=n.isWebGL2||null!==s,a={},l=g(null);let c=l,u=!1;function f(N){return n.isWebGL2?i.bindVertexArray(N):s.bindVertexArrayOES(N)}function p(N){return n.isWebGL2?i.deleteVertexArray(N):s.deleteVertexArrayOES(N)}function g(N){const G=[],F=[],z=[];for(let V=0;V<r;V++)G[V]=0,F[V]=0,z[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:G,enabledAttributes:F,attributeDivisors:z,object:N,attributes:{},index:null}}function v(){const N=c.newAttributes;for(let G=0,F=N.length;G<F;G++)N[G]=0}function x(N){b(N,0)}function b(N,G){const z=c.enabledAttributes,V=c.attributeDivisors;c.newAttributes[N]=1,0===z[N]&&(i.enableVertexAttribArray(N),z[N]=1),V[N]!==G&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](N,G),V[N]=G)}function S(){const N=c.newAttributes,G=c.enabledAttributes;for(let F=0,z=G.length;F<z;F++)G[F]!==N[F]&&(i.disableVertexAttribArray(F),G[F]=0)}function E(N,G,F,z,V,U){!0!==n.isWebGL2||5124!==F&&5125!==F?i.vertexAttribPointer(N,G,F,z,V,U):i.vertexAttribIPointer(N,G,F,V,U)}function W(){$(),u=!0,c!==l&&(c=l,f(c.object))}function $(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function h(N,G,F,z,V){let U=!1;if(o){const j=function m(N,G,F){const z=!0===F.wireframe;let V=a[N.id];void 0===V&&(V={},a[N.id]=V);let U=V[G.id];void 0===U&&(U={},V[G.id]=U);let j=U[z];return void 0===j&&(j=g(function d(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),U[z]=j),j}(z,F,G);c!==j&&(c=j,f(c.object)),U=function y(N,G,F,z){const V=c.attributes,U=G.attributes;let j=0;const te=F.getAttributes();for(const Q in te)if(te[Q].location>=0){const ce=V[Q];let De=U[Q];if(void 0===De&&("instanceMatrix"===Q&&N.instanceMatrix&&(De=N.instanceMatrix),"instanceColor"===Q&&N.instanceColor&&(De=N.instanceColor)),void 0===ce||ce.attribute!==De||De&&ce.data!==De.data)return!0;j++}return c.attributesNum!==j||c.index!==z}(N,z,F,V),U&&function _(N,G,F,z){const V={},U=G.attributes;let j=0;const te=F.getAttributes();for(const Q in te)if(te[Q].location>=0){let ce=U[Q];void 0===ce&&("instanceMatrix"===Q&&N.instanceMatrix&&(ce=N.instanceMatrix),"instanceColor"===Q&&N.instanceColor&&(ce=N.instanceColor));const De={};De.attribute=ce,ce&&ce.data&&(De.data=ce.data),V[Q]=De,j++}c.attributes=V,c.attributesNum=j,c.index=z}(N,z,F,V)}else{const j=!0===G.wireframe;(c.geometry!==z.id||c.program!==F.id||c.wireframe!==j)&&(c.geometry=z.id,c.program=F.id,c.wireframe=j,U=!0)}null!==V&&t.update(V,34963),(U||u)&&(u=!1,function w(N,G,F,z){if(!1===n.isWebGL2&&(N.isInstancedMesh||z.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;v();const V=z.attributes,U=F.getAttributes(),j=G.defaultAttributeValues;for(const te in U){const Q=U[te];if(Q.location>=0){let he=V[te];if(void 0===he&&("instanceMatrix"===te&&N.instanceMatrix&&(he=N.instanceMatrix),"instanceColor"===te&&N.instanceColor&&(he=N.instanceColor)),void 0!==he){const ce=he.normalized,De=he.itemSize,K=t.get(he);if(void 0===K)continue;const He=K.buffer,Be=K.type,$e=K.bytesPerElement;if(he.isInterleavedBufferAttribute){const ye=he.data,Ke=ye.stride,se=he.offset;if(ye.isInstancedInterleavedBuffer){for(let oe=0;oe<Q.locationSize;oe++)b(Q.location+oe,ye.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===z._maxInstanceCount&&(z._maxInstanceCount=ye.meshPerAttribute*ye.count)}else for(let oe=0;oe<Q.locationSize;oe++)x(Q.location+oe);i.bindBuffer(34962,He);for(let oe=0;oe<Q.locationSize;oe++)E(Q.location+oe,De/Q.locationSize,Be,ce,Ke*$e,(se+De/Q.locationSize*oe)*$e)}else{if(he.isInstancedBufferAttribute){for(let ye=0;ye<Q.locationSize;ye++)b(Q.location+ye,he.meshPerAttribute);!0!==N.isInstancedMesh&&void 0===z._maxInstanceCount&&(z._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let ye=0;ye<Q.locationSize;ye++)x(Q.location+ye);i.bindBuffer(34962,He);for(let ye=0;ye<Q.locationSize;ye++)E(Q.location+ye,De/Q.locationSize,Be,ce,De*$e,De/Q.locationSize*ye*$e)}}else if(void 0!==j){const ce=j[te];if(void 0!==ce)switch(ce.length){case 2:i.vertexAttrib2fv(Q.location,ce);break;case 3:i.vertexAttrib3fv(Q.location,ce);break;case 4:i.vertexAttrib4fv(Q.location,ce);break;default:i.vertexAttrib1fv(Q.location,ce)}}}}S()}(N,G,F,z),null!==V&&i.bindBuffer(34963,t.get(V).buffer))},reset:W,resetDefaultState:$,dispose:function T(){W();for(const N in a){const G=a[N];for(const F in G){const z=G[F];for(const V in z)p(z[V].object),delete z[V];delete G[F]}delete a[N]}},releaseStatesOfGeometry:function I(N){if(void 0===a[N.id])return;const G=a[N.id];for(const F in G){const z=G[F];for(const V in z)p(z[V].object),delete z[V];delete G[F]}delete a[N.id]},releaseStatesOfProgram:function k(N){for(const G in a){const F=a[G];if(void 0===F[N.id])continue;const z=F[N.id];for(const V in z)p(z[V].object),delete z[V];delete F[N.id]}},initAttributes:v,enableAttribute:x,disableUnusedAttributes:S}}function jq(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function o(c){s=c},this.render=function a(c,u){i.drawArrays(s,c,u),t.update(u,s,1)},this.renderInstances=function l(c,u,h){if(0===h)return;let d,f;if(r)d=i,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",null===d)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](s,c,u,h),t.update(u,s,h)}}function qq(i,e,t){let n;function s(E){if("highp"===E){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";E="mediump"}return"mediump"===E&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o="undefined"!=typeof WebGL2RenderingContext&&i instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&i instanceof WebGL2ComputeRenderingContext;let a=void 0!==t.precision?t.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),u=!0===t.logarithmicDepthBuffer,h=i.getParameter(34930),d=i.getParameter(35660),f=i.getParameter(3379),p=i.getParameter(34076),m=i.getParameter(34921),g=i.getParameter(36347),y=i.getParameter(36348),_=i.getParameter(36349),v=d>0,x=o||e.has("OES_texture_float");return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const E=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:a,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:y,maxFragmentUniforms:_,vertexTextures:v,floatFragmentTextures:x,floatVertexTextures:v&&x,maxSamples:o?i.getParameter(36183):0}}function $q(i){const e=this;let t=null,n=0,r=!1,s=!1;const o=new Ya,a=new Br,l={value:null,needsUpdate:!1};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,d,f,p){const m=null!==h?h.length:0;let g=null;if(0!==m){if(g=l.value,!0!==p||null===g){const y=f+4*m,_=d.matrixWorldInverse;a.getNormalMatrix(_),(null===g||g.length<y)&&(g=new Float32Array(y));for(let v=0,x=f;v!==m;++v,x+=4)o.copy(h[v]).applyMatrix4(_,a),o.normal.toArray(g,x),g[x+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=m,e.numIntersection=0,g}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d,f){const p=0!==h.length||d||0!==n||r;return r=d,t=u(h,f,0),n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(h,d,f){const p=h.clippingPlanes,m=h.clipIntersection,g=h.clipShadows,y=i.get(h);if(!r||null===p||0===p.length||s&&!g)s?u(null):c();else{const _=s?0:n,v=4*_;let x=y.clippingState||null;l.value=x,x=u(p,d,v,f);for(let b=0;b!==v;++b)x[b]=t[b];y.clippingState=x,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=_}}}function Xq(i){let e=new WeakMap;function t(o,a){return 303===a?o.mapping=301:304===a&&(o.mapping=302),o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);void 0!==l&&(e.delete(a),l.dispose())}return{get:function n(o){if(o&&o.isTexture&&!1===o.isRenderTargetTexture){const a=o.mapping;if(303===a||304===a){if(e.has(o))return t(e.get(o).texture,o.mapping);{const l=o.image;if(l&&l.height>0){const c=new H9(l.height/2);return c.fromEquirectangularTexture(i,o),e.set(o,c),o.addEventListener("dispose",r),t(c.texture,o.mapping)}return null}}}return o},dispose:function s(){e=new WeakMap}}}ds.physical={uniforms:ai([ds.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new ne(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new we(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new ne},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new we(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new we(1,1,1)},specularColorMap:{value:null}}]),vertexShader:xt.meshphysical_vert,fragmentShader:xt.meshphysical_frag};class Uc extends uw{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const ZR=[.125,.215,.35,.446,.526,.582],fw=new Uc,YR=new we;let pw=null;const Qa=(1+Math.sqrt(5))/2,Hc=1/Qa,KR=[new D(1,1,1),new D(-1,1,1),new D(1,1,-1),new D(-1,1,-1),new D(0,Qa,Hc),new D(0,Qa,-Hc),new D(Hc,0,Qa),new D(-Hc,0,Qa),new D(Qa,Hc,0),new D(-Qa,Hc,0)];class QR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){pw=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=tP(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=eP(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(pw),e.scissorTest=!1,Um(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),pw=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Kt,minFilter:Kt,generateMipmaps:!1,type:Us,format:Ti,encoding:hs,depthBuffer:!1},r=JR(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=JR(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function Zq(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+ZR.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=ZR[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,y=1,_=new Float32Array(m*p*f),v=new Float32Array(g*p*f),x=new Float32Array(y*p*f);for(let S=0;S<f;S++){const E=S%3*2/3-1,w=S>2?0:-1;_.set([E,w,0,E+2/3,w,0,E+2/3,w+1,0,E,w,0,E+2/3,w+1,0,E,w+1,0],m*p*S),v.set(d,g*p*S),x.set([S,S,S,S,S,S],y*p*S)}const b=new lt;b.setAttribute("position",new Sn(_,m)),b.setAttribute("uv",new Sn(v,g)),b.setAttribute("faceIndex",new Sn(x,y)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function Yq(i,e,t){const n=new Float32Array(20),r=new D(0,1,0);return new Ii({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new kn(this._lodPlanes[0],e);this._renderer.compile(t,fw)}_sceneToCubeUV(e,t,n,r){const a=new Bn(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(YR),u.toneMapping=0,u.autoClear=!1;const f=new Di({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new kn(new Za,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(YR),m=!0);for(let y=0;y<6;y++){const _=y%3;0===_?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===_?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const v=this._cubeSize;Um(r,_*v,y>2?v:0,v,v),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=tP()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=eP());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new kn(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;Um(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,fw)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,KR[(r-1)%KR.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new kn(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const y=[];let _=0;for(let E=0;E<20;++E){const w=E/m,T=Math.exp(-w*w/2);y.push(T),0===E?_+=T:E<g&&(_+=2*T)}for(let E=0;E<y.length;E++)y[E]=y[E]/_;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=y,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:v}=this;d.dTheta.value=p,d.mipInt.value=v-n;const x=this._sizeLods[r];Um(t,3*x*(r>v-4?r-v+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(h,fw)}}function JR(i,e,t){const n=new Ai(i,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Um(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function eP(){return new Ii({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function tP(){return new Ii({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Kq(i){let e=new WeakMap,t=null;function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);void 0!==c&&(e.delete(l),c.dispose())}return{get:function n(a){if(a&&a.isTexture){const l=a.mapping,c=303===l||304===l,u=301===l||302===l;if(c||u){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;let h=e.get(a);return null===t&&(t=new QR(i)),h=c?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}if(e.has(a))return e.get(a).texture;{const h=a.image;if(c&&h&&h.height>0||u&&h&&function r(a){let l=0;for(let u=0;u<6;u++)void 0!==a[u]&&l++;return 6===l}(h)){null===t&&(t=new QR(i));const d=c?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}return null}}}return a},dispose:function o(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function Qq(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function Jq(i,e,t,n){const r={},s=new WeakMap;function o(h){const d=h.target;null!==d.index&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),!0===d.isInstancedBufferGeometry&&delete d._maxInstanceCount,t.memory.geometries--}function c(h){const d=[],f=h.index,p=h.attributes.position;let m=0;if(null!==f){const _=f.array;m=f.version;for(let v=0,x=_.length;v<x;v+=3){const b=_[v+0],S=_[v+1],E=_[v+2];d.push(b,S,S,E,E,b)}}else{m=p.version;for(let v=0,x=p.array.length/3-1;v<x;v+=3){const b=v+0,S=v+1,E=v+2;d.push(b,S,S,E,E,b)}}const g=new(RR(d)?qR:jR)(d,1);g.version=m;const y=s.get(h);y&&e.remove(y),s.set(h,g)}return{get:function a(h,d){return!0===r[d.id]||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d},update:function l(h){const d=h.attributes;for(const p in d)e.update(d[p],34962);const f=h.morphAttributes;for(const p in f){const m=f[p];for(let g=0,y=m.length;g<y;g++)e.update(m[g],34962)}},getWireframeAttribute:function u(h){const d=s.get(h);if(d){const f=h.index;null!==f&&d.version<f.version&&c(h)}else c(h);return s.get(h)}}}function e$(i,e,t,n){const r=n.isWebGL2;let s,a,l;this.setMode=function o(d){s=d},this.setIndex=function c(d){a=d.type,l=d.bytesPerElement},this.render=function u(d,f){i.drawElements(s,f,a,d*l),t.update(f,s,1)},this.renderInstances=function h(d,f,p){if(0===p)return;let m,g;if(r)m=i,g="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",null===m)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[g](s,f,a,d*l,p),t.update(f,s,p)}}function t$(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,o,a){switch(t.calls++,o){case 4:t.triangles+=a*(s/3);break;case 1:t.lines+=a*(s/2);break;case 3:t.lines+=a*(s-1);break;case 2:t.lines+=a*s;break;case 0:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o)}}}}function n$(i,e){return i[0]-e[0]}function i$(i,e){return Math.abs(e[1])-Math.abs(i[1])}function gw(i,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(t)}function r$(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,o=new Vt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];return{update:function l(c,u,h,d){const f=c.morphTargetInfluences;if(!0===e.isWebGL2){const p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=void 0!==p?p.length:0;let g=s.get(u);if(void 0===g||g.count!==m){let G=function(){$.dispose(),s.delete(u),u.removeEventListener("dispose",G)};void 0!==g&&g.texture.dispose();const v=void 0!==u.morphAttributes.position,x=void 0!==u.morphAttributes.normal,b=void 0!==u.morphAttributes.color,S=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],w=u.morphAttributes.color||[];let T=0;!0===v&&(T=1),!0===x&&(T=2),!0===b&&(T=3);let I=u.attributes.position.count*T,k=1;I>e.maxTextureSize&&(k=Math.ceil(I/e.maxTextureSize),I=e.maxTextureSize);const W=new Float32Array(I*k*4*m),$=new Wx(W,I,k,m);$.type=kr,$.needsUpdate=!0;const N=4*T;for(let F=0;F<m;F++){const z=S[F],V=E[F],U=w[F],j=I*k*4*F;for(let te=0;te<z.count;te++){const Q=te*N;!0===v&&(o.fromBufferAttribute(z,te),!0===z.normalized&&gw(o,z),W[j+Q+0]=o.x,W[j+Q+1]=o.y,W[j+Q+2]=o.z,W[j+Q+3]=0),!0===x&&(o.fromBufferAttribute(V,te),!0===V.normalized&&gw(o,V),W[j+Q+4]=o.x,W[j+Q+5]=o.y,W[j+Q+6]=o.z,W[j+Q+7]=0),!0===b&&(o.fromBufferAttribute(U,te),!0===U.normalized&&gw(o,U),W[j+Q+8]=o.x,W[j+Q+9]=o.y,W[j+Q+10]=o.z,W[j+Q+11]=4===U.itemSize?o.w:1)}}g={count:m,texture:$,size:new ne(I,k)},s.set(u,g),u.addEventListener("dispose",G)}let y=0;for(let v=0;v<f.length;v++)y+=f[v];const _=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(i,"morphTargetBaseInfluence",_),d.getUniforms().setValue(i,"morphTargetInfluences",f),d.getUniforms().setValue(i,"morphTargetsTexture",g.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",g.size)}else{const p=void 0===f?0:f.length;let m=n[u.id];if(void 0===m||m.length!==p){m=[];for(let x=0;x<p;x++)m[x]=[x,0];n[u.id]=m}for(let x=0;x<p;x++){const b=m[x];b[0]=x,b[1]=f[x]}m.sort(i$);for(let x=0;x<8;x++)x<p&&m[x][1]?(a[x][0]=m[x][0],a[x][1]=m[x][1]):(a[x][0]=Number.MAX_SAFE_INTEGER,a[x][1]=0);a.sort(n$);const g=u.morphAttributes.position,y=u.morphAttributes.normal;let _=0;for(let x=0;x<8;x++){const b=a[x],S=b[0],E=b[1];S!==Number.MAX_SAFE_INTEGER&&E?(g&&u.getAttribute("morphTarget"+x)!==g[S]&&u.setAttribute("morphTarget"+x,g[S]),y&&u.getAttribute("morphNormal"+x)!==y[S]&&u.setAttribute("morphNormal"+x,y[S]),r[x]=E,_+=E):(g&&!0===u.hasAttribute("morphTarget"+x)&&u.deleteAttribute("morphTarget"+x),y&&!0===u.hasAttribute("morphNormal"+x)&&u.deleteAttribute("morphNormal"+x),r[x]=0)}const v=u.morphTargetsRelative?1:1-_;d.getUniforms().setValue(i,"morphTargetBaseInfluence",v),d.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function s$(i,e,t,n){let r=new WeakMap;function a(l){const c=l.target;c.removeEventListener("dispose",a),t.remove(c.instanceMatrix),null!==c.instanceColor&&t.remove(c.instanceColor)}return{update:function s(l){const c=n.render.frame,h=e.get(l,l.geometry);return r.get(h)!==c&&(e.update(h),r.set(h,c)),l.isInstancedMesh&&(!1===l.hasEventListener("dispose",a)&&l.addEventListener("dispose",a),t.update(l.instanceMatrix,34962),null!==l.instanceColor&&t.update(l.instanceColor,34962)),h},dispose:function o(){r=new WeakMap}}}const nP=new hr,iP=new Wx,rP=new class FR extends hr{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=pn,this.minFilter=pn,this.wrapR=gi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},sP=new Bm,oP=[],aP=[],lP=new Float32Array(16),cP=new Float32Array(9),uP=new Float32Array(4);function Gc(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=oP[r];if(void 0===s&&(s=new Float32Array(r),oP[r]=s),0!==e){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function yi(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function _i(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Vm(i,e){let t=aP[e];void 0===t&&(t=new Int32Array(e),aP[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function o$(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function a$(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(yi(t,e))return;i.uniform2fv(this.addr,e),_i(t,e)}}function l$(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(yi(t,e))return;i.uniform3fv(this.addr,e),_i(t,e)}}function c$(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(yi(t,e))return;i.uniform4fv(this.addr,e),_i(t,e)}}function u$(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yi(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),_i(t,e)}else{if(yi(t,n))return;uP.set(n),i.uniformMatrix2fv(this.addr,!1,uP),_i(t,n)}}function h$(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yi(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),_i(t,e)}else{if(yi(t,n))return;cP.set(n),i.uniformMatrix3fv(this.addr,!1,cP),_i(t,n)}}function d$(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(yi(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),_i(t,e)}else{if(yi(t,n))return;lP.set(n),i.uniformMatrix4fv(this.addr,!1,lP),_i(t,n)}}function f$(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function p$(i,e){const t=this.cache;yi(t,e)||(i.uniform2iv(this.addr,e),_i(t,e))}function m$(i,e){const t=this.cache;yi(t,e)||(i.uniform3iv(this.addr,e),_i(t,e))}function g$(i,e){const t=this.cache;yi(t,e)||(i.uniform4iv(this.addr,e),_i(t,e))}function y$(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function _$(i,e){const t=this.cache;yi(t,e)||(i.uniform2uiv(this.addr,e),_i(t,e))}function v$(i,e){const t=this.cache;yi(t,e)||(i.uniform3uiv(this.addr,e),_i(t,e))}function x$(i,e){const t=this.cache;yi(t,e)||(i.uniform4uiv(this.addr,e),_i(t,e))}function w$(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||nP,r)}function b$(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||rP,r)}function M$(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||sP,r)}function S$(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||iP,r)}function C$(i,e){i.uniform1fv(this.addr,e)}function T$(i,e){const t=Gc(e,this.size,2);i.uniform2fv(this.addr,t)}function A$(i,e){const t=Gc(e,this.size,3);i.uniform3fv(this.addr,t)}function D$(i,e){const t=Gc(e,this.size,4);i.uniform4fv(this.addr,t)}function I$(i,e){const t=Gc(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function R$(i,e){const t=Gc(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function P$(i,e){const t=Gc(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function L$(i,e){i.uniform1iv(this.addr,e)}function F$(i,e){i.uniform2iv(this.addr,e)}function O$(i,e){i.uniform3iv(this.addr,e)}function N$(i,e){i.uniform4iv(this.addr,e)}function k$(i,e){i.uniform1uiv(this.addr,e)}function B$(i,e){i.uniform2uiv(this.addr,e)}function z$(i,e){i.uniform3uiv(this.addr,e)}function U$(i,e){i.uniform4uiv(this.addr,e)}function V$(i,e,t){const n=e.length,r=Vm(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2D(e[s]||nP,r[s])}function H$(i,e,t){const n=e.length,r=Vm(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||rP,r[s])}function G$(i,e,t){const n=e.length,r=Vm(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTextureCube(e[s]||sP,r[s])}function W$(i,e,t){const n=e.length,r=Vm(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||iP,r[s])}class q${constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function E$(i){switch(i){case 5126:return o$;case 35664:return a$;case 35665:return l$;case 35666:return c$;case 35674:return u$;case 35675:return h$;case 35676:return d$;case 5124:case 35670:return f$;case 35667:case 35671:return p$;case 35668:case 35672:return m$;case 35669:case 35673:return g$;case 5125:return y$;case 36294:return _$;case 36295:return v$;case 36296:return x$;case 35678:case 36198:case 36298:case 36306:case 35682:return w$;case 35679:case 36299:case 36307:return b$;case 35680:case 36300:case 36308:case 36293:return M$;case 36289:case 36303:case 36311:case 36292:return S$}}(t.type)}}class $${constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function j$(i){switch(i){case 5126:return C$;case 35664:return T$;case 35665:return A$;case 35666:return D$;case 35674:return I$;case 35675:return R$;case 35676:return P$;case 5124:case 35670:return L$;case 35667:case 35671:return F$;case 35668:case 35672:return O$;case 35669:case 35673:return N$;case 5125:return k$;case 36294:return B$;case 36295:return z$;case 36296:return U$;case 35678:case 36198:case 36298:case 36306:case 35682:return V$;case 35679:case 36299:case 36307:return H$;case 35680:case 36300:case 36308:case 36293:return G$;case 36289:case 36303:case 36311:case 36292:return W$}}(t.type)}}class X${constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],n)}}}const yw=/(\w+)(\])?(\[|\.)?/g;function hP(i,e){i.seq.push(e),i.map[e.id]=e}function Z$(i,e,t){const n=i.name,r=n.length;for(yw.lastIndex=0;;){const s=yw.exec(n),o=yw.lastIndex;let a=s[1];const c=s[3];if("]"===s[2]&&(a|=0),void 0===c||"["===c&&o+2===r){hP(t,void 0===c?new q$(a,i,e):new $$(a,i,e));break}{let h=t.map[a];void 0===h&&(h=new X$(a),hP(t,h)),t=h}}}class Hm{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);Z$(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=n[a.id];!1!==l.needsUpdate&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&n.push(o)}return n}}function dP(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let Y$=0;function fP(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function K$(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join("\n")}(i.getShaderSource(e),o)}return r}function J$(i,e){const t=function Q$(i){switch(i){case hs:return["Linear","( value )"];case Pt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function eX(i,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function ed(i){return""!==i}function pP(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function mP(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const rX=/^[ \t]*#include +<([\w\d./]+)>/gm;function _w(i){return i.replace(rX,sX)}function sX(i,e){const t=xt[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return _w(t)}const oX=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,aX=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function gP(i){return i.replace(aX,yP).replace(oX,lX)}function lX(i,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),yP(0,e,t,n)}function yP(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function _P(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function pX(i,e,t,n){const r=i.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=function cX(i){let e="SHADOWMAP_TYPE_BASIC";return 1===i.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===i.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===i.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),c=function uX(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),u=function hX(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&302===i.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),h=function dX(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),d=function fX(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),f=t.isWebGL2?"":function tX(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ed).join("\n")}(t),p=function nX(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),m=r.createProgram();let g,y,_=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(g=[p].filter(ed).join("\n"),g.length>0&&(g+="\n"),y=[f,p].filter(ed).join("\n"),y.length>0&&(y+="\n")):(g=[_P(t),"#define SHADER_NAME "+t.shaderName,p,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ed).join("\n"),y=[f,_P(t),"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?xt.tonemapping_pars_fragment:"",0!==t.toneMapping?eX("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",xt.encodings_pars_fragment,J$("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(ed).join("\n")),o=_w(o),o=pP(o,t),o=mP(o,t),a=_w(a),a=pP(a,t),a=mP(a,t),o=gP(o),a=gP(a),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(_="#version 300 es\n",g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const x=_+y+a,b=dP(r,35633,_+g+o),S=dP(r,35632,x);if(r.attachShader(m,b),r.attachShader(m,S),void 0!==t.index0AttributeName?r.bindAttribLocation(m,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),i.debug.checkShaderErrors){const T=r.getProgramInfoLog(m).trim(),I=r.getShaderInfoLog(b).trim(),k=r.getShaderInfoLog(S).trim();let W=!0,$=!0;if(!1===r.getProgramParameter(m,35714)){W=!1;const N=fP(r,b,"vertex"),G=fP(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(m,35715)+"\n\nProgram Info Log: "+T+"\n"+N+"\n"+G)}else""!==T?console.warn("THREE.WebGLProgram: Program Info Log:",T):(""===I||""===k)&&($=!1);$&&(this.diagnostics={runnable:W,programLog:T,vertexShader:{log:I,prefix:g},fragmentShader:{log:k,prefix:y}})}let E,w;return r.deleteShader(b),r.deleteShader(S),this.getUniforms=function(){return void 0===E&&(E=new Hm(r,m)),E},this.getAttributes=function(){return void 0===w&&(w=function iX(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),o=s.name;let a=1;35674===s.type&&(a=2),35675===s.type&&(a=3),35676===s.type&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}(r,m)),w},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=t.shaderName,this.id=Y$++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=b,this.fragmentShader=S,this}let mX=0;class gX{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return!1===o.has(r)&&(o.add(r),r.usedTimes++),!1===o.has(s)&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new yX(e);t.set(e,n)}return t.get(e)}}class yX{constructor(e){this.id=mX++,this.code=e,this.usedTimes=0}}function _X(i,e,t,n,r,s,o){const a=new Qx,l=new gX,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function m(w,T,I,k,W){const $=k.fog,N=W.geometry,F=(w.isMeshStandardMaterial?t:e).get(w.envMap||(w.isMeshStandardMaterial?k.environment:null)),z=F&&306===F.mapping?F.image.height:null,V=p[w.type];null!==w.precision&&(f=r.getMaxPrecision(w.precision),f!==w.precision&&console.warn("THREE.WebGLProgram.getParameters:",w.precision,"not supported, using",f,"instead."));const U=N.morphAttributes.position||N.morphAttributes.normal||N.morphAttributes.color,j=void 0!==U?U.length:0;let Q,he,ce,De,te=0;if(void 0!==N.morphAttributes.position&&(te=1),void 0!==N.morphAttributes.normal&&(te=2),void 0!==N.morphAttributes.color&&(te=3),V){const Ke=ds[V];Q=Ke.vertexShader,he=Ke.fragmentShader}else Q=w.vertexShader,he=w.fragmentShader,l.update(w),ce=l.getVertexShaderID(w),De=l.getFragmentShaderID(w);const K=i.getRenderTarget(),Be=w.clearcoat>0,$e=w.iridescence>0;return{isWebGL2:u,shaderID:V,shaderName:w.type,vertexShader:Q,fragmentShader:he,defines:w.defines,customVertexShaderID:ce,customFragmentShaderID:De,isRawShaderMaterial:!0===w.isRawShaderMaterial,glslVersion:w.glslVersion,precision:f,instancing:!0===W.isInstancedMesh,instancingColor:!0===W.isInstancedMesh&&null!==W.instanceColor,supportsVertexTextures:d,outputEncoding:null===K?i.outputEncoding:!0===K.isXRRenderTarget?K.texture.encoding:hs,map:!!w.map,matcap:!!w.matcap,envMap:!!F,envMapMode:F&&F.mapping,envMapCubeUVHeight:z,lightMap:!!w.lightMap,aoMap:!!w.aoMap,emissiveMap:!!w.emissiveMap,bumpMap:!!w.bumpMap,normalMap:!!w.normalMap,objectSpaceNormalMap:1===w.normalMapType,tangentSpaceNormalMap:0===w.normalMapType,decodeVideoTexture:!!w.map&&!0===w.map.isVideoTexture&&w.map.encoding===Pt,clearcoat:Be,clearcoatMap:Be&&!!w.clearcoatMap,clearcoatRoughnessMap:Be&&!!w.clearcoatRoughnessMap,clearcoatNormalMap:Be&&!!w.clearcoatNormalMap,iridescence:$e,iridescenceMap:$e&&!!w.iridescenceMap,iridescenceThicknessMap:$e&&!!w.iridescenceThicknessMap,displacementMap:!!w.displacementMap,roughnessMap:!!w.roughnessMap,metalnessMap:!!w.metalnessMap,specularMap:!!w.specularMap,specularIntensityMap:!!w.specularIntensityMap,specularColorMap:!!w.specularColorMap,opaque:!1===w.transparent&&1===w.blending,alphaMap:!!w.alphaMap,alphaTest:w.alphaTest>0,gradientMap:!!w.gradientMap,sheen:w.sheen>0,sheenColorMap:!!w.sheenColorMap,sheenRoughnessMap:!!w.sheenRoughnessMap,transmission:w.transmission>0,transmissionMap:!!w.transmissionMap,thicknessMap:!!w.thicknessMap,combine:w.combine,vertexTangents:!!w.normalMap&&!!N.attributes.tangent,vertexColors:w.vertexColors,vertexAlphas:!0===w.vertexColors&&!!N.attributes.color&&4===N.attributes.color.itemSize,vertexUvs:!!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatMap||w.clearcoatRoughnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.displacementMap||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheenColorMap||w.sheenRoughnessMap),uvsVertexOnly:!(w.map||w.bumpMap||w.normalMap||w.specularMap||w.alphaMap||w.emissiveMap||w.roughnessMap||w.metalnessMap||w.clearcoatNormalMap||w.iridescenceMap||w.iridescenceThicknessMap||w.transmission>0||w.transmissionMap||w.thicknessMap||w.specularIntensityMap||w.specularColorMap||w.sheen>0||w.sheenColorMap||w.sheenRoughnessMap||!w.displacementMap),fog:!!$,useFog:!0===w.fog,fogExp2:$&&$.isFogExp2,flatShading:!!w.flatShading,sizeAttenuation:w.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===W.isSkinnedMesh,morphTargets:void 0!==N.morphAttributes.position,morphNormals:void 0!==N.morphAttributes.normal,morphColors:void 0!==N.morphAttributes.color,morphTargetsCount:j,morphTextureStride:te,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:w.dithering,shadowMapEnabled:i.shadowMap.enabled&&I.length>0,shadowMapType:i.shadowMap.type,toneMapping:w.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:w.premultipliedAlpha,doubleSided:2===w.side,flipSided:1===w.side,useDepthPacking:!!w.depthPacking,depthPacking:w.depthPacking||0,index0AttributeName:w.index0AttributeName,extensionDerivatives:w.extensions&&w.extensions.derivatives,extensionFragDepth:w.extensions&&w.extensions.fragDepth,extensionDrawBuffers:w.extensions&&w.extensions.drawBuffers,extensionShaderTextureLOD:w.extensions&&w.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:w.customProgramCacheKey()}},getProgramCacheKey:function g(w){const T=[];if(w.shaderID?T.push(w.shaderID):(T.push(w.customVertexShaderID),T.push(w.customFragmentShaderID)),void 0!==w.defines)for(const I in w.defines)T.push(I),T.push(w.defines[I]);return!1===w.isRawShaderMaterial&&(function y(w,T){w.push(T.precision),w.push(T.outputEncoding),w.push(T.envMapMode),w.push(T.envMapCubeUVHeight),w.push(T.combine),w.push(T.vertexUvs),w.push(T.fogExp2),w.push(T.sizeAttenuation),w.push(T.morphTargetsCount),w.push(T.morphAttributeCount),w.push(T.numDirLights),w.push(T.numPointLights),w.push(T.numSpotLights),w.push(T.numHemiLights),w.push(T.numRectAreaLights),w.push(T.numDirLightShadows),w.push(T.numPointLightShadows),w.push(T.numSpotLightShadows),w.push(T.shadowMapType),w.push(T.toneMapping),w.push(T.numClippingPlanes),w.push(T.numClipIntersection),w.push(T.depthPacking)}(T,w),function _(w,T){a.disableAll(),T.isWebGL2&&a.enable(0),T.supportsVertexTextures&&a.enable(1),T.instancing&&a.enable(2),T.instancingColor&&a.enable(3),T.map&&a.enable(4),T.matcap&&a.enable(5),T.envMap&&a.enable(6),T.lightMap&&a.enable(7),T.aoMap&&a.enable(8),T.emissiveMap&&a.enable(9),T.bumpMap&&a.enable(10),T.normalMap&&a.enable(11),T.objectSpaceNormalMap&&a.enable(12),T.tangentSpaceNormalMap&&a.enable(13),T.clearcoat&&a.enable(14),T.clearcoatMap&&a.enable(15),T.clearcoatRoughnessMap&&a.enable(16),T.clearcoatNormalMap&&a.enable(17),T.iridescence&&a.enable(18),T.iridescenceMap&&a.enable(19),T.iridescenceThicknessMap&&a.enable(20),T.displacementMap&&a.enable(21),T.specularMap&&a.enable(22),T.roughnessMap&&a.enable(23),T.metalnessMap&&a.enable(24),T.gradientMap&&a.enable(25),T.alphaMap&&a.enable(26),T.alphaTest&&a.enable(27),T.vertexColors&&a.enable(28),T.vertexAlphas&&a.enable(29),T.vertexUvs&&a.enable(30),T.vertexTangents&&a.enable(31),T.uvsVertexOnly&&a.enable(32),T.fog&&a.enable(33),w.push(a.mask),a.disableAll(),T.useFog&&a.enable(0),T.flatShading&&a.enable(1),T.logarithmicDepthBuffer&&a.enable(2),T.skinning&&a.enable(3),T.morphTargets&&a.enable(4),T.morphNormals&&a.enable(5),T.morphColors&&a.enable(6),T.premultipliedAlpha&&a.enable(7),T.shadowMapEnabled&&a.enable(8),T.physicallyCorrectLights&&a.enable(9),T.doubleSided&&a.enable(10),T.flipSided&&a.enable(11),T.useDepthPacking&&a.enable(12),T.dithering&&a.enable(13),T.specularIntensityMap&&a.enable(14),T.specularColorMap&&a.enable(15),T.transmission&&a.enable(16),T.transmissionMap&&a.enable(17),T.thicknessMap&&a.enable(18),T.sheen&&a.enable(19),T.sheenColorMap&&a.enable(20),T.sheenRoughnessMap&&a.enable(21),T.decodeVideoTexture&&a.enable(22),T.opaque&&a.enable(23),w.push(a.mask)}(T,w),T.push(i.outputEncoding)),T.push(w.customProgramCacheKey),T.join()},getUniforms:function v(w){const T=p[w.type];let I;return I=T?cw.clone(ds[T].uniforms):w.uniforms,I},acquireProgram:function x(w,T){let I;for(let k=0,W=c.length;k<W;k++){const $=c[k];if($.cacheKey===T){I=$,++I.usedTimes;break}}return void 0===I&&(I=new pX(i,T,w,s),c.push(I)),I},releaseProgram:function b(w){if(0==--w.usedTimes){const T=c.indexOf(w);c[T]=c[c.length-1],c.pop(),w.destroy()}},releaseShaderCache:function S(w){l.remove(w)},programs:c,dispose:function E(){l.dispose()}}}function vX(){let i=new WeakMap;return{get:function e(s){let o=i.get(s);return void 0===o&&(o={},i.set(s,o)),o},remove:function t(s){i.delete(s)},update:function n(s,o,a){i.get(s)[o]=a},dispose:function r(){i=new WeakMap}}}function xX(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function vP(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function xP(){const i=[];let e=0;const t=[],n=[],r=[];function o(h,d,f,p,m,g){let y=i[e];return void 0===y?(y={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:m,group:g},i[e]=y):(y.id=h.id,y.object=h,y.geometry=d,y.material=f,y.groupOrder=p,y.renderOrder=h.renderOrder,y.z=m,y.group=g),e++,y}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function a(h,d,f,p,m,g){const y=o(h,d,f,p,m,g);f.transmission>0?n.push(y):!0===f.transparent?r.push(y):t.push(y)},unshift:function l(h,d,f,p,m,g){const y=o(h,d,f,p,m,g);f.transmission>0?n.unshift(y):!0===f.transparent?r.unshift(y):t.unshift(y)},finish:function u(){for(let h=e,d=i.length;h<d;h++){const f=i[h];if(null===f.id)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}},sort:function c(h,d){t.length>1&&t.sort(h||xX),n.length>1&&n.sort(d||vP),r.length>1&&r.sort(d||vP)}}}function wX(){let i=new WeakMap;return{get:function e(n,r){let s;return!1===i.has(n)?(s=new xP,i.set(n,[s])):r>=i.get(n).length?(s=new xP,i.get(n).push(s)):s=i.get(n)[r],s},dispose:function t(){i=new WeakMap}}}function bX(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new D,color:new we};break;case"SpotLight":t={position:new D,direction:new D,color:new we,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new D,color:new we,distance:0,decay:0};break;case"HemisphereLight":t={direction:new D,skyColor:new we,groundColor:new we};break;case"RectAreaLight":t={color:new we,position:new D,halfWidth:new D,halfHeight:new D}}return i[e.id]=t,t}}}let SX=0;function EX(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function CX(i,e){const t=new bX,n=function MX(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ne};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new ne,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)r.probe.push(new D);const s=new D,o=new ft,a=new ft;return{setup:function l(u,h){let d=0,f=0,p=0;for(let T=0;T<9;T++)r.probe[T].set(0,0,0);let m=0,g=0,y=0,_=0,v=0,x=0,b=0,S=0;u.sort(EX);const E=!0!==h?Math.PI:1;for(let T=0,I=u.length;T<I;T++){const k=u[T],W=k.color,$=k.intensity,N=k.distance,G=k.shadow&&k.shadow.map?k.shadow.map.texture:null;if(k.isAmbientLight)d+=W.r*$*E,f+=W.g*$*E,p+=W.b*$*E;else if(k.isLightProbe)for(let F=0;F<9;F++)r.probe[F].addScaledVector(k.sh.coefficients[F],$);else if(k.isDirectionalLight){const F=t.get(k);if(F.color.copy(k.color).multiplyScalar(k.intensity*E),k.castShadow){const z=k.shadow,V=n.get(k);V.shadowBias=z.bias,V.shadowNormalBias=z.normalBias,V.shadowRadius=z.radius,V.shadowMapSize=z.mapSize,r.directionalShadow[m]=V,r.directionalShadowMap[m]=G,r.directionalShadowMatrix[m]=k.shadow.matrix,x++}r.directional[m]=F,m++}else if(k.isSpotLight){const F=t.get(k);if(F.position.setFromMatrixPosition(k.matrixWorld),F.color.copy(W).multiplyScalar($*E),F.distance=N,F.coneCos=Math.cos(k.angle),F.penumbraCos=Math.cos(k.angle*(1-k.penumbra)),F.decay=k.decay,k.castShadow){const z=k.shadow,V=n.get(k);V.shadowBias=z.bias,V.shadowNormalBias=z.normalBias,V.shadowRadius=z.radius,V.shadowMapSize=z.mapSize,r.spotShadow[y]=V,r.spotShadowMap[y]=G,r.spotShadowMatrix[y]=k.shadow.matrix,S++}r.spot[y]=F,y++}else if(k.isRectAreaLight){const F=t.get(k);F.color.copy(W).multiplyScalar($),F.halfWidth.set(.5*k.width,0,0),F.halfHeight.set(0,.5*k.height,0),r.rectArea[_]=F,_++}else if(k.isPointLight){const F=t.get(k);if(F.color.copy(k.color).multiplyScalar(k.intensity*E),F.distance=k.distance,F.decay=k.decay,k.castShadow){const z=k.shadow,V=n.get(k);V.shadowBias=z.bias,V.shadowNormalBias=z.normalBias,V.shadowRadius=z.radius,V.shadowMapSize=z.mapSize,V.shadowCameraNear=z.camera.near,V.shadowCameraFar=z.camera.far,r.pointShadow[g]=V,r.pointShadowMap[g]=G,r.pointShadowMatrix[g]=k.shadow.matrix,b++}r.point[g]=F,g++}else if(k.isHemisphereLight){const F=t.get(k);F.skyColor.copy(k.color).multiplyScalar($*E),F.groundColor.copy(k.groundColor).multiplyScalar($*E),r.hemi[v]=F,v++}}_>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=Pe.LTC_FLOAT_1,r.rectAreaLTC2=Pe.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Pe.LTC_HALF_1,r.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const w=r.hash;(w.directionalLength!==m||w.pointLength!==g||w.spotLength!==y||w.rectAreaLength!==_||w.hemiLength!==v||w.numDirectionalShadows!==x||w.numPointShadows!==b||w.numSpotShadows!==S)&&(r.directional.length=m,r.spot.length=y,r.rectArea.length=_,r.point.length=g,r.hemi.length=v,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=b,r.spotShadowMatrix.length=S,w.directionalLength=m,w.pointLength=g,w.spotLength=y,w.rectAreaLength=_,w.hemiLength=v,w.numDirectionalShadows=x,w.numPointShadows=b,w.numSpotShadows=S,r.version=SX++)},setupView:function c(u,h){let d=0,f=0,p=0,m=0,g=0;const y=h.matrixWorldInverse;for(let _=0,v=u.length;_<v;_++){const x=u[_];if(x.isDirectionalLight){const b=r.directional[d];b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(y),d++}else if(x.isSpotLight){const b=r.spot[p];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),b.direction.setFromMatrixPosition(x.matrixWorld),s.setFromMatrixPosition(x.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(y),p++}else if(x.isRectAreaLight){const b=r.rectArea[m];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),a.identity(),o.copy(x.matrixWorld),o.premultiply(y),a.extractRotation(o),b.halfWidth.set(.5*x.width,0,0),b.halfHeight.set(0,.5*x.height,0),b.halfWidth.applyMatrix4(a),b.halfHeight.applyMatrix4(a),m++}else if(x.isPointLight){const b=r.point[f];b.position.setFromMatrixPosition(x.matrixWorld),b.position.applyMatrix4(y),f++}else if(x.isHemisphereLight){const b=r.hemi[g];b.direction.setFromMatrixPosition(x.matrixWorld),b.direction.transformDirection(y),g++}}},state:r}}function wP(i,e){const t=new CX(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function l(h){t.setup(n,h)},setupLightsView:function c(h){t.setupView(n,h)},pushLight:function o(h){n.push(h)},pushShadow:function a(h){r.push(h)}}}function TX(i,e){let t=new WeakMap;return{get:function n(s,o=0){let a;return!1===t.has(s)?(a=new wP(i,e),t.set(s,[a])):o>=t.get(s).length?(a=new wP(i,e),t.get(s).push(a)):a=t.get(s)[o],a},dispose:function r(){t=new WeakMap}}}class bP extends un{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class MP extends un{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new D,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function IX(i,e,t){let n=new dw;const r=new ne,s=new ne,o=new Vt,a=new bP({depthPacking:3201}),l=new MP,c={},u=t.maxTextureSize,h={0:1,1:0,2:2},d=new Ii({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new ne},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new lt;p.setAttribute("position",new Sn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new kn(p,d),g=this;function y(x,b){const S=e.update(m);d.defines.VSM_SAMPLES!==x.blurSamples&&(d.defines.VSM_SAMPLES=x.blurSamples,f.defines.VSM_SAMPLES=x.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),d.uniforms.shadow_pass.value=x.map.texture,d.uniforms.resolution.value=x.mapSize,d.uniforms.radius.value=x.radius,i.setRenderTarget(x.mapPass),i.clear(),i.renderBufferDirect(b,null,S,d,m,null),f.uniforms.shadow_pass.value=x.mapPass.texture,f.uniforms.resolution.value=x.mapSize,f.uniforms.radius.value=x.radius,i.setRenderTarget(x.map),i.clear(),i.renderBufferDirect(b,null,S,f,m,null)}function _(x,b,S,E,w,T){let I=null;const k=!0===S.isPointLight?x.customDistanceMaterial:x.customDepthMaterial;if(I=void 0!==k?k:!0===S.isPointLight?l:a,i.localClippingEnabled&&!0===b.clipShadows&&0!==b.clippingPlanes.length||b.displacementMap&&0!==b.displacementScale||b.alphaMap&&b.alphaTest>0){const W=I.uuid,$=b.uuid;let N=c[W];void 0===N&&(N={},c[W]=N);let G=N[$];void 0===G&&(G=I.clone(),N[$]=G),I=G}return I.visible=b.visible,I.wireframe=b.wireframe,I.side=3===T?null!==b.shadowSide?b.shadowSide:b.side:null!==b.shadowSide?b.shadowSide:h[b.side],I.alphaMap=b.alphaMap,I.alphaTest=b.alphaTest,I.clipShadows=b.clipShadows,I.clippingPlanes=b.clippingPlanes,I.clipIntersection=b.clipIntersection,I.displacementMap=b.displacementMap,I.displacementScale=b.displacementScale,I.displacementBias=b.displacementBias,I.wireframeLinewidth=b.wireframeLinewidth,I.linewidth=b.linewidth,!0===S.isPointLight&&!0===I.isMeshDistanceMaterial&&(I.referencePosition.setFromMatrixPosition(S.matrixWorld),I.nearDistance=E,I.farDistance=w),I}function v(x,b,S,E,w){if(!1===x.visible)return;if(x.layers.test(b.layers)&&(x.isMesh||x.isLine||x.isPoints)&&(x.castShadow||x.receiveShadow&&3===w)&&(!x.frustumCulled||n.intersectsObject(x))){x.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,x.matrixWorld);const k=e.update(x),W=x.material;if(Array.isArray(W)){const $=k.groups;for(let N=0,G=$.length;N<G;N++){const F=$[N],z=W[F.materialIndex];if(z&&z.visible){const V=_(x,z,E,S.near,S.far,w);i.renderBufferDirect(S,null,k,V,x,F)}}}else if(W.visible){const $=_(x,W,E,S.near,S.far,w);i.renderBufferDirect(S,null,k,$,x,null)}}const I=x.children;for(let k=0,W=I.length;k<W;k++)v(I[k],b,S,E,w)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(x,b,S){if(!1===g.enabled||!1===g.autoUpdate&&!1===g.needsUpdate||0===x.length)return;const E=i.getRenderTarget(),w=i.getActiveCubeFace(),T=i.getActiveMipmapLevel(),I=i.state;I.setBlending(0),I.buffers.color.setClear(1,1,1,1),I.buffers.depth.setTest(!0),I.setScissorTest(!1);for(let k=0,W=x.length;k<W;k++){const $=x[k],N=$.shadow;if(void 0===N){console.warn("THREE.WebGLShadowMap:",$,"has no shadow.");continue}if(!1===N.autoUpdate&&!1===N.needsUpdate)continue;r.copy(N.mapSize);const G=N.getFrameExtents();r.multiply(G),s.copy(N.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/G.x),r.x=s.x*G.x,N.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/G.y),r.y=s.y*G.y,N.mapSize.y=s.y)),null===N.map&&!N.isPointLightShadow&&3===this.type&&(N.map=new Ai(r.x,r.y),N.map.texture.name=$.name+".shadowMap",N.mapPass=new Ai(r.x,r.y),N.camera.updateProjectionMatrix()),null===N.map&&(N.map=new Ai(r.x,r.y,{minFilter:pn,magFilter:pn,format:Ti}),N.map.texture.name=$.name+".shadowMap",N.camera.updateProjectionMatrix()),i.setRenderTarget(N.map),i.clear();const F=N.getViewportCount();for(let z=0;z<F;z++){const V=N.getViewport(z);o.set(s.x*V.x,s.y*V.y,s.x*V.z,s.y*V.w),I.viewport(o),N.updateMatrices($,z),n=N.getFrustum(),v(b,S,N.camera,$,this.type)}!N.isPointLightShadow&&3===this.type&&y(N,S),N.needsUpdate=!1}g.needsUpdate=!1,i.setRenderTarget(E,w,T)}}function RX(i,e,t){const n=t.isWebGL2,a=new function r(){let B=!1;const pe=new Vt;let Me=null;const Xe=new Vt(0,0,0,0);return{setMask:function(Ee){Me!==Ee&&!B&&(i.colorMask(Ee,Ee,Ee,Ee),Me=Ee)},setLocked:function(Ee){B=Ee},setClear:function(Ee,Ne,Ae,ae,Ct){!0===Ct&&(Ee*=ae,Ne*=ae,Ae*=ae),pe.set(Ee,Ne,Ae,ae),!1===Xe.equals(pe)&&(i.clearColor(Ee,Ne,Ae,ae),Xe.copy(pe))},reset:function(){B=!1,Me=null,Xe.set(-1,0,0,0)}}},l=new function s(){let B=!1,pe=null,Me=null,Xe=null;return{setTest:function(Ee){Ee?De(2929):K(2929)},setMask:function(Ee){pe!==Ee&&!B&&(i.depthMask(Ee),pe=Ee)},setFunc:function(Ee){if(Me!==Ee){if(Ee)switch(Ee){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:default:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517)}else i.depthFunc(515);Me=Ee}},setLocked:function(Ee){B=Ee},setClear:function(Ee){Xe!==Ee&&(i.clearDepth(Ee),Xe=Ee)},reset:function(){B=!1,pe=null,Me=null,Xe=null}}},c=new function o(){let B=!1,pe=null,Me=null,Xe=null,Ee=null,Ne=null,Ae=null,ae=null,Ct=null;return{setTest:function(Lt){B||(Lt?De(2960):K(2960))},setMask:function(Lt){pe!==Lt&&!B&&(i.stencilMask(Lt),pe=Lt)},setFunc:function(Lt,Kn,xr){(Me!==Lt||Xe!==Kn||Ee!==xr)&&(i.stencilFunc(Lt,Kn,xr),Me=Lt,Xe=Kn,Ee=xr)},setOp:function(Lt,Kn,xr){(Ne!==Lt||Ae!==Kn||ae!==xr)&&(i.stencilOp(Lt,Kn,xr),Ne=Lt,Ae=Kn,ae=xr)},setLocked:function(Lt){B=Lt},setClear:function(Lt){Ct!==Lt&&(i.clearStencil(Lt),Ct=Lt)},reset:function(){B=!1,pe=null,Me=null,Xe=null,Ee=null,Ne=null,Ae=null,ae=null,Ct=null}}};let u={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,y=null,_=null,v=null,x=null,b=null,S=null,E=!1,w=null,T=null,I=null,k=null,W=null;const $=i.getParameter(35661);let N=!1,G=0;const F=i.getParameter(7938);-1!==F.indexOf("WebGL")?(G=parseFloat(/^WebGL (\d)/.exec(F)[1]),N=G>=1):-1!==F.indexOf("OpenGL ES")&&(G=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),N=G>=2);let z=null,V={};const U=i.getParameter(3088),j=i.getParameter(2978),te=(new Vt).fromArray(U),Q=(new Vt).fromArray(j);function he(B,pe,Me){const Xe=new Uint8Array(4),Ee=i.createTexture();i.bindTexture(B,Ee),i.texParameteri(B,10241,9728),i.texParameteri(B,10240,9728);for(let Ne=0;Ne<Me;Ne++)i.texImage2D(pe+Ne,0,6408,1,1,0,6408,5121,Xe);return Ee}const ce={};function De(B){!0!==u[B]&&(i.enable(B),u[B]=!0)}function K(B){!1!==u[B]&&(i.disable(B),u[B]=!1)}ce[3553]=he(3553,3553,1),ce[34067]=he(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),De(2929),l.setFunc(3),xe(!1),Ge(1),De(2884),se(0);const ye={100:32774,101:32778,102:32779};if(n)ye[103]=32775,ye[104]=32776;else{const B=e.get("EXT_blend_minmax");null!==B&&(ye[103]=B.MIN_EXT,ye[104]=B.MAX_EXT)}const Ke={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function se(B,pe,Me,Xe,Ee,Ne,Ae,ae){if(0!==B){if(!1===m&&(De(3042),m=!0),5===B)Ee=Ee||pe,Ne=Ne||Me,Ae=Ae||Xe,(pe!==y||Ee!==x)&&(i.blendEquationSeparate(ye[pe],ye[Ee]),y=pe,x=Ee),(Me!==_||Xe!==v||Ne!==b||Ae!==S)&&(i.blendFuncSeparate(Ke[Me],Ke[Xe],Ke[Ne],Ke[Ae]),_=Me,v=Xe,b=Ne,S=Ae),g=B,E=null;else if(B!==g||ae!==E){if((100!==y||100!==x)&&(i.blendEquation(32774),y=100,x=100),ae)switch(B){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",B)}else switch(B){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",B)}_=null,v=null,b=null,S=null,g=B,E=ae}}else!0===m&&(K(3042),m=!1)}function xe(B){w!==B&&(i.frontFace(B?2304:2305),w=B)}function Ge(B){0!==B?(De(2884),B!==T&&i.cullFace(1===B?1029:2===B?1028:1032)):K(2884),T=B}function rt(B,pe,Me){B?(De(32823),(k!==pe||W!==Me)&&(i.polygonOffset(pe,Me),k=pe,W=Me)):K(32823)}function Ze(B){void 0===B&&(B=33984+$-1),z!==B&&(i.activeTexture(B),z=B)}return{buffers:{color:a,depth:l,stencil:c},enable:De,disable:K,bindFramebuffer:function He(B,pe){return h[B]!==pe&&(i.bindFramebuffer(B,pe),h[B]=pe,n&&(36009===B&&(h[36160]=pe),36160===B&&(h[36009]=pe)),!0)},drawBuffers:function Be(B,pe){let Me=f,Xe=!1;if(B)if(Me=d.get(pe),void 0===Me&&(Me=[],d.set(pe,Me)),B.isWebGLMultipleRenderTargets){const Ee=B.texture;if(Me.length!==Ee.length||36064!==Me[0]){for(let Ne=0,Ae=Ee.length;Ne<Ae;Ne++)Me[Ne]=36064+Ne;Me.length=Ee.length,Xe=!0}}else 36064!==Me[0]&&(Me[0]=36064,Xe=!0);else 1029!==Me[0]&&(Me[0]=1029,Xe=!0);Xe&&(t.isWebGL2?i.drawBuffers(Me):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Me))},useProgram:function $e(B){return p!==B&&(i.useProgram(B),p=B,!0)},setBlending:se,setMaterial:function oe(B,pe){2===B.side?K(2884):De(2884);let Me=1===B.side;pe&&(Me=!Me),xe(Me),1===B.blending&&!1===B.transparent?se(0):se(B.blending,B.blendEquation,B.blendSrc,B.blendDst,B.blendEquationAlpha,B.blendSrcAlpha,B.blendDstAlpha,B.premultipliedAlpha),l.setFunc(B.depthFunc),l.setTest(B.depthTest),l.setMask(B.depthWrite),a.setMask(B.colorWrite);const Xe=B.stencilWrite;c.setTest(Xe),Xe&&(c.setMask(B.stencilWriteMask),c.setFunc(B.stencilFunc,B.stencilRef,B.stencilFuncMask),c.setOp(B.stencilFail,B.stencilZFail,B.stencilZPass)),rt(B.polygonOffset,B.polygonOffsetFactor,B.polygonOffsetUnits),!0===B.alphaToCoverage?De(32926):K(32926)},setFlipSided:xe,setCullFace:Ge,setLineWidth:function Ie(B){B!==I&&(N&&i.lineWidth(B),I=B)},setPolygonOffset:rt,setScissorTest:function Qe(B){B?De(3089):K(3089)},activeTexture:Ze,bindTexture:function Ot(B,pe){null===z&&Ze();let Me=V[z];void 0===Me&&(Me={type:void 0,texture:void 0},V[z]=Me),(Me.type!==B||Me.texture!==pe)&&(i.bindTexture(B,pe||ce[B]),Me.type=B,Me.texture=pe)},unbindTexture:function It(){const B=V[z];void 0!==B&&void 0!==B.type&&(i.bindTexture(B.type,null),B.type=void 0,B.texture=void 0)},compressedTexImage2D:function O(){try{i.compressedTexImage2D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texImage2D:function Je(){try{i.texImage2D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texImage3D:function R(){try{i.texImage3D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texStorage2D:function be(){try{i.texStorage2D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texStorage3D:function Re(){try{i.texStorage3D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texSubImage2D:function A(){try{i.texSubImage2D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},texSubImage3D:function ee(){try{i.texSubImage3D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},compressedTexSubImage2D:function me(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(B){console.error("THREE.WebGLState:",B)}},scissor:function ue(B){!1===te.equals(B)&&(i.scissor(B.x,B.y,B.z,B.w),te.copy(B))},viewport:function Ce(B){!1===Q.equals(B)&&(i.viewport(B.x,B.y,B.z,B.w),Q.copy(B))},reset:function Te(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},z=null,V={},h={},d=new WeakMap,f=[],p=null,m=!1,g=null,y=null,_=null,v=null,x=null,b=null,S=null,E=!1,w=null,T=null,I=null,k=null,W=null,te.set(0,0,i.canvas.width,i.canvas.height),Q.set(0,0,i.canvas.width,i.canvas.height),a.reset(),l.reset(),c.reset()}}}function PX(i,e,t,n,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let m;const g=new WeakMap;let y=!1;try{y="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(O){}function _(O,A){return y?new OffscreenCanvas(O,A):Xh("canvas")}function v(O,A,ee,me){let be=1;if((O.width>me||O.height>me)&&(be=me/Math.max(O.width,O.height)),be<1||!0===A){if("undefined"!=typeof HTMLImageElement&&O instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&O instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&O instanceof ImageBitmap){const Re=A?ym:Math.floor,Je=Re(be*O.width),R=Re(be*O.height);void 0===m&&(m=_(Je,R));const ue=ee?_(Je,R):m;return ue.width=Je,ue.height=R,ue.getContext("2d").drawImage(O,0,0,Je,R),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+O.width+"x"+O.height+") to ("+Je+"x"+R+")."),ue}return"data"in O&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+O.width+"x"+O.height+")."),O}return O}function x(O){return Ux(O.width)&&Ux(O.height)}function S(O,A){return O.generateMipmaps&&A&&O.minFilter!==pn&&O.minFilter!==Kt}function E(O){i.generateMipmap(O)}function w(O,A,ee,me,be=!1){if(!1===a)return A;if(null!==O){if(void 0!==i[O])return i[O];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+O+"'")}let Re=A;return 6403===A&&(5126===ee&&(Re=33326),5131===ee&&(Re=33325),5121===ee&&(Re=33321)),33319===A&&(5126===ee&&(Re=33328),5131===ee&&(Re=33327),5121===ee&&(Re=33323)),6408===A&&(5126===ee&&(Re=34836),5131===ee&&(Re=34842),5121===ee&&(Re=me===Pt&&!1===be?35907:32856),32819===ee&&(Re=32854),32820===ee&&(Re=32855)),(33325===Re||33326===Re||33327===Re||33328===Re||34842===Re||34836===Re)&&e.get("EXT_color_buffer_float"),Re}function T(O,A,ee){return!0===S(O,ee)||O.isFramebufferTexture&&O.minFilter!==pn&&O.minFilter!==Kt?Math.log2(Math.max(A.width,A.height))+1:void 0!==O.mipmaps&&O.mipmaps.length>0?O.mipmaps.length:O.isCompressedTexture&&Array.isArray(O.image)?A.mipmaps.length:1}function I(O){return O===pn||1004===O||1005===O?9728:9729}function k(O){const A=O.target;A.removeEventListener("dispose",k),function $(O){const A=n.get(O);if(void 0===A.__webglInit)return;const ee=O.source,me=g.get(ee);if(me){const be=me[A.__cacheKey];be.usedTimes--,0===be.usedTimes&&N(O),0===Object.keys(me).length&&g.delete(ee)}n.remove(O)}(A),A.isVideoTexture&&p.delete(A)}function W(O){const A=O.target;A.removeEventListener("dispose",W),function G(O){const A=O.texture,ee=n.get(O),me=n.get(A);if(void 0!==me.__webglTexture&&(i.deleteTexture(me.__webglTexture),o.memory.textures--),O.depthTexture&&O.depthTexture.dispose(),O.isWebGLCubeRenderTarget)for(let be=0;be<6;be++)i.deleteFramebuffer(ee.__webglFramebuffer[be]),ee.__webglDepthbuffer&&i.deleteRenderbuffer(ee.__webglDepthbuffer[be]);else{if(i.deleteFramebuffer(ee.__webglFramebuffer),ee.__webglDepthbuffer&&i.deleteRenderbuffer(ee.__webglDepthbuffer),ee.__webglMultisampledFramebuffer&&i.deleteFramebuffer(ee.__webglMultisampledFramebuffer),ee.__webglColorRenderbuffer)for(let be=0;be<ee.__webglColorRenderbuffer.length;be++)ee.__webglColorRenderbuffer[be]&&i.deleteRenderbuffer(ee.__webglColorRenderbuffer[be]);ee.__webglDepthRenderbuffer&&i.deleteRenderbuffer(ee.__webglDepthRenderbuffer)}if(O.isWebGLMultipleRenderTargets)for(let be=0,Re=A.length;be<Re;be++){const Je=n.get(A[be]);Je.__webglTexture&&(i.deleteTexture(Je.__webglTexture),o.memory.textures--),n.remove(A[be])}n.remove(A),n.remove(O)}(A)}function N(O){const A=n.get(O);i.deleteTexture(A.__webglTexture),delete g.get(O.source)[A.__cacheKey],o.memory.textures--}let F=0;function j(O,A){const ee=n.get(O);if(O.isVideoTexture&&function Ot(O){const A=o.render.frame;p.get(O)!==A&&(p.set(O,A),O.update())}(O),!1===O.isRenderTargetTexture&&O.version>0&&ee.__version!==O.version){const me=O.image;if(null===me)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==me.complete)return void Be(ee,O,A);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+A),t.bindTexture(3553,ee.__webglTexture)}const ce={[Fo]:10497,[gi]:33071,1002:33648},De={[pn]:9728,1004:9984,1005:9986,[Kt]:9729,1007:9985,[Oo]:9987};function K(O,A,ee){if(ee?(i.texParameteri(O,10242,ce[A.wrapS]),i.texParameteri(O,10243,ce[A.wrapT]),(32879===O||35866===O)&&i.texParameteri(O,32882,ce[A.wrapR]),i.texParameteri(O,10240,De[A.magFilter]),i.texParameteri(O,10241,De[A.minFilter])):(i.texParameteri(O,10242,33071),i.texParameteri(O,10243,33071),(32879===O||35866===O)&&i.texParameteri(O,32882,33071),(A.wrapS!==gi||A.wrapT!==gi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(O,10240,I(A.magFilter)),i.texParameteri(O,10241,I(A.minFilter)),A.minFilter!==pn&&A.minFilter!==Kt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const me=e.get("EXT_texture_filter_anisotropic");if(A.type===kr&&!1===e.has("OES_texture_float_linear")||!1===a&&A.type===Us&&!1===e.has("OES_texture_half_float_linear"))return;(A.anisotropy>1||n.get(A).__currentAnisotropy)&&(i.texParameterf(O,me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,r.getMaxAnisotropy())),n.get(A).__currentAnisotropy=A.anisotropy)}}function He(O,A){let ee=!1;void 0===O.__webglInit&&(O.__webglInit=!0,A.addEventListener("dispose",k));const me=A.source;let be=g.get(me);void 0===be&&(be={},g.set(me,be));const Re=function U(O){const A=[];return A.push(O.wrapS),A.push(O.wrapT),A.push(O.magFilter),A.push(O.minFilter),A.push(O.anisotropy),A.push(O.internalFormat),A.push(O.format),A.push(O.type),A.push(O.generateMipmaps),A.push(O.premultiplyAlpha),A.push(O.flipY),A.push(O.unpackAlignment),A.push(O.encoding),A.join()}(A);if(Re!==O.__cacheKey){void 0===be[Re]&&(be[Re]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,ee=!0),be[Re].usedTimes++;const Je=be[O.__cacheKey];void 0!==Je&&(be[O.__cacheKey].usedTimes--,0===Je.usedTimes&&N(A)),O.__cacheKey=Re,O.__webglTexture=be[Re].texture}return ee}function Be(O,A,ee){let me=3553;A.isDataArrayTexture&&(me=35866),A.isData3DTexture&&(me=32879);const be=He(O,A),Re=A.source;if(t.activeTexture(33984+ee),t.bindTexture(me,O.__webglTexture),Re.version!==Re.__currentVersion||!0===be){i.pixelStorei(37440,A.flipY),i.pixelStorei(37441,A.premultiplyAlpha),i.pixelStorei(3317,A.unpackAlignment),i.pixelStorei(37443,0);const Je=function b(O){return!a&&(O.wrapS!==gi||O.wrapT!==gi||O.minFilter!==pn&&O.minFilter!==Kt)}(A)&&!1===x(A.image);let R=v(A.image,Je,!1,u);R=It(A,R);const ue=x(R)||a,Ce=s.convert(A.format,A.encoding);let pe,Te=s.convert(A.type),B=w(A.internalFormat,Ce,Te,A.encoding,A.isVideoTexture);K(me,A,ue);const Me=A.mipmaps,Xe=a&&!0!==A.isVideoTexture,Ee=void 0===Re.__currentVersion||!0===be,Ne=T(A,R,ue);if(A.isDepthTexture)B=6402,a?B=A.type===kr?36012:A.type===Ba?33190:A.type===vc?35056:33189:A.type===kr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),A.format===za&&6402===B&&1012!==A.type&&A.type!==Ba&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),A.type=Ba,Te=s.convert(A.type)),A.format===xc&&6402===B&&(B=34041,A.type!==vc&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),A.type=vc,Te=s.convert(A.type))),Ee&&(Xe?t.texStorage2D(3553,1,B,R.width,R.height):t.texImage2D(3553,0,B,R.width,R.height,0,Ce,Te,null));else if(A.isDataTexture)if(Me.length>0&&ue){Xe&&Ee&&t.texStorage2D(3553,Ne,B,Me[0].width,Me[0].height);for(let Ae=0,ae=Me.length;Ae<ae;Ae++)pe=Me[Ae],Xe?t.texSubImage2D(3553,Ae,0,0,pe.width,pe.height,Ce,Te,pe.data):t.texImage2D(3553,Ae,B,pe.width,pe.height,0,Ce,Te,pe.data);A.generateMipmaps=!1}else Xe?(Ee&&t.texStorage2D(3553,Ne,B,R.width,R.height),t.texSubImage2D(3553,0,0,0,R.width,R.height,Ce,Te,R.data)):t.texImage2D(3553,0,B,R.width,R.height,0,Ce,Te,R.data);else if(A.isCompressedTexture){Xe&&Ee&&t.texStorage2D(3553,Ne,B,Me[0].width,Me[0].height);for(let Ae=0,ae=Me.length;Ae<ae;Ae++)pe=Me[Ae],A.format!==Ti?null!==Ce?Xe?t.compressedTexSubImage2D(3553,Ae,0,0,pe.width,pe.height,Ce,pe.data):t.compressedTexImage2D(3553,Ae,B,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Xe?t.texSubImage2D(3553,Ae,0,0,pe.width,pe.height,Ce,Te,pe.data):t.texImage2D(3553,Ae,B,pe.width,pe.height,0,Ce,Te,pe.data)}else if(A.isDataArrayTexture)Xe?(Ee&&t.texStorage3D(35866,Ne,B,R.width,R.height,R.depth),t.texSubImage3D(35866,0,0,0,0,R.width,R.height,R.depth,Ce,Te,R.data)):t.texImage3D(35866,0,B,R.width,R.height,R.depth,0,Ce,Te,R.data);else if(A.isData3DTexture)Xe?(Ee&&t.texStorage3D(32879,Ne,B,R.width,R.height,R.depth),t.texSubImage3D(32879,0,0,0,0,R.width,R.height,R.depth,Ce,Te,R.data)):t.texImage3D(32879,0,B,R.width,R.height,R.depth,0,Ce,Te,R.data);else if(A.isFramebufferTexture){if(Ee)if(Xe)t.texStorage2D(3553,Ne,B,R.width,R.height);else{let Ae=R.width,ae=R.height;for(let Ct=0;Ct<Ne;Ct++)t.texImage2D(3553,Ct,B,Ae,ae,0,Ce,Te,null),Ae>>=1,ae>>=1}}else if(Me.length>0&&ue){Xe&&Ee&&t.texStorage2D(3553,Ne,B,Me[0].width,Me[0].height);for(let Ae=0,ae=Me.length;Ae<ae;Ae++)pe=Me[Ae],Xe?t.texSubImage2D(3553,Ae,0,0,Ce,Te,pe):t.texImage2D(3553,Ae,B,Ce,Te,pe);A.generateMipmaps=!1}else Xe?(Ee&&t.texStorage2D(3553,Ne,B,R.width,R.height),t.texSubImage2D(3553,0,0,0,Ce,Te,R)):t.texImage2D(3553,0,B,Ce,Te,R);S(A,ue)&&E(me),Re.__currentVersion=Re.version,A.onUpdate&&A.onUpdate(A)}O.__version=A.version}function ye(O,A,ee,me,be){const Re=s.convert(ee.format,ee.encoding),Je=s.convert(ee.type),R=w(ee.internalFormat,Re,Je,ee.encoding);n.get(A).__hasExternalTextures||(32879===be||35866===be?t.texImage3D(be,0,R,A.width,A.height,A.depth,0,Re,Je,null):t.texImage2D(be,0,R,A.width,A.height,0,Re,Je,null)),t.bindFramebuffer(36160,O),Ze(A)?d.framebufferTexture2DMultisampleEXT(36160,me,be,n.get(ee).__webglTexture,0,Qe(A)):i.framebufferTexture2D(36160,me,be,n.get(ee).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ke(O,A,ee){if(i.bindRenderbuffer(36161,O),A.depthBuffer&&!A.stencilBuffer){let me=33189;if(ee||Ze(A)){const be=A.depthTexture;be&&be.isDepthTexture&&(be.type===kr?me=36012:be.type===Ba&&(me=33190));const Re=Qe(A);Ze(A)?d.renderbufferStorageMultisampleEXT(36161,Re,me,A.width,A.height):i.renderbufferStorageMultisample(36161,Re,me,A.width,A.height)}else i.renderbufferStorage(36161,me,A.width,A.height);i.framebufferRenderbuffer(36160,36096,36161,O)}else if(A.depthBuffer&&A.stencilBuffer){const me=Qe(A);ee&&!1===Ze(A)?i.renderbufferStorageMultisample(36161,me,35056,A.width,A.height):Ze(A)?d.renderbufferStorageMultisampleEXT(36161,me,35056,A.width,A.height):i.renderbufferStorage(36161,34041,A.width,A.height),i.framebufferRenderbuffer(36160,33306,36161,O)}else{const me=!0===A.isWebGLMultipleRenderTargets?A.texture:[A.texture];for(let be=0;be<me.length;be++){const Re=me[be],Je=s.convert(Re.format,Re.encoding),R=s.convert(Re.type),ue=w(Re.internalFormat,Je,R,Re.encoding),Ce=Qe(A);ee&&!1===Ze(A)?i.renderbufferStorageMultisample(36161,Ce,ue,A.width,A.height):Ze(A)?d.renderbufferStorageMultisampleEXT(36161,Ce,ue,A.width,A.height):i.renderbufferStorage(36161,ue,A.width,A.height)}}i.bindRenderbuffer(36161,null)}function oe(O){const A=n.get(O),ee=!0===O.isWebGLCubeRenderTarget;if(O.depthTexture&&!A.__autoAllocateDepthBuffer){if(ee)throw new Error("target.depthTexture not supported in Cube render targets");!function se(O,A){if(A&&A.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,O),!A.depthTexture||!A.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(A.depthTexture).__webglTexture||A.depthTexture.image.width!==A.width||A.depthTexture.image.height!==A.height)&&(A.depthTexture.image.width=A.width,A.depthTexture.image.height=A.height,A.depthTexture.needsUpdate=!0),j(A.depthTexture,0);const me=n.get(A.depthTexture).__webglTexture,be=Qe(A);if(A.depthTexture.format===za)Ze(A)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,me,0,be):i.framebufferTexture2D(36160,36096,3553,me,0);else{if(A.depthTexture.format!==xc)throw new Error("Unknown depthTexture format");Ze(A)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,me,0,be):i.framebufferTexture2D(36160,33306,3553,me,0)}}(A.__webglFramebuffer,O)}else if(ee){A.__webglDepthbuffer=[];for(let me=0;me<6;me++)t.bindFramebuffer(36160,A.__webglFramebuffer[me]),A.__webglDepthbuffer[me]=i.createRenderbuffer(),Ke(A.__webglDepthbuffer[me],O,!1)}else t.bindFramebuffer(36160,A.__webglFramebuffer),A.__webglDepthbuffer=i.createRenderbuffer(),Ke(A.__webglDepthbuffer,O,!1);t.bindFramebuffer(36160,null)}function Qe(O){return Math.min(h,O.samples)}function Ze(O){const A=n.get(O);return a&&O.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==A.__useRenderToTexture}function It(O,A){const ee=O.encoding,me=O.format,be=O.type;return!0===O.isCompressedTexture||!0===O.isVideoTexture||1035===O.format||ee!==hs&&(ee===Pt?!1===a?!0===e.has("EXT_sRGB")&&me===Ti?(O.format=1035,O.minFilter=Kt,O.generateMipmaps=!1):A=LR.sRGBToLinear(A):(me!==Ti||be!==ka)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ee)),A}this.allocateTextureUnit=function V(){const O=F;return O>=l&&console.warn("THREE.WebGLTextures: Trying to use "+O+" texture units while this GPU supports only "+l),F+=1,O},this.resetTextureUnits=function z(){F=0},this.setTexture2D=j,this.setTexture2DArray=function te(O,A){const ee=n.get(O);O.version>0&&ee.__version!==O.version?Be(ee,O,A):(t.activeTexture(33984+A),t.bindTexture(35866,ee.__webglTexture))},this.setTexture3D=function Q(O,A){const ee=n.get(O);O.version>0&&ee.__version!==O.version?Be(ee,O,A):(t.activeTexture(33984+A),t.bindTexture(32879,ee.__webglTexture))},this.setTextureCube=function he(O,A){const ee=n.get(O);O.version>0&&ee.__version!==O.version?function $e(O,A,ee){if(6!==A.image.length)return;const me=He(O,A),be=A.source;if(t.activeTexture(33984+ee),t.bindTexture(34067,O.__webglTexture),be.version!==be.__currentVersion||!0===me){i.pixelStorei(37440,A.flipY),i.pixelStorei(37441,A.premultiplyAlpha),i.pixelStorei(3317,A.unpackAlignment),i.pixelStorei(37443,0);const Re=A.isCompressedTexture||A.image[0].isCompressedTexture,Je=A.image[0]&&A.image[0].isDataTexture,R=[];for(let Ae=0;Ae<6;Ae++)R[Ae]=Re||Je?Je?A.image[Ae].image:A.image[Ae]:v(A.image[Ae],!1,!0,c),R[Ae]=It(A,R[Ae]);const ue=R[0],Ce=x(ue)||a,Te=s.convert(A.format,A.encoding),B=s.convert(A.type),pe=w(A.internalFormat,Te,B,A.encoding),Me=a&&!0!==A.isVideoTexture,Xe=void 0===be.__currentVersion||!0===me;let Ne,Ee=T(A,ue,Ce);if(K(34067,A,Ce),Re){Me&&Xe&&t.texStorage2D(34067,Ee,pe,ue.width,ue.height);for(let Ae=0;Ae<6;Ae++){Ne=R[Ae].mipmaps;for(let ae=0;ae<Ne.length;ae++){const Ct=Ne[ae];A.format!==Ti?null!==Te?Me?t.compressedTexSubImage2D(34069+Ae,ae,0,0,Ct.width,Ct.height,Te,Ct.data):t.compressedTexImage2D(34069+Ae,ae,pe,Ct.width,Ct.height,0,Ct.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Me?t.texSubImage2D(34069+Ae,ae,0,0,Ct.width,Ct.height,Te,B,Ct.data):t.texImage2D(34069+Ae,ae,pe,Ct.width,Ct.height,0,Te,B,Ct.data)}}}else{Ne=A.mipmaps,Me&&Xe&&(Ne.length>0&&Ee++,t.texStorage2D(34067,Ee,pe,R[0].width,R[0].height));for(let Ae=0;Ae<6;Ae++)if(Je){Me?t.texSubImage2D(34069+Ae,0,0,0,R[Ae].width,R[Ae].height,Te,B,R[Ae].data):t.texImage2D(34069+Ae,0,pe,R[Ae].width,R[Ae].height,0,Te,B,R[Ae].data);for(let ae=0;ae<Ne.length;ae++){const Lt=Ne[ae].image[Ae].image;Me?t.texSubImage2D(34069+Ae,ae+1,0,0,Lt.width,Lt.height,Te,B,Lt.data):t.texImage2D(34069+Ae,ae+1,pe,Lt.width,Lt.height,0,Te,B,Lt.data)}}else{Me?t.texSubImage2D(34069+Ae,0,0,0,Te,B,R[Ae]):t.texImage2D(34069+Ae,0,pe,Te,B,R[Ae]);for(let ae=0;ae<Ne.length;ae++){const Ct=Ne[ae];Me?t.texSubImage2D(34069+Ae,ae+1,0,0,Te,B,Ct.image[Ae]):t.texImage2D(34069+Ae,ae+1,pe,Te,B,Ct.image[Ae])}}}S(A,Ce)&&E(34067),be.__currentVersion=be.version,A.onUpdate&&A.onUpdate(A)}O.__version=A.version}(ee,O,A):(t.activeTexture(33984+A),t.bindTexture(34067,ee.__webglTexture))},this.rebindTextures=function xe(O,A,ee){const me=n.get(O);void 0!==A&&ye(me.__webglFramebuffer,O,O.texture,36064,3553),void 0!==ee&&oe(O)},this.setupRenderTarget=function Ge(O){const A=O.texture,ee=n.get(O),me=n.get(A);O.addEventListener("dispose",W),!0!==O.isWebGLMultipleRenderTargets&&(void 0===me.__webglTexture&&(me.__webglTexture=i.createTexture()),me.__version=A.version,o.memory.textures++);const be=!0===O.isWebGLCubeRenderTarget,Re=!0===O.isWebGLMultipleRenderTargets,Je=x(O)||a;if(be){ee.__webglFramebuffer=[];for(let R=0;R<6;R++)ee.__webglFramebuffer[R]=i.createFramebuffer()}else{if(ee.__webglFramebuffer=i.createFramebuffer(),Re)if(r.drawBuffers){const R=O.texture;for(let ue=0,Ce=R.length;ue<Ce;ue++){const Te=n.get(R[ue]);void 0===Te.__webglTexture&&(Te.__webglTexture=i.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&O.samples>0&&!1===Ze(O)){const R=Re?A:[A];ee.__webglMultisampledFramebuffer=i.createFramebuffer(),ee.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,ee.__webglMultisampledFramebuffer);for(let ue=0;ue<R.length;ue++){const Ce=R[ue];ee.__webglColorRenderbuffer[ue]=i.createRenderbuffer(),i.bindRenderbuffer(36161,ee.__webglColorRenderbuffer[ue]);const Te=s.convert(Ce.format,Ce.encoding),B=s.convert(Ce.type),pe=w(Ce.internalFormat,Te,B,Ce.encoding),Me=Qe(O);i.renderbufferStorageMultisample(36161,Me,pe,O.width,O.height),i.framebufferRenderbuffer(36160,36064+ue,36161,ee.__webglColorRenderbuffer[ue])}i.bindRenderbuffer(36161,null),O.depthBuffer&&(ee.__webglDepthRenderbuffer=i.createRenderbuffer(),Ke(ee.__webglDepthRenderbuffer,O,!0)),t.bindFramebuffer(36160,null)}}if(be){t.bindTexture(34067,me.__webglTexture),K(34067,A,Je);for(let R=0;R<6;R++)ye(ee.__webglFramebuffer[R],O,A,36064,34069+R);S(A,Je)&&E(34067),t.unbindTexture()}else if(Re){const R=O.texture;for(let ue=0,Ce=R.length;ue<Ce;ue++){const Te=R[ue],B=n.get(Te);t.bindTexture(3553,B.__webglTexture),K(3553,Te,Je),ye(ee.__webglFramebuffer,O,Te,36064+ue,3553),S(Te,Je)&&E(3553)}t.unbindTexture()}else{let R=3553;(O.isWebGL3DRenderTarget||O.isWebGLArrayRenderTarget)&&(a?R=O.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(R,me.__webglTexture),K(R,A,Je),ye(ee.__webglFramebuffer,O,A,36064,R),S(A,Je)&&E(R),t.unbindTexture()}O.depthBuffer&&oe(O)},this.updateRenderTargetMipmap=function Ie(O){const A=x(O)||a,ee=!0===O.isWebGLMultipleRenderTargets?O.texture:[O.texture];for(let me=0,be=ee.length;me<be;me++){const Re=ee[me];if(S(Re,A)){const Je=O.isWebGLCubeRenderTarget?34067:3553,R=n.get(Re).__webglTexture;t.bindTexture(Je,R),E(Je),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function rt(O){if(a&&O.samples>0&&!1===Ze(O)){const A=O.isWebGLMultipleRenderTargets?O.texture:[O.texture],ee=O.width,me=O.height;let be=16384;const Re=[],Je=O.stencilBuffer?33306:36096,R=n.get(O),ue=!0===O.isWebGLMultipleRenderTargets;if(ue)for(let Ce=0;Ce<A.length;Ce++)t.bindFramebuffer(36160,R.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ce,36161,null),t.bindFramebuffer(36160,R.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ce,3553,null,0);t.bindFramebuffer(36008,R.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,R.__webglFramebuffer);for(let Ce=0;Ce<A.length;Ce++){Re.push(36064+Ce),O.depthBuffer&&Re.push(Je);const Te=void 0!==R.__ignoreDepthValues&&R.__ignoreDepthValues;if(!1===Te&&(O.depthBuffer&&(be|=256),O.stencilBuffer&&(be|=1024)),ue&&i.framebufferRenderbuffer(36008,36064,36161,R.__webglColorRenderbuffer[Ce]),!0===Te&&(i.invalidateFramebuffer(36008,[Je]),i.invalidateFramebuffer(36009,[Je])),ue){const B=n.get(A[Ce]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,B,0)}i.blitFramebuffer(0,0,ee,me,0,0,ee,me,be,9728),f&&i.invalidateFramebuffer(36008,Re)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ue)for(let Ce=0;Ce<A.length;Ce++){t.bindFramebuffer(36160,R.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Ce,36161,R.__webglColorRenderbuffer[Ce]);const Te=n.get(A[Ce]).__webglTexture;t.bindFramebuffer(36160,R.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Ce,3553,Te,0)}t.bindFramebuffer(36009,R.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=oe,this.setupFrameBufferTexture=ye,this.useMultisampledRTT=Ze}function LX(i,e,t){const n=t.isWebGL2;return{convert:function r(s,o=null){let a;if(s===ka)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(1012===s)return 5123;if(1013===s)return 5124;if(s===Ba)return 5125;if(s===kr)return 5126;if(s===Us)return n?5131:(a=e.get("OES_texture_half_float"),null!==a?a.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Ti)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===za)return 6402;if(s===xc)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return a=e.get("EXT_sRGB"),null!==a?a.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(o===Pt){if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===a)return null;if(33776===s)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(a=e.get("WEBGL_compressed_texture_s3tc"),null===a)return null;if(33776===s)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(a=e.get("WEBGL_compressed_texture_pvrtc"),null===a)return null;if(35840===s)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return a=e.get("WEBGL_compressed_texture_etc1"),null!==a?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(a=e.get("WEBGL_compressed_texture_etc"),null===a)return null;if(37492===s)return o===Pt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(a=e.get("WEBGL_compressed_texture_astc"),null===a)return null;if(37808===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return o===Pt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(a=e.get("EXT_texture_compression_bptc"),null===a)return null;if(36492===s)return o===Pt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===vc?n?34042:(a=e.get("WEBGL_depth_texture"),null!==a?a.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class FX extends Bn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class fs extends sn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const OX={type:"move"};class vw{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new fs,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new fs,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new D,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new D),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new fs,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new D,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new D),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==a&&(r=t.getPose(e.targetRaySpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(OX))),c&&e.hand){o=!0;for(const m of e.hand.values()){const g=t.getJointPose(m,n);if(void 0===c.joints[m.jointName]){const _=new fs;_.matrixAutoUpdate=!1,_.visible=!1,c.joints[m.jointName]=_,c.add(_)}const y=c.joints[m.jointName];null!==g&&(y.matrix.fromArray(g.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=g.radius),y.visible=null!==g}const d=c.joints["index-finger-tip"].position.distanceTo(c.joints["thumb-tip"].position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));return null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),null!==c&&(c.visible=null!==o),this}}class NX extends hr{constructor(e,t,n,r,s,o,a,l,c,u){if((u=void 0!==u?u:za)!==za&&u!==xc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===za&&(n=Ba),void 0===n&&u===xc&&(n=vc),super(null,r,s,o,a,l,u,n,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==a?a:pn,this.minFilter=void 0!==l?l:pn,this.flipY=!1,this.generateMipmaps=!1}}class kX extends Ha{constructor(e,t){super();const n=this;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,h=null,d=null,f=null;const p=t.getContextAttributes();let m=null,g=null;const y=[],_=new Map,v=new Bn;v.layers.enable(1),v.viewport=new Vt;const x=new Bn;x.layers.enable(2),x.viewport=new Vt;const b=[v,x],S=new FX;S.layers.enable(1),S.layers.enable(2);let E=null,w=null;function T(U){const j=_.get(U.inputSource);void 0!==j&&j.dispatchEvent({type:U.type,data:U.inputSource})}function I(){r.removeEventListener("select",T),r.removeEventListener("selectstart",T),r.removeEventListener("selectend",T),r.removeEventListener("squeeze",T),r.removeEventListener("squeezestart",T),r.removeEventListener("squeezeend",T),r.removeEventListener("end",I),r.removeEventListener("inputsourceschange",k),_.forEach(function(U,j){void 0!==U&&U.disconnect(j)}),_.clear(),E=null,w=null,e.setRenderTarget(m),d=null,h=null,u=null,r=null,g=null,V.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function k(U){const j=r.inputSources;for(let te=0;te<j.length;te++)_.set(j[te],y["right"===j[te].handedness?1:0]);for(let te=0;te<U.removed.length;te++){const Q=U.removed[te],he=_.get(Q);he&&(he.dispatchEvent({type:"disconnected",data:Q}),_.delete(Q))}for(let te=0;te<U.added.length;te++){const Q=U.added[te],he=_.get(Q);he&&he.dispatchEvent({type:"connected",data:Q})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(U){let j=y[U];return void 0===j&&(j=new vw,y[U]=j),j.getTargetRaySpace()},this.getControllerGrip=function(U){let j=y[U];return void 0===j&&(j=new vw,y[U]=j),j.getGripSpace()},this.getHand=function(U){let j=y[U];return void 0===j&&(j=new vw,y[U]=j),j.getHandSpace()},this.setFramebufferScaleFactor=function(U){s=U,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(U){a=U,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(U){l=U},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(){var U=function dj(i){return function(){var e=this,t=arguments;return new Promise(function(n,r){var s=i.apply(e,t);function o(l){XI(s,n,r,o,a,"next",l)}function a(l){XI(s,n,r,o,a,"throw",l)}o(void 0)})}}(function*(j){if(r=j,null!==r){if(m=e.getRenderTarget(),r.addEventListener("select",T),r.addEventListener("selectstart",T),r.addEventListener("selectend",T),r.addEventListener("squeeze",T),r.addEventListener("squeezestart",T),r.addEventListener("squeezeend",T),r.addEventListener("end",I),r.addEventListener("inputsourceschange",k),!0!==p.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)d=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||p.antialias,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:d}),g=new Ai(d.framebufferWidth,d.framebufferHeight,{format:Ti,type:ka,encoding:e.outputEncoding});else{let te=null,Q=null,he=null;p.depth&&(he=p.stencil?35056:33190,te=p.stencil?xc:za,Q=p.stencil?vc:Ba);const ce={colorFormat:e.outputEncoding===Pt?35907:32856,depthFormat:he,scaleFactor:s};u=new XRWebGLBinding(r,t),h=u.createProjectionLayer(ce),r.updateRenderState({layers:[h]}),g=new Ai(h.textureWidth,h.textureHeight,{format:Ti,type:ka,depthTexture:new NX(h.textureWidth,h.textureHeight,Q,void 0,void 0,void 0,void 0,void 0,void 0,te),stencilBuffer:p.stencil,encoding:e.outputEncoding,samples:p.antialias?4:0}),e.properties.get(g).__ignoreDepthValues=h.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(1),l=null,o=yield r.requestReferenceSpace(a),V.setContext(r),V.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(j){return U.apply(this,arguments)}}();const W=new D,$=new D;function G(U,j){null===j?U.matrixWorld.copy(U.matrix):U.matrixWorld.multiplyMatrices(j.matrixWorld,U.matrix),U.matrixWorldInverse.copy(U.matrixWorld).invert()}this.updateCamera=function(U){if(null===r)return;S.near=x.near=v.near=U.near,S.far=x.far=v.far=U.far,(E!==S.near||w!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),E=S.near,w=S.far);const j=U.parent,te=S.cameras;G(S,j);for(let he=0;he<te.length;he++)G(te[he],j);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),U.position.copy(S.position),U.quaternion.copy(S.quaternion),U.scale.copy(S.scale),U.matrix.copy(S.matrix),U.matrixWorld.copy(S.matrixWorld);const Q=U.children;for(let he=0,ce=Q.length;he<ce;he++)Q[he].updateMatrixWorld(!0);2===te.length?function N(U,j,te){W.setFromMatrixPosition(j.matrixWorld),$.setFromMatrixPosition(te.matrixWorld);const Q=W.distanceTo($),he=j.projectionMatrix.elements,ce=te.projectionMatrix.elements,De=he[14]/(he[10]-1),K=he[14]/(he[10]+1),He=(he[9]+1)/he[5],Be=(he[9]-1)/he[5],$e=(he[8]-1)/he[0],ye=(ce[8]+1)/ce[0],Ke=De*$e,se=De*ye,oe=Q/(-$e+ye),xe=oe*-$e;j.matrixWorld.decompose(U.position,U.quaternion,U.scale),U.translateX(xe),U.translateZ(oe),U.matrixWorld.compose(U.position,U.quaternion,U.scale),U.matrixWorldInverse.copy(U.matrixWorld).invert();const Ge=De+oe,Ie=K+oe;U.projectionMatrix.makePerspective(Ke-xe,se+(Q-xe),He*K/Ie*Ge,Be*K/Ie*Ge,Ge,Ie)}(S,v,x):S.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){return null!==h?h.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(U){null!==h&&(h.fixedFoveation=U),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=U)};let F=null;const V=new XR;V.setAnimationLoop(function z(U,j){if(c=j.getViewerPose(l||o),f=j,null!==c){const Q=c.views;null!==d&&(e.setRenderTargetFramebuffer(g,d.framebuffer),e.setRenderTarget(g));let he=!1;Q.length!==S.cameras.length&&(S.cameras.length=0,he=!0);for(let ce=0;ce<Q.length;ce++){const De=Q[ce];let K=null;if(null!==d)K=d.getViewport(De);else{const Be=u.getViewSubImage(h,De);K=Be.viewport,0===ce&&(e.setRenderTargetTextures(g,Be.colorTexture,h.ignoreDepthValues?void 0:Be.depthStencilTexture),e.setRenderTarget(g))}let He=b[ce];void 0===He&&(He=new Bn,He.layers.enable(ce),He.viewport=new Vt,b[ce]=He),He.matrix.fromArray(De.transform.matrix),He.projectionMatrix.fromArray(De.projectionMatrix),He.viewport.set(K.x,K.y,K.width,K.height),0===ce&&S.matrix.copy(He.matrix),!0===he&&S.cameras.push(He)}}const te=r.inputSources;for(let Q=0;Q<y.length;Q++){const he=te[Q],ce=_.get(he);void 0!==ce&&ce.update(he,j,l||o)}F&&F(U,j),f=null}),this.setAnimationLoop=function(U){F=U},this.dispose=function(){}}}function BX(i,e){function r(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,1===g.side&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),1===g.side&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const y=e.get(g).envMap;if(y&&(m.envMap.value=y,m.flipEnvMap.value=y.isCubeTexture&&!1===y.isRenderTargetTexture?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const x=!0!==i.physicallyCorrectLights?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*x}let _,v;g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity),g.map?_=g.map:g.specularMap?_=g.specularMap:g.displacementMap?_=g.displacementMap:g.normalMap?_=g.normalMap:g.bumpMap?_=g.bumpMap:g.roughnessMap?_=g.roughnessMap:g.metalnessMap?_=g.metalnessMap:g.alphaMap?_=g.alphaMap:g.emissiveMap?_=g.emissiveMap:g.clearcoatMap?_=g.clearcoatMap:g.clearcoatNormalMap?_=g.clearcoatNormalMap:g.clearcoatRoughnessMap?_=g.clearcoatRoughnessMap:g.iridescenceMap?_=g.iridescenceMap:g.iridescenceThicknessMap?_=g.iridescenceThicknessMap:g.specularIntensityMap?_=g.specularIntensityMap:g.specularColorMap?_=g.specularColorMap:g.transmissionMap?_=g.transmissionMap:g.thicknessMap?_=g.thicknessMap:g.sheenColorMap?_=g.sheenColorMap:g.sheenRoughnessMap&&(_=g.sheenRoughnessMap),void 0!==_&&(_.isWebGLRenderTarget&&(_=_.texture),!0===_.matrixAutoUpdate&&_.updateMatrix(),m.uvTransform.value.copy(_.matrix)),g.aoMap?v=g.aoMap:g.lightMap&&(v=g.lightMap),void 0!==v&&(v.isWebGLRenderTarget&&(v=v.texture),!0===v.matrixAutoUpdate&&v.updateMatrix(),m.uv2Transform.value.copy(v.matrix))}return{refreshFogUniforms:function t(m,g){m.fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)},refreshMaterialUniforms:function n(m,g,y,_,v){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(m,g):g.isMeshToonMaterial?(r(m,g),function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}(m,g)):g.isMeshPhongMaterial?(r(m,g),function c(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}(m,g)):g.isMeshStandardMaterial?(r(m,g),function h(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}(m,g),g.isMeshPhysicalMaterial&&function d(m,g,y){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,1===g.side&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}(m,g,v)):g.isMeshMatcapMaterial?(r(m,g),function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}(m,g)):g.isMeshDepthMaterial?r(m,g):g.isMeshDistanceMaterial?(r(m,g),function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}(m,g)):g.isMeshNormalMaterial?r(m,g):g.isLineBasicMaterial?(function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}(m,g),g.isLineDashedMaterial&&function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}(m,g)):g.isPointsMaterial?function a(m,g,y,_){let v;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*y,m.scale.value=.5*_,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),void 0!==v&&(!0===v.matrixAutoUpdate&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}(m,g,y,_):g.isSpriteMaterial?function l(m,g){let y;m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest),g.map?y=g.map:g.alphaMap&&(y=g.alphaMap),void 0!==y&&(!0===y.matrixAutoUpdate&&y.updateMatrix(),m.uvTransform.value.copy(y.matrix))}(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}}}function xw(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function zX(){const i=Xh("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,o=void 0===i.premultipliedAlpha||i.premultipliedAlpha,a=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,l=void 0!==i.powerPreference?i.powerPreference:"default",c=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let u;u=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let h=null,d=null;const f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=hs,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const m=this;let g=!1,y=0,_=0,v=null,x=-1,b=null;const S=new Vt,E=new Vt;let w=null,T=e.width,I=e.height,k=1,W=null,$=null;const N=new Vt(0,0,T,I),G=new Vt(0,0,T,I);let F=!1;const z=new dw;let V=!1,U=!1,j=null;const te=new ft,Q=new ne,he=new D,ce={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function De(){return null===v?k:1}let Be,$e,ye,Ke,se,oe,xe,Ge,Ie,rt,Qe,Ze,Ot,It,O,A,ee,me,be,Re,Je,R,ue,K=t;function He(P,Z){for(let J=0;J<P.length;J++){const le=e.getContext(P[J],Z);if(null!==le)return le}return null}try{const P={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r141"),e.addEventListener("webglcontextlost",B,!1),e.addEventListener("webglcontextrestored",pe,!1),e.addEventListener("webglcontextcreationerror",Me,!1),null===K){const Z=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&Z.shift(),K=He(Z,P),null===K)throw He(Z)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===K.getShaderPrecisionFormat&&(K.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(P){throw console.error("THREE.WebGLRenderer: "+P.message),P}function Ce(){Be=new Qq(K),$e=new qq(K,Be,i),Be.init($e),R=new LX(K,Be,$e),ye=new RX(K,Be,$e),Ke=new t$(K),se=new vX,oe=new PX(K,Be,ye,se,$e,R,Ke),xe=new Xq(m),Ge=new Kq(m),Ie=new j9(K,$e),ue=new Wq(K,Be,Ie,$e),rt=new Jq(K,Ie,Ke,ue),Qe=new s$(K,rt,Ie,Ke),be=new r$(K,$e,oe),A=new $q(se),Ze=new _X(m,xe,Ge,Be,$e,ue,A),Ot=new BX(m,se),It=new wX,O=new TX(Be,$e),me=new Gq(m,xe,ye,Qe,u,o),ee=new IX(m,Qe,$e),Re=new jq(K,Be,Ke,$e),Je=new e$(K,Be,Ke,$e),Ke.programs=Ze.programs,m.capabilities=$e,m.extensions=Be,m.properties=se,m.renderLists=It,m.shadowMap=ee,m.state=ye,m.info=Ke}Ce();const Te=new kX(m,K);function B(P){P.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const P=Ke.autoReset,Z=ee.enabled,J=ee.autoUpdate,q=ee.needsUpdate,le=ee.type;Ce(),Ke.autoReset=P,ee.enabled=Z,ee.autoUpdate=J,ee.needsUpdate=q,ee.type=le}function Me(P){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",P.statusMessage)}function Xe(P){const Z=P.target;Z.removeEventListener("dispose",Xe),function Ee(P){(function Ne(P){const Z=se.get(P).programs;void 0!==Z&&(Z.forEach(function(J){Ze.releaseProgram(J)}),P.isShaderMaterial&&Ze.releaseShaderCache(P))})(P),se.remove(P)}(Z)}this.xr=Te,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const P=Be.get("WEBGL_lose_context");P&&P.loseContext()},this.forceContextRestore=function(){const P=Be.get("WEBGL_lose_context");P&&P.restoreContext()},this.getPixelRatio=function(){return k},this.setPixelRatio=function(P){void 0!==P&&(k=P,this.setSize(T,I,!1))},this.getSize=function(P){return P.set(T,I)},this.setSize=function(P,Z,J){Te.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(T=P,I=Z,e.width=Math.floor(P*k),e.height=Math.floor(Z*k),!1!==J&&(e.style.width=P+"px",e.style.height=Z+"px"),this.setViewport(0,0,P,Z))},this.getDrawingBufferSize=function(P){return P.set(T*k,I*k).floor()},this.setDrawingBufferSize=function(P,Z,J){T=P,I=Z,k=J,e.width=Math.floor(P*J),e.height=Math.floor(Z*J),this.setViewport(0,0,P,Z)},this.getCurrentViewport=function(P){return P.copy(S)},this.getViewport=function(P){return P.copy(N)},this.setViewport=function(P,Z,J,q){P.isVector4?N.set(P.x,P.y,P.z,P.w):N.set(P,Z,J,q),ye.viewport(S.copy(N).multiplyScalar(k).floor())},this.getScissor=function(P){return P.copy(G)},this.setScissor=function(P,Z,J,q){P.isVector4?G.set(P.x,P.y,P.z,P.w):G.set(P,Z,J,q),ye.scissor(E.copy(G).multiplyScalar(k).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(P){ye.setScissorTest(F=P)},this.setOpaqueSort=function(P){W=P},this.setTransparentSort=function(P){$=P},this.getClearColor=function(P){return P.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor.apply(me,arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha.apply(me,arguments)},this.clear=function(P=!0,Z=!0,J=!0){let q=0;P&&(q|=16384),Z&&(q|=256),J&&(q|=1024),K.clear(q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",B,!1),e.removeEventListener("webglcontextrestored",pe,!1),e.removeEventListener("webglcontextcreationerror",Me,!1),It.dispose(),O.dispose(),se.dispose(),xe.dispose(),Ge.dispose(),Qe.dispose(),ue.dispose(),Ze.dispose(),Te.dispose(),Te.removeEventListener("sessionstart",Ct),Te.removeEventListener("sessionend",Lt),j&&(j.dispose(),j=null),Kn.stop()},this.renderBufferDirect=function(P,Z,J,q,le,nt){null===Z&&(Z=ce);const M=le.isMesh&&le.matrixWorld.determinant()<0,C=function oM(P,Z,J,q,le){!0!==Z.isScene&&(Z=ce),oe.resetTextureUnits();const nt=Z.fog,C=null===v?m.outputEncoding:!0===v.isXRRenderTarget?v.texture.encoding:hs,L=(q.isMeshStandardMaterial?Ge:xe).get(q.envMap||(q.isMeshStandardMaterial?Z.environment:null)),H=!0===q.vertexColors&&!!J.attributes.color&&4===J.attributes.color.itemSize,Y=!!q.normalMap&&!!J.attributes.tangent,X=!!J.morphAttributes.position,ie=!!J.morphAttributes.normal,_e=!!J.morphAttributes.color,Se=q.toneMapped?m.toneMapping:0,de=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,ge=void 0!==de?de.length:0,ve=se.get(q),Ue=d.state.lights;!0!==V||!0!==U&&P===b||A.setState(q,P,P===b&&q.id===x);let ze=!1;q.version===ve.__version?(ve.needsLights&&ve.lightsStateVersion!==Ue.state.version||ve.outputEncoding!==C||le.isInstancedMesh&&!1===ve.instancing||!le.isInstancedMesh&&!0===ve.instancing||le.isSkinnedMesh&&!1===ve.skinning||!le.isSkinnedMesh&&!0===ve.skinning||ve.envMap!==L||!0===q.fog&&ve.fog!==nt||void 0!==ve.numClippingPlanes&&(ve.numClippingPlanes!==A.numPlanes||ve.numIntersection!==A.numIntersection)||ve.vertexAlphas!==H||ve.vertexTangents!==Y||ve.morphTargets!==X||ve.morphNormals!==ie||ve.morphColors!==_e||ve.toneMapping!==Se||!0===$e.isWebGL2&&ve.morphTargetsCount!==ge)&&(ze=!0):(ze=!0,ve.__version=q.version);let et=ve.currentProgram;!0===ze&&(et=qd(q,Z,le));let Ve=!1,qe=!1,pt=!1;const _t=et.getUniforms(),Ht=ve.uniforms;if(ye.useProgram(et.program)&&(Ve=!0,qe=!0,pt=!0),q.id!==x&&(x=q.id,qe=!0),Ve||b!==P){if(_t.setValue(K,"projectionMatrix",P.projectionMatrix),$e.logarithmicDepthBuffer&&_t.setValue(K,"logDepthBufFC",2/(Math.log(P.far+1)/Math.LN2)),b!==P&&(b=P,qe=!0,pt=!0),q.isShaderMaterial||q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshStandardMaterial||q.envMap){const Et=_t.map.cameraPosition;void 0!==Et&&Et.setValue(K,he.setFromMatrixPosition(P.matrixWorld))}(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial)&&_t.setValue(K,"isOrthographic",!0===P.isOrthographicCamera),(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial||q.isShadowMaterial||le.isSkinnedMesh)&&_t.setValue(K,"viewMatrix",P.matrixWorldInverse)}if(le.isSkinnedMesh){_t.setOptional(K,le,"bindMatrix"),_t.setOptional(K,le,"bindMatrixInverse");const Et=le.skeleton;Et&&($e.floatVertexTextures?(null===Et.boneTexture&&Et.computeBoneTexture(),_t.setValue(K,"boneTexture",Et.boneTexture,oe),_t.setValue(K,"boneTextureSize",Et.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Qn=J.morphAttributes;return(void 0!==Qn.position||void 0!==Qn.normal||void 0!==Qn.color&&!0===$e.isWebGL2)&&be.update(le,J,q,et),(qe||ve.receiveShadow!==le.receiveShadow)&&(ve.receiveShadow=le.receiveShadow,_t.setValue(K,"receiveShadow",le.receiveShadow)),qe&&(_t.setValue(K,"toneMappingExposure",m.toneMappingExposure),ve.needsLights&&function aM(P,Z){P.ambientLightColor.needsUpdate=Z,P.lightProbe.needsUpdate=Z,P.directionalLights.needsUpdate=Z,P.directionalLightShadows.needsUpdate=Z,P.pointLights.needsUpdate=Z,P.pointLightShadows.needsUpdate=Z,P.spotLights.needsUpdate=Z,P.spotLightShadows.needsUpdate=Z,P.rectAreaLights.needsUpdate=Z,P.hemisphereLights.needsUpdate=Z}(Ht,pt),nt&&!0===q.fog&&Ot.refreshFogUniforms(Ht,nt),Ot.refreshMaterialUniforms(Ht,q,k,I,j),Hm.upload(K,ve.uniformsList,Ht,oe)),q.isShaderMaterial&&!0===q.uniformsNeedUpdate&&(Hm.upload(K,ve.uniformsList,Ht,oe),q.uniformsNeedUpdate=!1),q.isSpriteMaterial&&_t.setValue(K,"center",le.center),_t.setValue(K,"modelViewMatrix",le.modelViewMatrix),_t.setValue(K,"normalMatrix",le.normalMatrix),_t.setValue(K,"modelMatrix",le.matrixWorld),et}(P,Z,J,q,le);ye.setMaterial(q,M);let L=J.index;const H=J.attributes.position;if(null===L){if(void 0===H||0===H.count)return}else if(0===L.count)return;let Y=1;!0===q.wireframe&&(L=rt.getWireframeAttribute(J),Y=2),ue.setup(le,q,C,J,L);let X,ie=Re;null!==L&&(X=Ie.get(L),ie=Je,ie.setIndex(X));const _e=null!==L?L.count:H.count,Se=J.drawRange.start*Y,de=J.drawRange.count*Y,ge=null!==nt?nt.start*Y:0,ve=null!==nt?nt.count*Y:1/0,Ue=Math.max(Se,ge),ze=Math.min(_e,Se+de,ge+ve)-1,et=Math.max(0,ze-Ue+1);if(0!==et){if(le.isMesh)!0===q.wireframe?(ye.setLineWidth(q.wireframeLinewidth*De()),ie.setMode(1)):ie.setMode(4);else if(le.isLine){let Ve=q.linewidth;void 0===Ve&&(Ve=1),ye.setLineWidth(Ve*De()),ie.setMode(le.isLineSegments?1:le.isLineLoop?2:3)}else le.isPoints?ie.setMode(0):le.isSprite&&ie.setMode(4);if(le.isInstancedMesh)ie.renderInstances(Ue,et,le.count);else if(J.isInstancedBufferGeometry){const Ve=Math.min(J.instanceCount,J._maxInstanceCount);ie.renderInstances(Ue,et,Ve)}else ie.render(Ue,et)}},this.compile=function(P,Z){d=O.get(P),d.init(),p.push(d),P.traverseVisible(function(J){J.isLight&&J.layers.test(Z.layers)&&(d.pushLight(J),J.castShadow&&d.pushShadow(J))}),d.setupLights(m.physicallyCorrectLights),P.traverse(function(J){const q=J.material;if(q)if(Array.isArray(q))for(let le=0;le<q.length;le++)qd(q[le],P,J);else qd(q,P,J)}),p.pop(),d=null};let Ae=null;function Ct(){Kn.stop()}function Lt(){Kn.start()}const Kn=new XR;function xr(P,Z,J,q){if(!1===P.visible)return;if(P.layers.test(Z.layers))if(P.isGroup)J=P.renderOrder;else if(P.isLOD)!0===P.autoUpdate&&P.update(Z);else if(P.isLight)d.pushLight(P),P.castShadow&&d.pushShadow(P);else if(P.isSprite){if(!P.frustumCulled||z.intersectsSprite(P)){q&&he.setFromMatrixPosition(P.matrixWorld).applyMatrix4(te);const M=Qe.update(P),C=P.material;C.visible&&h.push(P,M,C,J,he.z,null)}}else if((P.isMesh||P.isLine||P.isPoints)&&(P.isSkinnedMesh&&P.skeleton.frame!==Ke.render.frame&&(P.skeleton.update(),P.skeleton.frame=Ke.render.frame),!P.frustumCulled||z.intersectsObject(P))){q&&he.setFromMatrixPosition(P.matrixWorld).applyMatrix4(te);const M=Qe.update(P),C=P.material;if(Array.isArray(C)){const L=M.groups;for(let H=0,Y=L.length;H<Y;H++){const X=L[H],ie=C[X.materialIndex];ie&&ie.visible&&h.push(P,M,ie,J,he.z,X)}}else C.visible&&h.push(P,M,C,J,he.z,null)}const nt=P.children;for(let M=0,C=nt.length;M<C;M++)xr(nt[M],Z,J,q)}function fy(P,Z,J,q){const le=P.opaque,nt=P.transmissive,M=P.transparent;d.setupLightsView(J),nt.length>0&&function rM(P,Z,J){const q=$e.isWebGL2;null===j&&(j=new Ai(1,1,{generateMipmaps:!0,type:Be.has("EXT_color_buffer_half_float")?Us:ka,minFilter:Oo,samples:q&&!0===s?4:0})),m.getDrawingBufferSize(Q),q?j.setSize(Q.x,Q.y):j.setSize(ym(Q.x),ym(Q.y));const le=m.getRenderTarget();m.setRenderTarget(j),m.clear();const nt=m.toneMapping;m.toneMapping=0,Au(P,Z,J),m.toneMapping=nt,oe.updateMultisampleRenderTarget(j),oe.updateRenderTargetMipmap(j),m.setRenderTarget(le)}(le,Z,J),q&&ye.viewport(S.copy(q)),le.length>0&&Au(le,Z,J),nt.length>0&&Au(nt,Z,J),M.length>0&&Au(M,Z,J),ye.buffers.depth.setTest(!0),ye.buffers.depth.setMask(!0),ye.buffers.color.setMask(!0),ye.setPolygonOffset(!1)}function Au(P,Z,J){const q=!0===Z.isScene?Z.overrideMaterial:null;for(let le=0,nt=P.length;le<nt;le++){const M=P[le],C=M.object,L=M.geometry,H=null===q?M.material:q,Y=M.group;C.layers.test(J.layers)&&sM(C,Z,J,L,H,Y)}}function sM(P,Z,J,q,le,nt){P.onBeforeRender(m,Z,J,q,le,nt),P.modelViewMatrix.multiplyMatrices(J.matrixWorldInverse,P.matrixWorld),P.normalMatrix.getNormalMatrix(P.modelViewMatrix),le.onBeforeRender(m,Z,J,q,P,nt),!0===le.transparent&&2===le.side?(le.side=1,le.needsUpdate=!0,m.renderBufferDirect(J,Z,q,le,P,nt),le.side=0,le.needsUpdate=!0,m.renderBufferDirect(J,Z,q,le,P,nt),le.side=2):m.renderBufferDirect(J,Z,q,le,P,nt),P.onAfterRender(m,Z,J,q,le,nt)}function qd(P,Z,J){!0!==Z.isScene&&(Z=ce);const q=se.get(P),le=d.state.lights,M=le.state.version,C=Ze.getParameters(P,le.state,d.state.shadowsArray,Z,J),L=Ze.getProgramCacheKey(C);let H=q.programs;q.environment=P.isMeshStandardMaterial?Z.environment:null,q.fog=Z.fog,q.envMap=(P.isMeshStandardMaterial?Ge:xe).get(P.envMap||q.environment),void 0===H&&(P.addEventListener("dispose",Xe),H=new Map,q.programs=H);let Y=H.get(L);if(void 0!==Y){if(q.currentProgram===Y&&q.lightsStateVersion===M)return py(P,C),Y}else C.uniforms=Ze.getUniforms(P),P.onBuild(J,C,m),P.onBeforeCompile(C,m),Y=Ze.acquireProgram(C,L),H.set(L,Y),q.uniforms=C.uniforms;const X=q.uniforms;(!P.isShaderMaterial&&!P.isRawShaderMaterial||!0===P.clipping)&&(X.clippingPlanes=A.uniform),py(P,C),q.needsLights=function Du(P){return P.isMeshLambertMaterial||P.isMeshToonMaterial||P.isMeshPhongMaterial||P.isMeshStandardMaterial||P.isShadowMaterial||P.isShaderMaterial&&!0===P.lights}(P),q.lightsStateVersion=M,q.needsLights&&(X.ambientLightColor.value=le.state.ambient,X.lightProbe.value=le.state.probe,X.directionalLights.value=le.state.directional,X.directionalLightShadows.value=le.state.directionalShadow,X.spotLights.value=le.state.spot,X.spotLightShadows.value=le.state.spotShadow,X.rectAreaLights.value=le.state.rectArea,X.ltc_1.value=le.state.rectAreaLTC1,X.ltc_2.value=le.state.rectAreaLTC2,X.pointLights.value=le.state.point,X.pointLightShadows.value=le.state.pointShadow,X.hemisphereLights.value=le.state.hemi,X.directionalShadowMap.value=le.state.directionalShadowMap,X.directionalShadowMatrix.value=le.state.directionalShadowMatrix,X.spotShadowMap.value=le.state.spotShadowMap,X.spotShadowMatrix.value=le.state.spotShadowMatrix,X.pointShadowMap.value=le.state.pointShadowMap,X.pointShadowMatrix.value=le.state.pointShadowMatrix);const ie=Y.getUniforms(),_e=Hm.seqWithValue(ie.seq,X);return q.currentProgram=Y,q.uniformsList=_e,Y}function py(P,Z){const J=se.get(P);J.outputEncoding=Z.outputEncoding,J.instancing=Z.instancing,J.skinning=Z.skinning,J.morphTargets=Z.morphTargets,J.morphNormals=Z.morphNormals,J.morphColors=Z.morphColors,J.morphTargetsCount=Z.morphTargetsCount,J.numClippingPlanes=Z.numClippingPlanes,J.numIntersection=Z.numClipIntersection,J.vertexAlphas=Z.vertexAlphas,J.vertexTangents=Z.vertexTangents,J.toneMapping=Z.toneMapping}Kn.setAnimationLoop(function ae(P){Ae&&Ae(P)}),"undefined"!=typeof self&&Kn.setContext(self),this.setAnimationLoop=function(P){Ae=P,Te.setAnimationLoop(P),null===P?Kn.stop():Kn.start()},Te.addEventListener("sessionstart",Ct),Te.addEventListener("sessionend",Lt),this.render=function(P,Z){if(void 0===Z||!0===Z.isCamera){if(!0!==g){if(!0===P.autoUpdate&&P.updateMatrixWorld(),null===Z.parent&&Z.updateMatrixWorld(),!0===Te.enabled&&!0===Te.isPresenting&&(!0===Te.cameraAutoUpdate&&Te.updateCamera(Z),Z=Te.getCamera()),!0===P.isScene&&P.onBeforeRender(m,P,Z,v),d=O.get(P,p.length),d.init(),p.push(d),te.multiplyMatrices(Z.projectionMatrix,Z.matrixWorldInverse),z.setFromProjectionMatrix(te),U=this.localClippingEnabled,V=A.init(this.clippingPlanes,U,Z),h=It.get(P,f.length),h.init(),f.push(h),xr(P,Z,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(W,$),!0===V&&A.beginShadows(),ee.render(d.state.shadowsArray,P,Z),!0===V&&A.endShadows(),!0===this.info.autoReset&&this.info.reset(),me.render(h,P),d.setupLights(m.physicallyCorrectLights),Z.isArrayCamera){const q=Z.cameras;for(let le=0,nt=q.length;le<nt;le++){const M=q[le];fy(h,P,M,M.viewport)}}else fy(h,P,Z);null!==v&&(oe.updateMultisampleRenderTarget(v),oe.updateRenderTargetMipmap(v)),!0===P.isScene&&P.onAfterRender(m,P,Z),ue.resetDefaultState(),x=-1,b=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),h=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return v},this.setRenderTargetTextures=function(P,Z,J){se.get(P.texture).__webglTexture=Z,se.get(P.depthTexture).__webglTexture=J;const q=se.get(P);q.__hasExternalTextures=!0,q.__hasExternalTextures&&(q.__autoAllocateDepthBuffer=void 0===J,q.__autoAllocateDepthBuffer||!0===Be.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),q.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(P,Z){const J=se.get(P);J.__webglFramebuffer=Z,J.__useDefaultFramebuffer=void 0===Z},this.setRenderTarget=function(P,Z=0,J=0){v=P,y=Z,_=J;let q=!0;if(P){const L=se.get(P);void 0!==L.__useDefaultFramebuffer?(ye.bindFramebuffer(36160,null),q=!1):void 0===L.__webglFramebuffer?oe.setupRenderTarget(P):L.__hasExternalTextures&&oe.rebindTextures(P,se.get(P.texture).__webglTexture,se.get(P.depthTexture).__webglTexture)}let le=null,nt=!1,M=!1;if(P){const L=P.texture;(L.isData3DTexture||L.isDataArrayTexture)&&(M=!0);const H=se.get(P).__webglFramebuffer;P.isWebGLCubeRenderTarget?(le=H[Z],nt=!0):le=$e.isWebGL2&&P.samples>0&&!1===oe.useMultisampledRTT(P)?se.get(P).__webglMultisampledFramebuffer:H,S.copy(P.viewport),E.copy(P.scissor),w=P.scissorTest}else S.copy(N).multiplyScalar(k).floor(),E.copy(G).multiplyScalar(k).floor(),w=F;if(ye.bindFramebuffer(36160,le)&&$e.drawBuffers&&q&&ye.drawBuffers(P,le),ye.viewport(S),ye.scissor(E),ye.setScissorTest(w),nt){const L=se.get(P.texture);K.framebufferTexture2D(36160,36064,34069+Z,L.__webglTexture,J)}else if(M){const L=se.get(P.texture);K.framebufferTextureLayer(36160,36064,L.__webglTexture,J||0,Z||0)}x=-1},this.readRenderTargetPixels=function(P,Z,J,q,le,nt,M){if(!P||!P.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let C=se.get(P).__webglFramebuffer;if(P.isWebGLCubeRenderTarget&&void 0!==M&&(C=C[M]),C){ye.bindFramebuffer(36160,C);try{const L=P.texture,H=L.format,Y=L.type;if(H!==Ti&&R.convert(H)!==K.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const X=Y===Us&&(Be.has("EXT_color_buffer_half_float")||$e.isWebGL2&&Be.has("EXT_color_buffer_float"));if(!(Y===ka||R.convert(Y)===K.getParameter(35738)||Y===kr&&($e.isWebGL2||Be.has("OES_texture_float")||Be.has("WEBGL_color_buffer_float"))||X))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Z>=0&&Z<=P.width-q&&J>=0&&J<=P.height-le&&K.readPixels(Z,J,q,le,R.convert(H),R.convert(Y),nt)}finally{const L=null!==v?se.get(v).__webglFramebuffer:null;ye.bindFramebuffer(36160,L)}}},this.copyFramebufferToTexture=function(P,Z,J=0){const q=Math.pow(2,-J),le=Math.floor(Z.image.width*q),nt=Math.floor(Z.image.height*q);oe.setTexture2D(Z,0),K.copyTexSubImage2D(3553,J,0,0,P.x,P.y,le,nt),ye.unbindTexture()},this.copyTextureToTexture=function(P,Z,J,q=0){const le=Z.image.width,nt=Z.image.height,M=R.convert(J.format),C=R.convert(J.type);oe.setTexture2D(J,0),K.pixelStorei(37440,J.flipY),K.pixelStorei(37441,J.premultiplyAlpha),K.pixelStorei(3317,J.unpackAlignment),Z.isDataTexture?K.texSubImage2D(3553,q,P.x,P.y,le,nt,M,C,Z.image.data):Z.isCompressedTexture?K.compressedTexSubImage2D(3553,q,P.x,P.y,Z.mipmaps[0].width,Z.mipmaps[0].height,M,Z.mipmaps[0].data):K.texSubImage2D(3553,q,P.x,P.y,M,C,Z.image),0===q&&J.generateMipmaps&&K.generateMipmap(3553),ye.unbindTexture()},this.copyTextureToTexture3D=function(P,Z,J,q,le=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const nt=P.max.x-P.min.x+1,M=P.max.y-P.min.y+1,C=P.max.z-P.min.z+1,L=R.convert(q.format),H=R.convert(q.type);let Y;if(q.isData3DTexture)oe.setTexture3D(q,0),Y=32879;else{if(!q.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");oe.setTexture2DArray(q,0),Y=35866}K.pixelStorei(37440,q.flipY),K.pixelStorei(37441,q.premultiplyAlpha),K.pixelStorei(3317,q.unpackAlignment);const X=K.getParameter(3314),ie=K.getParameter(32878),_e=K.getParameter(3316),Se=K.getParameter(3315),de=K.getParameter(32877),ge=J.isCompressedTexture?J.mipmaps[0]:J.image;K.pixelStorei(3314,ge.width),K.pixelStorei(32878,ge.height),K.pixelStorei(3316,P.min.x),K.pixelStorei(3315,P.min.y),K.pixelStorei(32877,P.min.z),J.isDataTexture||J.isData3DTexture?K.texSubImage3D(Y,le,Z.x,Z.y,Z.z,nt,M,C,L,H,ge.data):J.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),K.compressedTexSubImage3D(Y,le,Z.x,Z.y,Z.z,nt,M,C,L,ge.data)):K.texSubImage3D(Y,le,Z.x,Z.y,Z.z,nt,M,C,L,H,ge),K.pixelStorei(3314,X),K.pixelStorei(32878,ie),K.pixelStorei(3316,_e),K.pixelStorei(3315,Se),K.pixelStorei(32877,de),0===le&&q.generateMipmaps&&K.generateMipmap(Y),ye.unbindTexture()},this.initTexture=function(P){oe.setTexture2D(P,0),ye.unbindTexture()},this.resetState=function(){y=0,_=0,v=null,ye.reset(),ue.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class UX extends xw{}).prototype.isWebGL1Renderer=!0;class SP extends sn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class Mw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Wi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Wi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Wi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const vi=new D;class Ja{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)vi.fromBufferAttribute(this,t),vi.applyMatrix4(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)vi.fromBufferAttribute(this,t),vi.applyNormalMatrix(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)vi.fromBufferAttribute(this,t),vi.transformDirection(e),this.setXYZ(t,vi.x,vi.y,vi.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Sn(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ja(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const IP=new D,RP=new Vt,PP=new Vt,GX=new D,LP=new ft;class FP extends kn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ft,this.bindMatrixInverse=new ft}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vt,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;RP.fromBufferAttribute(r.attributes.skinIndex,e),PP.fromBufferAttribute(r.attributes.skinWeight,e),IP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=PP.getComponent(s);if(0!==o){const a=RP.getComponent(s);LP.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(GX.copy(IP).applyMatrix4(LP),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Ew extends sn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class rd extends hr{constructor(e=null,t=1,n=1,r,s,o,a,l,c=pn,u=pn,h,d){super(null,o,a,l,c,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const OP=new ft,WX=new ft;class $m{constructor(e=[],t=[]){this.uuid=Wi(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new ft)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new ft;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++)OP.multiplyMatrices(e[s]?e[s].matrixWorld:WX,t[s]),OP.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new $m(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=IR(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new rd(t,e,e,Ti,kr);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let o=t[s];void 0===o&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Ew),this.bones.push(o),this.boneInverses.push((new ft).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class zn extends un{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new we(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const BP=new D,zP=new D,UP=new ft,Cw=new Cm,Zm=new Xa;class el extends sn{constructor(e=new lt,t=new zn){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)BP.fromBufferAttribute(t,r-1),zP.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=BP.distanceTo(zP);e.setAttribute("lineDistance",new ke(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Zm.copy(n.boundingSphere),Zm.applyMatrix4(r),Zm.radius+=s,!1===e.ray.intersectsSphere(Zm))return;UP.copy(r).invert(),Cw.copy(e.ray).applyMatrix4(UP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new D,u=new D,h=new D,d=new D,f=this.isLineSegments?2:1,p=n.index,g=n.attributes.position;if(null!==p)for(let v=Math.max(0,o.start),x=Math.min(p.count,o.start+o.count)-1;v<x;v+=f){const b=p.getX(v),S=p.getX(v+1);if(c.fromBufferAttribute(g,b),u.fromBufferAttribute(g,S),Cw.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const w=e.ray.origin.distanceTo(d);w<e.near||w>e.far||t.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(let v=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count)-1;v<x;v+=f){if(c.fromBufferAttribute(g,v),u.fromBufferAttribute(g,v+1),Cw.distanceSqToSegment(c,u,d,h)>l)continue;d.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||t.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const VP=new D,HP=new D;class ad extends el{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)VP.fromBufferAttribute(t,r),HP.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+VP.distanceTo(HP);e.setAttribute("lineDistance",new ke(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class GP extends el{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class tl extends un{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new we(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const WP=new ft,Tw=new Cm,Ym=new Xa,Km=new D;class ld extends sn{constructor(e=new lt,t=new tl){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ym.copy(n.boundingSphere),Ym.applyMatrix4(r),Ym.radius+=s,!1===e.ray.intersectsSphere(Ym))return;WP.copy(r).invert(),Tw.copy(e.ray).applyMatrix4(WP);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=n.index,h=n.attributes.position;if(null!==c)for(let p=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);p<m;p++){const g=c.getX(p);Km.fromBufferAttribute(h,g),jP(Km,g,l,r,e,t,this)}else for(let p=Math.max(0,o.start),m=Math.min(h.count,o.start+o.count);p<m;p++)Km.fromBufferAttribute(h,p),jP(Km,p,l,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function jP(i,e,t,n,r,s,o){const a=Tw.distanceSqToPoint(i);if(a<t){const l=new D;Tw.closestPointToPoint(i,l),l.applyMatrix4(n);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class $X extends hr{constructor(e,t,n,r,s,o,a,l,c){super(e,t,n,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}function Dw(){let i=0,e=0,t=0,n=0;function r(s,o,a,l){i=s,e=a,t=-3*s+3*o-2*a-l,n=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,u,h){let d=(o-s)/c-(a-s)/(c+u)+(a-o)/u,f=(a-o)/u-(l-o)/(u+h)+(l-a)/h;d*=u,f*=u,r(o,a,d,f)},calc:function(s){const o=s*s;return i+e*s+t*o+n*(o*s)}}}new D,new Dw,new Dw,new Dw,new D,new D,new D,new Gr;class yd extends un{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new we(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new we(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class jo extends yd{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ne(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new we(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new we(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new we(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class _g extends un{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new we(16777215),this.specular=new we(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new we(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}const OZ={ShadowMaterial:class AZ extends un{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new we(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},SpriteMaterial:class EP extends un{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new we(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},RawShaderMaterial:class DZ extends Ii{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},ShaderMaterial:Ii,PointsMaterial:tl,MeshPhysicalMaterial:jo,MeshStandardMaterial:yd,MeshPhongMaterial:_g,MeshToonMaterial:class IZ extends un{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new we(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new we(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},MeshNormalMaterial:class RZ extends un{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},MeshLambertMaterial:class PZ extends un{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new we(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new we(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},MeshDepthMaterial:bP,MeshDistanceMaterial:MP,MeshBasicMaterial:Di,MeshMatcapMaterial:class LZ extends un{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new we(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}},LineDashedMaterial:class FZ extends zn{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}},LineBasicMaterial:zn,Material:un};un.fromType=function(i){return new OZ[i]};const Qt={arraySlice:function(i,e,t){return Qt.isTypedArray(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n},sortedArray:function(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,o=0;o!==n;++s){const a=t[s]*e;for(let l=0;l!==e;++l)r[o++]=i[a+l]}return r},flattenJSON:function(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let o=s[n];if(void 0!==o)if(Array.isArray(o))do{o=s[n],void 0!==o&&(e.push(s.time),t.push.apply(t,o)),s=i[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[n],void 0!==o&&(e.push(s.time),o.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{o=s[n],void 0!==o&&(e.push(s.time),t.push(o)),s=i[r++]}while(void 0!==s)},subclip:function(i,e,t,n,r=30){const s=i.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),h=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<t||p>=n)){h.push(c.times[f]);for(let m=0;m<u;++m)d.push(c.values[f*u+m])}}0!==h.length&&(c.times=Qt.convertArray(h,c.times.constructor),c.values=Qt.convertArray(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let o=0;o<r;++o){const a=t.tracks[o],l=a.ValueTypeName;if("bool"===l||"string"===l)continue;const c=i.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(void 0===c)continue;let u=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let m;if(s<=a.times[0])m=Qt.arraySlice(a.values,u,h-u);else if(s>=a.times[p]){const y=p*h+u;m=Qt.arraySlice(a.values,y,y+h-u)}else{const y=a.createInterpolant(),_=u,v=h-u;y.evaluate(s),m=Qt.arraySlice(y.resultBuffer,_,v)}"quaternion"===l&&(new oi).fromArray(m).normalize().conjugate().toArray(m);const g=c.times.length;for(let y=0;y<g;++y){const _=y*f+d;if("quaternion"===l)oi.multiplyQuaternionsFlat(c.values,_,m,0,c.values,_);else{const v=f-2*d;for(let x=0;x<v;++x)c.values[_+x]-=m[x]}}}return i.blendMode=2501,i}};class _d{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break t}o=t.length;break n}if(e>=s)break e;{const a=t[1];e<a&&(n=2,s=a);for(let l=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=s,s=t[--n-1],e>=s)break t}o=n,n=0}}for(;n<o;){const a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NZ extends _d{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:s=e,a=2*t-n;break;case 2402:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:o=e,l=2*n-t;break;case 2402:o=1,l=n+r[1]-r[0];break;default:o=e-1,l=t}const c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(l-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(n-t)/(r-t),m=p*p,g=m*p,y=-d*g+2*d*m-d*p,_=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*p+1,v=(-1-f)*g+(1.5+f)*m+.5*p,x=f*g-f*m;for(let b=0;b!==a;++b)s[b]=y*o[u+b]+_*o[c+b]+v*o[l+b]+x*o[h+b];return s}}class s2 extends _d{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,u=(n-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[c+d]*h+o[l+d]*u;return s}}class kZ extends _d{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class ms{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Qt.convertArray(t,this.TimeBufferType),this.values=Qt.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Qt.convertArray(e.times,Array),values:Qt.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new kZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new s2(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new NZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case jh:t=this.InterpolantFactoryMethodDiscrete;break;case wc:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return jh;case this.InterpolantFactoryMethodLinear:return wc;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==o&&n[o]>t;)--o;if(++o,0!==s||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Qt.arraySlice(n,s,o),this.values=Qt.arraySlice(this.values,s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=n[a];if("number"==typeof l&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(null!==o&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(void 0!==r&&Qt.isTypedArray(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Qt.arraySlice(this.times),t=Qt.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a];if(c!==e[a+1]&&(1!==a||c!==e[0]))if(r)l=!0;else{const h=a*n,d=h-n,f=h+n;for(let p=0;p!==n;++p){const m=t[h+p];if(m!==t[d+p]||m!==t[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const h=a*n,d=o*n;for(let f=0;f!==n;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,l=o*n,c=0;c!==n;++c)t[l+c]=t[a+c];++o}return o!==e.length?(this.times=Qt.arraySlice(e,0,o),this.values=Qt.arraySlice(t,0,o*n)):(this.times=e,this.values=t),this}clone(){const e=Qt.arraySlice(this.times,0),t=Qt.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}ms.prototype.TimeBufferType=Float32Array,ms.prototype.ValueBufferType=Float32Array,ms.prototype.DefaultInterpolation=wc;class Kc extends ms{}Kc.prototype.ValueTypeName="bool",Kc.prototype.ValueBufferType=Array,Kc.prototype.DefaultInterpolation=jh,Kc.prototype.InterpolantFactoryMethodLinear=void 0,Kc.prototype.InterpolantFactoryMethodSmooth=void 0;class o2 extends ms{}o2.prototype.ValueTypeName="color";class vd extends ms{}vd.prototype.ValueTypeName="number";class BZ extends _d{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(n-t)/(r-t);let c=e*a;for(let u=c+a;c!==u;c+=4)oi.slerpFlat(s,0,o,c-a,o,c,l);return s}}class nl extends ms{InterpolantFactoryMethodLinear(e){return new BZ(this.times,this.values,this.getValueSize(),e)}}nl.prototype.ValueTypeName="quaternion",nl.prototype.DefaultInterpolation=wc,nl.prototype.InterpolantFactoryMethodSmooth=void 0;class Qc extends ms{}Qc.prototype.ValueTypeName="string",Qc.prototype.ValueBufferType=Array,Qc.prototype.DefaultInterpolation=jh,Qc.prototype.InterpolantFactoryMethodLinear=void 0,Qc.prototype.InterpolantFactoryMethodSmooth=void 0;class xd extends ms{}xd.prototype.ValueTypeName="vector";class wd{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Wi(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let o=0,a=n.length;o!==a;++o)t.push(UZ(n[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=n.length;s!==o;++s)t.push(ms.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const u=Qt.getKeyframeOrder(l);l=Qt.sortedArray(l,1,u),c=Qt.sortedArray(c,1,u),!r&&0===l[0]&&(l.push(s),c.push(c[0])),o.push(new vd(".morphTargetInfluences["+t[a].name+"]",l,c).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],u=c.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(h,d,f,p,m){if(0!==f.length){const g=[],y=[];Qt.flattenJSON(f,g,y,p),0!==g.length&&m.push(new h(d,g,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let h=0;h<c.length;h++){const d=c[h].keys;if(d&&0!==d.length)if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let m=0;m<d[p].morphTargets.length;m++)f[d[p].morphTargets[m]]=-1;for(const m in f){const g=[],y=[];for(let _=0;_!==d[p].morphTargets.length;++_){const v=d[p];g.push(v.time),y.push(v.morphTarget===m?1:0)}r.push(new vd(".morphTargetInfluence["+m+"]",g,y))}l=f.length*o}else{const f=".bones["+t[h].name+"]";n(xd,f+".position",d,"pos",r),n(nl,f+".quaternion",d,"rot",r),n(xd,f+".scale",d,"scl",r)}}return 0===r.length?null:new this(s,l,r,a)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UZ(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function zZ(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vd;case"vector":case"vector2":case"vector3":case"vector4":return xd;case"color":return o2;case"quaternion":return nl;case"bool":case"boolean":return Kc;case"string":return Qc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];Qt.flattenJSON(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const Jc={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};const l2=new class a2{constructor(e,t,n){const r=this;let l,s=!1,o=0,a=0;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,!1===s&&void 0!==r.onStart&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,void 0!==r.onProgress&&r.onProgress(u,o,a),o===a&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(u){void 0!==r.onError&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return-1!==h&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const f=c[h],p=c[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}};class qo{constructor(e){this.manager=void 0!==e?e:l2,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Zs={};class fr extends qo{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Jc.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Zs[e])return void Zs[e].push({onLoad:t,onProgress:n,onError:r});Zs[e]=[],Zs[e].push({onLoad:t,onProgress:n,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(200===c.status||0===c.status){if(0===c.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===c.body||void 0===c.body.getReader)return c;const u=Zs[e],h=c.body.getReader(),d=c.headers.get("Content-Length"),f=d?parseInt(d):0,p=0!==f;let m=0;const g=new ReadableStream({start(y){!function _(){h.read().then(({done:v,value:x})=>{if(v)y.close();else{m+=x.byteLength;const b=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:f});for(let S=0,E=u.length;S<E;S++){const w=u[S];w.onProgress&&w.onProgress(b)}y.enqueue(x),_()}})}()}});return new Response(g)}throw Error(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>(new DOMParser).parseFromString(u,a));case"json":return c.json();default:if(void 0===a)return c.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Jc.add(e,c);const u=Zs[e];delete Zs[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=Zs[e];if(void 0===u)throw this.manager.itemError(e),c;delete Zs[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class vg extends qo{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Jc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Xh("img");function l(){u(),Jc.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class VZ extends qo{constructor(e){super(e)}load(e,t,n,r){const s=this,o=new rd,a=new fr(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);!c||(void 0!==c.image?o.image=c.image:void 0!==c.data&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=void 0!==c.wrapS?c.wrapS:gi,o.wrapT=void 0!==c.wrapT?c.wrapT:gi,o.magFilter=void 0!==c.magFilter?c.magFilter:Kt,o.minFilter=void 0!==c.minFilter?c.minFilter:Kt,o.anisotropy=void 0!==c.anisotropy?c.anisotropy:1,void 0!==c.encoding&&(o.encoding=c.encoding),void 0!==c.flipY&&(o.flipY=c.flipY),void 0!==c.format&&(o.format=c.format),void 0!==c.type&&(o.type=c.type),void 0!==c.mipmaps&&(o.mipmaps=c.mipmaps,o.minFilter=Oo),1===c.mipmapCount&&(o.minFilter=Kt),void 0!==c.generateMipmaps&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,t&&t(o,c))},n,r),o}}class xg extends qo{constructor(e){super(e)}load(e,t,n,r){const s=new hr,o=new vg(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class Bw extends sn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new we(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const c2=new ft,u2=new D,h2=new D;class zw{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new ne(512,512),this.map=null,this.mapPass=null,this.matrix=new ft,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new dw,this._frameExtents=new ne(1,1),this._viewportCount=1,this._viewports=[new Vt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;u2.setFromMatrixPosition(e.matrixWorld),t.position.copy(u2),h2.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(h2),t.updateMatrixWorld(),c2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(c2),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class GZ extends zw{constructor(){super(new Bn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*qh*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class d2 extends Bw{constructor(e,t,n=0,r=Math.PI/3,s=0,o=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(sn.DefaultUp),this.updateMatrix(),this.target=new sn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=o,this.shadow=new GZ}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const f2=new ft,bd=new D,Uw=new D;class WZ extends zw{constructor(){super(new Bn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new ne(4,2),this._viewportCount=6,this._viewports=[new Vt(2,1,1,1),new Vt(0,1,1,1),new Vt(3,1,1,1),new Vt(1,1,1,1),new Vt(3,0,1,1),new Vt(1,0,1,1)],this._cubeDirections=[new D(1,0,0),new D(-1,0,0),new D(0,0,1),new D(0,0,-1),new D(0,1,0),new D(0,-1,0)],this._cubeUps=[new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,1,0),new D(0,0,1),new D(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),bd.setFromMatrixPosition(e.matrixWorld),n.position.copy(bd),Uw.copy(n.position),Uw.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Uw),n.updateMatrixWorld(),r.makeTranslation(-bd.x,-bd.y,-bd.z),f2.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f2)}}class p2 extends Bw{constructor(e,t,n=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new WZ}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class jZ extends zw{constructor(){super(new Uc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Md extends Bw{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(sn.DefaultUp),this.updateMatrix(),this.target=new sn,this.shadow=new jZ}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class gs{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class eY extends qo{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Jc.get(e);if(void 0!==o)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials="anonymous"===this.crossOrigin?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Jc.add(e,l),t&&t(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class x2{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=w2(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=w2();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function w2(){return("undefined"==typeof performance?Date:performance).now()}const Vw="\\[\\]\\.:\\/",rY=new RegExp("["+Vw+"]","g"),Hw="[^"+Vw+"]",sY="[^"+Vw.replace("\\.","")+"]",oY=/((?:WC+[\/:])*)/.source.replace("WC",Hw),aY=/(WCOD+)?/.source.replace("WCOD",sY),lY=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hw),cY=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hw),uY=new RegExp("^"+oY+aY+lY+cY+"$"),hY=["material","materials","bones"];class dY{constructor(e,t,n){const r=n||jt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let jt=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(rY,"")}static parseTrackName(t){const n=uY.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const o=r.nodeName.substring(s+1);-1!==hY.indexOf(o)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(o){for(let a=0;a<o.length;a++){const l=o[a];if(l.name===n||l.uuid===n)return l;const c=r(l.children);if(c)return c}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==u){if(void 0===t[u])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[u]}}const a=t[s];if(void 0===a)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let l=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[o]&&(o=t.morphTargetDictionary[o])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else void 0!==a.fromArray&&void 0!==a.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=dY,i})();jt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},jt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},jt.prototype.GetterByBindingType=[jt.prototype._getValue_direct,jt.prototype._getValue_array,jt.prototype._getValue_arrayElement,jt.prototype._getValue_toArray],jt.prototype.SetterByBindingTypeAndVersioning=[[jt.prototype._setValue_direct,jt.prototype._setValue_direct_setNeedsUpdate,jt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_array,jt.prototype._setValue_array_setNeedsUpdate,jt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_arrayElement,jt.prototype._setValue_arrayElement_setNeedsUpdate,jt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[jt.prototype._setValue_fromArray,jt.prototype._setValue_fromArray_setNeedsUpdate,jt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class mY{constructor(e,t,n=0,r=1/0){this.ray=new Cm(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Qx,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return Gw(e,this,n,t),n.sort(E2),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)Gw(e[r],this,n,t);return n.sort(E2),n}}function E2(i,e){return i.distance-e.distance}function Gw(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),!0===n){const r=i.children;for(let s=0,o=r.length;s<o;s++)Gw(r[s],e,t,!0)}}class C2{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(mn(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class N2{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=mn(e,-65504,65504),B2[0]=e;const t=z2[0],n=t>>23&511;return Wr[n]+((8388607&t)>>jr[n])}static fromHalfFloat(e){const t=e>>10;return z2[0]=qw[U2[t]+(1023&e)]+eu[t],B2[0]}}const k2=new ArrayBuffer(4),B2=new Float32Array(k2),z2=new Uint32Array(k2),Wr=new Uint32Array(512),jr=new Uint32Array(512);for(let i=0;i<256;++i){const e=i-127;e<-27?(Wr[i]=0,Wr[256|i]=32768,jr[i]=24,jr[256|i]=24):e<-14?(Wr[i]=1024>>-e-14,Wr[256|i]=1024>>-e-14|32768,jr[i]=-e-1,jr[256|i]=-e-1):e<=15?(Wr[i]=e+15<<10,Wr[256|i]=e+15<<10|32768,jr[i]=13,jr[256|i]=13):e<128?(Wr[i]=31744,Wr[256|i]=64512,jr[i]=24,jr[256|i]=24):(Wr[i]=31744,Wr[256|i]=64512,jr[i]=13,jr[256|i]=13)}const qw=new Uint32Array(2048),eu=new Uint32Array(64),U2=new Uint32Array(64);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,qw[i]=e|t}for(let i=1024;i<2048;++i)qw[i]=939524096+(i-1024<<13);for(let i=1;i<31;++i)eu[i]=i<<23;eu[31]=1199570944,eu[32]=2147483648;for(let i=33;i<63;++i)eu[i]=2147483648+(i-32<<23);eu[63]=3347054592;for(let i=1;i<64;++i)32!==i&&(U2[i]=1024);"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"141"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="141");const V2={type:"change"},$w={type:"start"},H2={type:"end"};class yY extends Ha{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new D,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(R){R.addEventListener("keydown",It),this._domElementKeyEvents=R},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(V2),n.update(),s=r.NONE},this.update=function(){const R=new D,ue=(new oi).setFromUnitVectors(e.up,new D(0,1,0)),Ce=ue.clone().invert(),Te=new D,B=new oi,pe=2*Math.PI;return function(){const Xe=n.object.position;R.copy(Xe).sub(n.target),R.applyQuaternion(ue),a.setFromVector3(R),n.autoRotate&&s===r.NONE&&T(function E(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(a.theta+=l.theta*n.dampingFactor,a.phi+=l.phi*n.dampingFactor):(a.theta+=l.theta,a.phi+=l.phi);let Ee=n.minAzimuthAngle,Ne=n.maxAzimuthAngle;return isFinite(Ee)&&isFinite(Ne)&&(Ee<-Math.PI?Ee+=pe:Ee>Math.PI&&(Ee-=pe),Ne<-Math.PI?Ne+=pe:Ne>Math.PI&&(Ne-=pe),a.theta=Ee<=Ne?Math.max(Ee,Math.min(Ne,a.theta)):a.theta>(Ee+Ne)/2?Math.max(Ee,a.theta):Math.min(Ne,a.theta)),a.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=c,a.radius=Math.max(n.minDistance,Math.min(n.maxDistance,a.radius)),!0===n.enableDamping?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),R.setFromSpherical(a),R.applyQuaternion(Ce),Xe.copy(n.target).add(R),n.object.lookAt(n.target),!0===n.enableDamping?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0)),c=1,!!(h||Te.distanceToSquared(n.object.position)>o||8*(1-B.dot(n.object.quaternion))>o)&&(n.dispatchEvent(V2),Te.copy(n.object.position),B.copy(n.object.quaternion),h=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ee),n.domElement.removeEventListener("pointerdown",xe),n.domElement.removeEventListener("pointercancel",rt),n.domElement.removeEventListener("wheel",Ot),n.domElement.removeEventListener("pointermove",Ge),n.domElement.removeEventListener("pointerup",Ie),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",It)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const o=1e-6,a=new C2,l=new C2;let c=1;const u=new D;let h=!1;const d=new ne,f=new ne,p=new ne,m=new ne,g=new ne,y=new ne,_=new ne,v=new ne,x=new ne,b=[],S={};function w(){return Math.pow(.95,n.zoomSpeed)}function T(R){l.theta-=R}function I(R){l.phi-=R}const k=function(){const R=new D;return function(Ce,Te){R.setFromMatrixColumn(Te,0),R.multiplyScalar(-Ce),u.add(R)}}(),W=function(){const R=new D;return function(Ce,Te){!0===n.screenSpacePanning?R.setFromMatrixColumn(Te,1):(R.setFromMatrixColumn(Te,0),R.crossVectors(n.object.up,R)),R.multiplyScalar(Ce),u.add(R)}}(),$=function(){const R=new D;return function(Ce,Te){const B=n.domElement;if(n.object.isPerspectiveCamera){R.copy(n.object.position).sub(n.target);let Me=R.length();Me*=Math.tan(n.object.fov/2*Math.PI/180),k(2*Ce*Me/B.clientHeight,n.object.matrix),W(2*Te*Me/B.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(k(Ce*(n.object.right-n.object.left)/n.object.zoom/B.clientWidth,n.object.matrix),W(Te*(n.object.top-n.object.bottom)/n.object.zoom/B.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function N(R){n.object.isPerspectiveCamera?c/=R:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*R)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function G(R){n.object.isPerspectiveCamera?c*=R:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/R)),n.object.updateProjectionMatrix(),h=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function F(R){d.set(R.clientX,R.clientY)}function V(R){m.set(R.clientX,R.clientY)}function ce(){1===b.length?d.set(b[0].pageX,b[0].pageY):d.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function De(){1===b.length?m.set(b[0].pageX,b[0].pageY):m.set(.5*(b[0].pageX+b[1].pageX),.5*(b[0].pageY+b[1].pageY))}function K(){const R=b[0].pageX-b[1].pageX,ue=b[0].pageY-b[1].pageY,Ce=Math.sqrt(R*R+ue*ue);_.set(0,Ce)}function $e(R){if(1==b.length)f.set(R.pageX,R.pageY);else{const Ce=Je(R);f.set(.5*(R.pageX+Ce.x),.5*(R.pageY+Ce.y))}p.subVectors(f,d).multiplyScalar(n.rotateSpeed);const ue=n.domElement;T(2*Math.PI*p.x/ue.clientHeight),I(2*Math.PI*p.y/ue.clientHeight),d.copy(f)}function ye(R){if(1===b.length)g.set(R.pageX,R.pageY);else{const ue=Je(R);g.set(.5*(R.pageX+ue.x),.5*(R.pageY+ue.y))}y.subVectors(g,m).multiplyScalar(n.panSpeed),$(y.x,y.y),m.copy(g)}function Ke(R){const ue=Je(R),Ce=R.pageX-ue.x,Te=R.pageY-ue.y,B=Math.sqrt(Ce*Ce+Te*Te);v.set(0,B),x.set(0,Math.pow(v.y/_.y,n.zoomSpeed)),N(x.y),_.copy(v)}function xe(R){!1!==n.enabled&&(0===b.length&&(n.domElement.setPointerCapture(R.pointerId),n.domElement.addEventListener("pointermove",Ge),n.domElement.addEventListener("pointerup",Ie)),function me(R){b.push(R)}(R),"touch"===R.pointerType?function O(R){switch(Re(R),b.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;ce(),s=r.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;De(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function He(){n.enableZoom&&K(),n.enablePan&&De()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function Be(){n.enableZoom&&K(),n.enableRotate&&ce()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent($w)}(R):function Qe(R){let ue;switch(R.button){case 0:ue=n.mouseButtons.LEFT;break;case 1:ue=n.mouseButtons.MIDDLE;break;case 2:ue=n.mouseButtons.RIGHT;break;default:ue=-1}switch(ue){case 1:if(!1===n.enableZoom)return;(function z(R){_.set(R.clientX,R.clientY)})(R),s=r.DOLLY;break;case 0:if(R.ctrlKey||R.metaKey||R.shiftKey){if(!1===n.enablePan)return;V(R),s=r.PAN}else{if(!1===n.enableRotate)return;F(R),s=r.ROTATE}break;case 2:if(R.ctrlKey||R.metaKey||R.shiftKey){if(!1===n.enableRotate)return;F(R),s=r.ROTATE}else{if(!1===n.enablePan)return;V(R),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent($w)}(R))}function Ge(R){!1!==n.enabled&&("touch"===R.pointerType?function A(R){switch(Re(R),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;$e(R),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;ye(R),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function se(R){n.enableZoom&&Ke(R),n.enablePan&&ye(R)})(R),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function oe(R){n.enableZoom&&Ke(R),n.enableRotate&&$e(R)})(R),n.update();break;default:s=r.NONE}}(R):function Ze(R){if(!1!==n.enabled)switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function U(R){f.set(R.clientX,R.clientY),p.subVectors(f,d).multiplyScalar(n.rotateSpeed);const ue=n.domElement;T(2*Math.PI*p.x/ue.clientHeight),I(2*Math.PI*p.y/ue.clientHeight),d.copy(f),n.update()}(R);break;case r.DOLLY:if(!1===n.enableZoom)return;!function j(R){v.set(R.clientX,R.clientY),x.subVectors(v,_),x.y>0?N(w()):x.y<0&&G(w()),_.copy(v),n.update()}(R);break;case r.PAN:if(!1===n.enablePan)return;!function te(R){g.set(R.clientX,R.clientY),y.subVectors(g,m).multiplyScalar(n.panSpeed),$(y.x,y.y),m.copy(g),n.update()}(R)}}(R))}function Ie(R){be(R),0===b.length&&(n.domElement.releasePointerCapture(R.pointerId),n.domElement.removeEventListener("pointermove",Ge),n.domElement.removeEventListener("pointerup",Ie)),n.dispatchEvent(H2),s=r.NONE}function rt(R){be(R)}function Ot(R){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(R.preventDefault(),n.dispatchEvent($w),function Q(R){R.deltaY<0?G(w()):R.deltaY>0&&N(w()),n.update()}(R),n.dispatchEvent(H2))}function It(R){!1===n.enabled||!1===n.enablePan||function he(R){let ue=!1;switch(R.code){case n.keys.UP:$(0,n.keyPanSpeed),ue=!0;break;case n.keys.BOTTOM:$(0,-n.keyPanSpeed),ue=!0;break;case n.keys.LEFT:$(n.keyPanSpeed,0),ue=!0;break;case n.keys.RIGHT:$(-n.keyPanSpeed,0),ue=!0}ue&&(R.preventDefault(),n.update())}(R)}function ee(R){!1!==n.enabled&&R.preventDefault()}function be(R){delete S[R.pointerId];for(let ue=0;ue<b.length;ue++)if(b[ue].pointerId==R.pointerId)return void b.splice(ue,1)}function Re(R){let ue=S[R.pointerId];void 0===ue&&(ue=new ne,S[R.pointerId]=ue),ue.set(R.pageX,R.pageY)}function Je(R){return S[(R.pointerId===b[0].pointerId?b[1]:b[0]).pointerId]}n.domElement.addEventListener("contextmenu",ee),n.domElement.addEventListener("pointerdown",xe),n.domElement.addEventListener("pointercancel",rt),n.domElement.addEventListener("wheel",Ot,{passive:!1}),this.update()}}class _Y extends qo{constructor(e){super(e)}load(e,t,n,r){const s=this,o=""===this.path?gs.extractUrlBase(e):this.path,a=new fr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{t(s.parse(l,o))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const n=e.split("\n");let r={};const s=/\s+/,o={};for(let l=0;l<n.length;l++){let c=n[l];if(c=c.trim(),0===c.length||"#"===c.charAt(0))continue;const u=c.indexOf(" ");let h=u>=0?c.substring(0,u):c;h=h.toLowerCase();let d=u>=0?c.substring(u+1):"";if(d=d.trim(),"newmtl"===h)r={name:d},o[d]=r;else if("ka"===h||"kd"===h||"ks"===h||"ke"===h){const f=d.split(s,3);r[h]=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])]}else r[h]=d}const a=new vY(this.resourcePath||t,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(o),a}}class vY{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=void 0!==this.options.side?this.options.side:0,this.wrap=void 0!==this.options.wrap?this.options.wrap:Fo}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const n in e){const r=e[n],s={};t[n]=s;for(const o in r){let a=!0,l=r[o];const c=o.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(l=[l[0]/255,l[1]/255,l[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===l[0]&&0===l[1]&&0===l[2]&&(a=!1)}a&&(s[c]=l)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,n=this.materialsInfo[e],r={name:e,side:this.side};function o(a,l){if(r[a])return;const c=t.getTextureParams(l,r),u=t.loadTexture(function s(a,l){return"string"!=typeof l||""===l?"":/^https?:\/\//i.test(l)?l:a+l}(t.baseUrl,c.url));u.repeat.copy(c.scale),u.offset.copy(c.offset),u.wrapS=t.wrap,u.wrapT=t.wrap,("map"===a||"emissiveMap"===a)&&(u.encoding=Pt),r[a]=u}for(const a in n){const l=n[a];let c;if(""!==l)switch(a.toLowerCase()){case"kd":r.color=(new we).fromArray(l).convertSRGBToLinear();break;case"ks":r.specular=(new we).fromArray(l).convertSRGBToLinear();break;case"ke":r.emissive=(new we).fromArray(l).convertSRGBToLinear();break;case"map_kd":o("map",l);break;case"map_ks":o("specularMap",l);break;case"map_ke":o("emissiveMap",l);break;case"norm":o("normalMap",l);break;case"map_bump":case"bump":o("bumpMap",l);break;case"map_d":o("alphaMap",l),r.transparent=!0;break;case"ns":r.shininess=parseFloat(l);break;case"d":c=parseFloat(l),c<1&&(r.opacity=c,r.transparent=!0);break;case"tr":c=parseFloat(l),this.options&&this.options.invertTrProperty&&(c=1-c),c>0&&(r.opacity=1-c,r.transparent=!0)}}return this.materials[e]=new _g(r),this.materials[e]}getTextureParams(e,t){const n={scale:new ne(1,1),offset:new ne(0,0)},r=e.split(/\s+/);let s;return s=r.indexOf("-bm"),s>=0&&(t.bumpScale=parseFloat(r[s+1]),r.splice(s,2)),s=r.indexOf("-s"),s>=0&&(n.scale.set(parseFloat(r[s+1]),parseFloat(r[s+2])),r.splice(s,4)),s=r.indexOf("-o"),s>=0&&(n.offset.set(parseFloat(r[s+1]),parseFloat(r[s+2])),r.splice(s,4)),n.url=r.join(" ").trim(),n}loadTexture(e,t,n,r,s){const o=void 0!==this.manager?this.manager:l2;let a=o.getHandler(e);null===a&&(a=new xg(o)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const l=a.load(e,n,r,s);return void 0!==t&&(l.mapping=t),l}}const xY=/^[og]\s*(.+)?/,wY=/^mtllib /,bY=/^usemtl /,MY=/^usemap /,G2=new D,Xw=new D,W2=new D,j2=new D,pr=new D,Ag=new we;function SY(){const i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);const n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:void 0!==o?o.smooth:this.smooth,groupStart:void 0!==o?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(l){const c={index:"number"==typeof l?l:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return c.clone=this.clone.bind(c),c}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){const s=this.currentMaterial();if(s&&-1===s.groupEnd&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),s}},n&&n.name&&"function"==typeof n.clone){const r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseNormalIndex:function(e,t){const n=parseInt(e,10);return 3*(n>=0?n-1:n+t/3)},parseUVIndex:function(e,t){const n=parseInt(e,10);return 2*(n>=0?n-1:n+t/2)},addVertex:function(e,t,n){const r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){const r=this.vertices,s=this.object.geometry.normals;G2.fromArray(r,e),Xw.fromArray(r,t),W2.fromArray(r,n),pr.subVectors(W2,Xw),j2.subVectors(G2,Xw),pr.cross(j2),pr.normalize(),s.push(pr.x,pr.y,pr.z),s.push(pr.x,pr.y,pr.z),s.push(pr.x,pr.y,pr.z)},addColor:function(e,t,n){const r=this.colors,s=this.object.geometry.colors;void 0!==r[e]&&s.push(r[e+0],r[e+1],r[e+2]),void 0!==r[t]&&s.push(r[t+0],r[t+1],r[t+2]),void 0!==r[n]&&s.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){const r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[n+0],r[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,s,o,a,l,c){const u=this.vertices.length;let h=this.parseVertexIndex(e,u),d=this.parseVertexIndex(t,u),f=this.parseVertexIndex(n,u);if(this.addVertex(h,d,f),this.addColor(h,d,f),void 0!==a&&""!==a){const p=this.normals.length;h=this.parseNormalIndex(a,p),d=this.parseNormalIndex(l,p),f=this.parseNormalIndex(c,p),this.addNormal(h,d,f)}else this.addFaceNormal(h,d,f);if(void 0!==r&&""!==r){const p=this.uvs.length;h=this.parseUVIndex(r,p),d=this.parseUVIndex(s,p),f=this.parseUVIndex(o,p),this.addUV(h,d,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){const s=this.parseVertexIndex(e[n],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],n));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return i.startObject("",!1),i}class EY extends qo{constructor(e){super(e),this.materials=null}load(e,t,n,r){const s=this,o=new fr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setMaterials(e){return this.materials=e,this}parse(e){const t=new SY;-1!==e.indexOf("\r\n")&&(e=e.replace(/\r\n/g,"\n")),-1!==e.indexOf("\\\n")&&(e=e.replace(/\\\n/g,""));const n=e.split("\n");let r="",s="",o=0,a=[];const l="function"==typeof"".trimLeft;for(let h=0,d=n.length;h<d;h++)if(r=n[h],r=l?r.trimLeft():r.trim(),o=r.length,0!==o&&(s=r.charAt(0),"#"!==s))if("v"===s){const f=r.split(/\s+/);switch(f[0]){case"v":t.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7?(Ag.setRGB(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6])).convertSRGBToLinear(),t.colors.push(Ag.r,Ag.g,Ag.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":t.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===s){const p=r.slice(1).trim().split(/\s+/),m=[];for(let y=0,_=p.length;y<_;y++){const v=p[y];if(v.length>0){const x=v.split("/");m.push(x)}}const g=m[0];for(let y=1,_=m.length-1;y<_;y++){const v=m[y],x=m[y+1];t.addFace(g[0],v[0],x[0],g[1],v[1],x[1],g[2],v[2],x[2])}}else if("l"===s){const f=r.substring(1).trim().split(" ");let p=[];const m=[];if(-1===r.indexOf("/"))p=f;else for(let g=0,y=f.length;g<y;g++){const _=f[g].split("/");""!==_[0]&&p.push(_[0]),""!==_[1]&&m.push(_[1])}t.addLineGeometry(p,m)}else if("p"===s){const p=r.slice(1).trim().split(" ");t.addPointGeometry(p)}else if(null!==(a=xY.exec(r))){const f=(" "+a[0].slice(1).trim()).slice(1);t.startObject(f)}else if(bY.test(r))t.object.startMaterial(r.substring(7).trim(),t.materialLibraries);else if(wY.test(r))t.materialLibraries.push(r.substring(7).trim());else if(MY.test(r))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===s){if(a=r.split(" "),a.length>1){const p=a[1].trim().toLowerCase();t.object.smooth="0"!==p&&"off"!==p}else t.object.smooth=!0;const f=t.object.currentMaterial();f&&(f.smooth=t.object.smooth)}else{if("\0"===r)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+r+'"')}t.finalize();const c=new fs;if(c.materialLibraries=[].concat(t.materialLibraries),1==!(1===t.objects.length&&0===t.objects[0].geometry.vertices.length))for(let h=0,d=t.objects.length;h<d;h++){const f=t.objects[h],p=f.geometry,m=f.materials,g="Line"===p.type,y="Points"===p.type;let _=!1;if(0===p.vertices.length)continue;const v=new lt;v.setAttribute("position",new ke(p.vertices,3)),p.normals.length>0&&v.setAttribute("normal",new ke(p.normals,3)),p.colors.length>0&&(_=!0,v.setAttribute("color",new ke(p.colors,3))),!0===p.hasUVIndices&&v.setAttribute("uv",new ke(p.uvs,2));const x=[];for(let S=0,E=m.length;S<E;S++){const w=m[S],T=w.name+"_"+w.smooth+"_"+_;let I=t.materials[T];if(null!==this.materials)if(I=this.materials.create(w.name),!g||!I||I instanceof zn){if(y&&I&&!(I instanceof tl)){const k=new tl({size:10,sizeAttenuation:!1});un.prototype.copy.call(k,I),k.color.copy(I.color),k.map=I.map,I=k}}else{const k=new zn;un.prototype.copy.call(k,I),k.color.copy(I.color),I=k}void 0===I&&(I=g?new zn:y?new tl({size:1,sizeAttenuation:!1}):new _g,I.name=w.name,I.flatShading=!w.smooth,I.vertexColors=_,t.materials[T]=I),x.push(I)}let b;if(x.length>1){for(let S=0,E=m.length;S<E;S++){const w=m[S];v.addGroup(w.groupStart,w.groupCount,S)}b=g?new ad(v,x):y?new ld(v,x):new kn(v,x)}else b=g?new ad(v,x[0]):y?new ld(v,x[0]):new kn(v,x[0]);b.name=f.name,c.add(b)}else if(t.vertices.length>0){const h=new tl({size:1,sizeAttenuation:!1}),d=new lt;d.setAttribute("position",new ke(t.vertices,3)),t.colors.length>0&&void 0!==t.colors[0]&&(d.setAttribute("color",new ke(t.colors,3)),h.vertexColors=!0);const f=new ld(d,h);c.add(f)}return c}}class CY extends qo{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new RY(t)}),this.register(function(t){return new BY(t)}),this.register(function(t){return new zY(t)}),this.register(function(t){return new LY(t)}),this.register(function(t){return new FY(t)}),this.register(function(t){return new OY(t)}),this.register(function(t){return new NY(t)}),this.register(function(t){return new IY(t)}),this.register(function(t){return new kY(t)}),this.register(function(t){return new PY(t)}),this.register(function(t){return new AY(t)}),this.register(function(t){return new UY(t)})}load(e,t,n,r){const s=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:gs.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new fr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(u){t(u),s.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const o={},a={};if("string"==typeof e)s=e;else if(gs.decodeText(new Uint8Array(e,0,4))===q2){try{o[wt.KHR_BINARY_GLTF]=new VY(e)}catch(h){return void(r&&r(h))}s=o[wt.KHR_BINARY_GLTF].content}else s=gs.decodeText(new Uint8Array(e));const l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new eK(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const h=this.pluginCallbacks[u](c);a[h.name]=h,o[h.name]=!0}if(l.extensionsUsed)for(let u=0;u<l.extensionsUsed.length;++u){const h=l.extensionsUsed[u],d=l.extensionsRequired||[];switch(h){case wt.KHR_MATERIALS_UNLIT:o[h]=new DY;break;case wt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[h]=new WY;break;case wt.KHR_DRACO_MESH_COMPRESSION:o[h]=new HY(l,this.dracoLoader);break;case wt.KHR_TEXTURE_TRANSFORM:o[h]=new GY;break;case wt.KHR_MESH_QUANTIZATION:o[h]=new jY;break;default:d.indexOf(h)>=0&&void 0===a[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function TY(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const wt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class AY{constructor(e){this.parser=e,this.name=wt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const u=new we(16777215);void 0!==l.color&&u.fromArray(l.color);const h=void 0!==l.range?l.range:0;switch(l.type){case"directional":c=new Md(u),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new p2(u),c.distance=h;break;case"spot":c=new d2(u),c.distance=h,l.spot=l.spot||{},l.spot.innerConeAngle=void 0!==l.spot.innerConeAngle?l.spot.innerConeAngle:0,l.spot.outerConeAngle=void 0!==l.spot.outerConeAngle?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,void 0!==l.intensity&&(c.intensity=l.intensity),c.name=t.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then(function(l){return n._getNodeRef(t.cache,a,l)})}}class DY{constructor(){this.name=wt.KHR_MATERIALS_UNLIT}getMaterialType(){return Di}extendParams(e,t,n){const r=[];e.color=new we(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,Pt))}return Promise.all(r)}}class IY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class RY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){const a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new ne(a,a)}return Promise.all(s)}}class PY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.iridescenceFactor&&(t.iridescence=o.iridescenceFactor),void 0!==o.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),void 0!==o.iridescenceIor&&(t.iridescenceIOR=o.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==o.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),void 0!==o.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),void 0!==o.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class LY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new we(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=r.extensions[this.name];return void 0!==o.sheenColorFactor&&t.sheenColor.fromArray(o.sheenColorFactor),void 0!==o.sheenRoughnessFactor&&(t.sheenRoughness=o.sheenRoughnessFactor),void 0!==o.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Pt)),void 0!==o.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class FY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return void 0!==o.transmissionFactor&&(t.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class OY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.thickness=void 0!==o.thicknessFactor?o.thicknessFactor:0,void 0!==o.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||0;const a=o.attenuationColor||[1,1,1];return t.attenuationColor=new we(a[0],a[1],a[2]),Promise.all(s)}}class NY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class kY{constructor(e){this.parser=e,this.name=wt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?jo:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];t.specularIntensity=void 0!==o.specularFactor?o.specularFactor:1,void 0!==o.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return t.specularColor=new we(a[0],a[1],a[2]),void 0!==o.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Pt)),Promise.all(s)}}class BY{constructor(e){this.parser=e,this.name=wt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class zY{constructor(e){this.parser=e,this.name=wt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],a=r.images[o.source];let l=n.textureLoader;if(a.uri){const c=n.options.manager.getHandler(a.uri);null!==c&&(l=c)}return this.detectSupport().then(function(c){if(c)return n.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class UY{constructor(e){this.name=wt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,o.ready]).then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,u=r.count,h=r.byteStride,d=new ArrayBuffer(u*h),f=new Uint8Array(a[0],l,c);return o.decodeGltfBuffer(new Uint8Array(d),u,h,f,r.mode,r.filter),d})}return null}}const q2="glTF";class VY{constructor(e){this.name=wt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:gs.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==q2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const o=r.getUint32(s,!0);s+=4;const a=r.getUint32(s,!0);if(s+=4,1313821514===a){const l=new Uint8Array(e,12+s,o);this.content=gs.decodeText(l)}else if(5130562===a){const l=12+s;this.body=e.slice(l,l+o)}s+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class HY{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=wt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const u in o){const h=Kw[u]||u.toLowerCase();a[h]=o[u]}for(const u in e.attributes){const h=Kw[u]||u.toLowerCase();if(void 0!==o[u]){const d=n.accessors[e.attributes[u]];c[h]=Ed[d.componentType],l[h]=!0===d.normalized}}return t.getDependency("bufferView",s).then(function(u){return new Promise(function(h){r.decodeDracoFile(u,function(d){for(const f in d.attributes){const p=d.attributes[f],m=l[f];void 0!==m&&(p.normalized=m)}h(d)},a,c)})})}}class GY{constructor(){this.name=wt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Zw extends yd{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new we).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(l){for(const c in a)l.uniforms[c]=a[c];l.fragmentShader=l.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(l){a.specular.value=l}},specularMap:{get:function(){return a.specularMap.value},set:function(l){a.specularMap.value=l,l?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(l){a.glossiness.value=l}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(l){a.glossinessMap.value=l,l?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class WY{constructor(){this.name=wt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return Zw}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new we(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&s.push(n.assignTexture(e,"map",r.diffuseTexture,Pt)),e.emissive=new we(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new we(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const o=r.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",o)),s.push(n.assignTexture(e,"specularMap",o,Pt))}return Promise.all(s)}createMaterial(e){const t=new Zw(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=0,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t}}class jY{constructor(){this.name=wt.KHR_MESH_QUANTIZATION}}class Yw extends _d{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)t[o]=n[s+o];return t}}Yw.prototype.interpolate_=function(i,e,t,n){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=n-e,u=(t-e)/c,h=u*u,d=h*u,f=i*l,p=f-l,m=-2*d+3*h,g=d-h,y=1-m,_=g-h+u;for(let v=0;v!==o;v++)r[v]=y*s[p+v+o]+_*(s[p+v+a]*c)+m*s[f+v+o]+g*(s[f+v]*c);return r};const qY=new oi;class $Y extends Yw{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return qY.fromArray(s).normalize().toArray(s),s}}const Ed={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},X2={9728:pn,9729:Kt,9984:1004,9985:1007,9986:1005,9987:Oo},Z2={33071:gi,33648:1002,10497:Fo},Y2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Kw={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Xo={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},XY={CUBICSPLINE:void 0,LINEAR:wc,STEP:jh};function Cd(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function ll(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function KY(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function QY(i){const e=i.extensions&&i.extensions[wt.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+K2(e.attributes):i.indices+":"+K2(i.attributes)+":"+i.mode,t}function K2(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function Jw(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class eK{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new TY,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;this.textureLoader="undefined"==typeof createImageBitmap||n||r&&s<98?new xg(this.options.manager):new eY(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new fr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:n,userData:{}};Cd(s,a,r),ll(a,r),Promise.all(n._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const o=t[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];void 0!==o.mesh&&(this._addNodeRef(this.meshCache,o.mesh),void 0!==o.skin&&(n[o.mesh].isSkinnedMesh=!0)),void 0!==o.camera&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(o,a)=>{const l=this.associations.get(o);null!=l&&this.associations.set(a,l);for(const[c,u]of o.children.entries())s(u,a.children[c])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[wt.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){n.load(gs.resolveURL(t.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=Y2[r.type],c=Ed[r.componentType],u=c.BYTES_PER_ELEMENT,d=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;let m,g;if(f&&f!==u*l){const y=Math.floor(d/f),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+y+":"+r.count;let v=t.cache.get(_);v||(m=new c(a,y*f,r.count*f/u),v=new Mw(m,f/u),t.cache.add(_,v)),g=new Ja(v,l,d%f/u,p)}else m=null===a?new c(r.count*l):new c(a,d,r.count*l),g=new Sn(m,l,p);if(void 0!==r.sparse){const x=r.sparse.values.byteOffset||0,b=new(0,Ed[r.sparse.indices.componentType])(o[1],r.sparse.indices.byteOffset||0,r.sparse.count*Y2.SCALAR),S=new c(o[2],x,r.sparse.count*l);null!==a&&(g=new Sn(g.array.slice(),g.itemSize,g.normalized));for(let E=0,w=b.length;E<w;E++){const T=b[E];if(g.setX(T,S[E*l]),l>=2&&g.setY(T,S[E*l+1]),l>=3&&g.setZ(T,S[E*l+2]),l>=4&&g.setW(T,S[E*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const t=this.json,s=t.textures[e].source,o=t.images[s];let a=this.textureLoader;if(o.uri){const l=this.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,t,n){const r=this,s=this.json,o=s.textures[e],a=s.images[t],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(t,n).then(function(u){u.flipY=!1,o.name&&(u.name=o.name);const d=(s.samplers||{})[o.sampler]||{};return u.magFilter=X2[d.magFilter]||Kt,u.minFilter=X2[d.minFilter]||Oo,u.wrapS=Z2[d.wrapS]||Fo,u.wrapT=Z2[d.wrapT]||Fo,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(h=>h.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(void 0!==o.bufferView)l=this.getDependency("bufferView",o.bufferView).then(function(h){c=!0;const d=new Blob([h],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(void 0===o.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const u=Promise.resolve(l).then(function(h){return new Promise(function(d,f){let p=d;!0===t.isImageBitmapLoader&&(p=function(m){const g=new hr(m);g.needsUpdate=!0,d(g)}),t.load(gs.resolveURL(h,s.path),p,void 0,f)})}).then(function(h){return!0===c&&a.revokeObjectURL(l),h.userData.mimeType=o.mimeType||function JY(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(o.uri),h}).catch(function(h){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),h});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(o){if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[wt.KHR_TEXTURE_TRANSFORM]){const a=void 0!==n.extensions?n.extensions[wt.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[wt.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return void 0!==r&&(o.encoding=r),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal;if(e.isPoints){const a="PointsMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new tl,un.prototype.copy.call(l,n),l.color.copy(n.color),l.map=n.map,l.sizeAttenuation=!1,this.cache.add(a,l)),n=l}else if(e.isLine){const a="LineBasicMaterial:"+n.uuid;let l=this.cache.get(a);l||(l=new zn,un.prototype.copy.call(l,n),l.color.copy(n.color),this.cache.add(a,l)),n=l}if(r||s||o){let a="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(a+="specular-glossiness:"),r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=n.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(n))),n=l}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return yd}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[wt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const h=r[wt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else if(l[wt.KHR_MATERIALS_UNLIT]){const h=r[wt.KHR_MATERIALS_UNLIT];o=h.getMaterialType(),c.push(h.extendParams(a,s,t))}else{const h=s.pbrMetallicRoughness||{};if(a.color=new we(1,1,1),a.opacity=1,Array.isArray(h.baseColorFactor)){const d=h.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}void 0!==h.baseColorTexture&&c.push(t.assignTexture(a,"map",h.baseColorTexture,Pt)),a.metalness=void 0!==h.metallicFactor?h.metallicFactor:1,a.roughness=void 0!==h.roughnessFactor?h.roughnessFactor:1,void 0!==h.metallicRoughnessTexture&&(c.push(t.assignTexture(a,"metalnessMap",h.metallicRoughnessTexture)),c.push(t.assignTexture(a,"roughnessMap",h.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}!0===s.doubleSided&&(a.side=2);const u=s.alphaMode||"OPAQUE";if("BLEND"===u?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===u&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&o!==Di&&(c.push(t.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new ne(1,1),void 0!==s.normalTexture.scale)){const h=s.normalTexture.scale;a.normalScale.set(h,h)}return void 0!==s.occlusionTexture&&o!==Di&&(c.push(t.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&o!==Di&&(a.emissive=(new we).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&o!==Di&&c.push(t.assignTexture(a,"emissiveMap",s.emissiveTexture,Pt)),Promise.all(c).then(function(){let h;return h=o===Zw?r[wt.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new o(a),s.name&&(h.name=s.name),ll(h,s),t.associations.set(h,{materials:e}),s.extensions&&Cd(r,h,s),h})}createUniqueName(e){const t=jt.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(a){return n[wt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(l){return J2(l,a,t)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],u=QY(c),h=r[u];if(h)o.push(h.promise);else{let d;d=c.extensions&&c.extensions[wt.KHR_DRACO_MESH_COMPRESSION]?s(c):J2(new lt,c,t),r[u]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const u=void 0===o[l].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new yd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),i.DefaultMaterial):this.getDependency("material",o[l].material);a.push(u)}var i;return a.push(t.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),u=l[l.length-1],h=[];for(let f=0,p=u.length;f<p;f++){const m=u[f],g=o[f];let y;const _=c[f];if(4===g.mode||5===g.mode||6===g.mode||void 0===g.mode)y=!0===s.isSkinnedMesh?new FP(m,_):new kn(m,_),!0===y.isSkinnedMesh&&!y.geometry.attributes.skinWeight.normalized&&y.normalizeSkinWeights(),5===g.mode?y.geometry=eL(y.geometry,1):6===g.mode&&(y.geometry=eL(y.geometry,2));else if(1===g.mode)y=new ad(m,_);else if(3===g.mode)y=new el(m,_);else if(2===g.mode)y=new GP(m,_);else{if(0!==g.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);y=new ld(m,_)}Object.keys(y.geometry.morphAttributes).length>0&&KY(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),ll(y,s),g.extensions&&Cd(r,y,g),t.assignFinalMaterial(y),h.push(y)}for(let f=0,p=h.length;f<p;f++)t.associations.set(h[f],{meshes:e,primitives:f});if(1===h.length)return h[0];const d=new fs;t.associations.set(d,{meshes:e});for(let f=0,p=h.length;f<p;f++)d.add(h[f]);return d})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new Bn(C9.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Uc(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ll(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return n.inverseBindMatrices=r,n})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],o=[],a=[],l=[];for(let c=0,u=n.channels.length;c<u;c++){const h=n.channels[c],d=n.samplers[h.sampler],f=h.target,m=void 0!==n.parameters?n.parameters[d.input]:d.input,g=void 0!==n.parameters?n.parameters[d.output]:d.output;r.push(this.getDependency("node",void 0!==f.node?f.node:f.id)),s.push(this.getDependency("accessor",m)),o.push(this.getDependency("accessor",g)),a.push(d),l.push(f)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const u=c[0],h=c[1],d=c[2],f=c[3],p=c[4],m=[];for(let y=0,_=u.length;y<_;y++){const v=u[y],x=h[y],b=d[y],S=f[y],E=p[y];if(void 0===v)continue;let w;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,Xo[E.path]){case Xo.weights:w=vd;break;case Xo.rotation:w=nl;break;default:w=xd}const T=v.name?v.name:v.uuid,I=void 0!==S.interpolation?XY[S.interpolation]:wc,k=[];Xo[E.path]===Xo.weights?v.traverse(function($){$.morphTargetInfluences&&k.push($.name?$.name:$.uuid)}):k.push(T);let W=b.array;if(b.normalized){const $=Jw(W.constructor),N=new Float32Array(W.length);for(let G=0,F=W.length;G<F;G++)N[G]=W[G]*$;W=N}for(let $=0,N=k.length;$<N;$++){const G=new w(k[$]+"."+Xo[E.path],x.array,W,I);"CUBICSPLINE"===S.interpolation&&(G.createInterpolant=function(z){return new(this instanceof nl?$Y:Yw)(this.times,this.values,this.getValueSize()/3,z)},G.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),m.push(G)}}return new wd(n.name?n.name:"animation_"+e,void 0,m)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const o=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],o=s.name?r.createUniqueName(s.name):"";return function(){const a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),void 0!==s.camera&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),Promise.all(a)}().then(function(a){let l;if(l=!0===s.isBone?new Ew:a.length>1?new fs:1===a.length?a[0]:new sn,l!==a[0])for(let c=0,u=a.length;c<u;c++)l.add(a[c]);if(s.name&&(l.userData.name=s.name,l.name=o),ll(l,s),s.extensions&&Cd(n,l,s),void 0!==s.matrix){const c=new ft;c.fromArray(s.matrix),l.applyMatrix4(c)}else void 0!==s.translation&&l.position.fromArray(s.translation),void 0!==s.rotation&&l.quaternion.fromArray(s.rotation),void 0!==s.scale&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l})}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],s=this,o=new fs;r.name&&(o.name=s.createUniqueName(r.name)),ll(o,r),r.extensions&&Cd(n,o,r);const a=r.nodes||[],l=[];for(let c=0,u=a.length;c<u;c++)l.push(Q2(a[c],o,t,s));return Promise.all(l).then(function(){return s.associations=(u=>{const h=new Map;for(const[d,f]of s.associations)(d instanceof un||d instanceof hr)&&h.set(d,f);return u.traverse(d=>{const f=s.associations.get(d);null!=f&&h.set(d,f)}),h})(o),o})}}function Q2(i,e,t,n){const r=t.nodes[i];return n.getDependency("node",i).then(function(s){if(void 0===r.skin)return s;let o;return n.getDependency("skin",r.skin).then(function(a){o=a;const l=[];for(let c=0,u=o.joints.length;c<u;c++)l.push(n.getDependency("node",o.joints[c]));return Promise.all(l)}).then(function(a){return s.traverse(function(l){if(!l.isMesh)return;const c=[],u=[];for(let h=0,d=a.length;h<d;h++){const f=a[h];if(f){c.push(f);const p=new ft;void 0!==o.inverseBindMatrices&&p.fromArray(o.inverseBindMatrices.array,16*h),u.push(p)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',o.joints[h])}l.bind(new $m(c,u),l.matrixWorld)}),s})}).then(function(s){e.add(s);const o=[];if(r.children){const a=r.children;for(let l=0,c=a.length;l<c;l++)o.push(Q2(a[l],s,t,n))}return Promise.all(o)})}function J2(i,e,t){const n=e.attributes,r=[];function s(o,a){return t.getDependency("accessor",o).then(function(l){i.setAttribute(a,l)})}for(const o in n){const a=Kw[o]||o.toLowerCase();a in i.attributes||r.push(s(n[o],a))}if(void 0!==e.indices&&!i.index){const o=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(o)}return ll(i,e),function tK(i,e,t){const n=e.attributes,r=new Hs;if(void 0===n.POSITION)return;{const a=t.json.accessors[n.POSITION],l=a.min,c=a.max;if(void 0===l||void 0===c)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new D(l[0],l[1],l[2]),new D(c[0],c[1],c[2])),a.normalized){const u=Jw(Ed[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}const s=e.targets;if(void 0!==s){const a=new D,l=new D;for(let c=0,u=s.length;c<u;c++){const h=s[c];if(void 0!==h.POSITION){const d=t.json.accessors[h.POSITION],f=d.min,p=d.max;if(void 0!==f&&void 0!==p){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const m=Jw(Ed[d.componentType]);l.multiplyScalar(m)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;const o=new Xa;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=o}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function YY(i,e,t){let n=!1,r=!1,s=!1;for(let c=0,u=e.length;c<u;c++){const h=e[c];if(void 0!==h.POSITION&&(n=!0),void 0!==h.NORMAL&&(r=!0),void 0!==h.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const o=[],a=[],l=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];if(n){const d=void 0!==h.POSITION?t.getDependency("accessor",h.POSITION):i.attributes.position;o.push(d)}if(r){const d=void 0!==h.NORMAL?t.getDependency("accessor",h.NORMAL):i.attributes.normal;a.push(d)}if(s){const d=void 0!==h.COLOR_0?t.getDependency("accessor",h.COLOR_0):i.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[1],d=c[2];return n&&(i.morphAttributes.position=c[0]),r&&(i.morphAttributes.normal=h),s&&(i.morphAttributes.color=d),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function eL(i,e){let t=i.getIndex();if(null===t){const o=[],a=i.getAttribute("position");if(void 0===a)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let l=0;l<a.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}const n=t.count-2,r=[];if(2===e)for(let o=1;o<=n;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2==0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}let nK=0;const Dg=i=>{const e=nK++;return t=>{i.loadingProgress.next({id:e,loaded:t.loaded,total:t.total})}};class iK{constructor(e,t){this.productConfiguratorService=e,this.environmentLoader=t}loadMesh(e){return new Promise(n=>{const r=e.filename.split("."),s=r[r.length-1].toLowerCase();let o;o="obj"===s?this.loadObj(e.filename,e.materialInfo):"gltf"===s?this.loadGlTF(e.filename,e.materialInfo):Promise.resolve(void 0),o.then(a=>{n({object:a,model:e})})})}loadMaterial(e,t){return ha(this,void 0,void 0,function*(){return new Promise(r=>{if(t.mtl)(new _Y).load(t.mtl,o=>{o.preload(),e.children.forEach(a=>{if(!a)return;const c=a.material.name;o.materials[c]&&(a.material=o.materials[c])}),t.renderBackface&&this.trySetBackfaceRendering([e]),r()});else{const s=new _g({}),o=new xg;t.diffuseTexture&&(s.map=o.load(t.diffuseTexture)),t.normalTexture&&(s.normalMap=o.load(t.normalTexture)),e.children.forEach(a=>{!a||(a.material=s)}),t.renderBackface&&this.trySetBackfaceRendering([e]),r()}})})}loadObj(e,t){return ha(this,void 0,void 0,function*(){return new Promise(r=>{(new EY).load(e,o=>ha(this,void 0,void 0,function*(){yield this.loadMaterial(o,t),this.setReceiveShadows([o]),r(o)}),Dg(this.productConfiguratorService))})})}loadGlTF(e,t){return ha(this,void 0,void 0,function*(){return new Promise(r=>{const s=new CY,a=this.environmentLoader.loadEnvironment("assets/models/pbr/Soft_4TubeBank_2BlackFlags.exr");s.load(e,l=>ha(this,void 0,void 0,function*(){a.then(c=>{const u=new fs;for(const h of l.scenes)u.add(...h.children);this.setReceiveShadows(u.children),this.trySetEnvironmentTexture(u.children,c),t.renderBackface&&this.trySetBackfaceRendering(u.children),r(u)})}),Dg(this.productConfiguratorService))})})}setReceiveShadows(e){for(const t of e)t.receiveShadow=!0,t.castShadow=!0,t.children&&this.setReceiveShadows(t.children)}trySetEnvironmentTexture(e,t){for(const n of e){const r=n;if(r.material){const s=r.material;s.envMap=t.texture,s.envMapIntensity=.0625,s.needsUpdate=!0}n.children&&this.trySetEnvironmentTexture(n.children,t)}}trySetBackfaceRendering(e){for(const t of e){const n=t;n.material&&(n.material.side=2),t.children&&this.trySetBackfaceRendering(t.children)}}}var tL={},eb=function(i){return URL.createObjectURL(new Blob([i],{type:"text/javascript"}))},nL=function(i){return new Worker(i)};try{URL.revokeObjectURL(eb(""))}catch(i){eb=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)},nL=function(e){return new Worker(e,{type:"module"})}}var St=Uint8Array,Un=Uint16Array,Ks=Uint32Array,tu=new St([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),nu=new St([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Td=new St([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iL=function(i,e){for(var t=new Un(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];var r=new Ks(t[30]);for(n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},rL=iL(tu,2),tb=rL[0],Ig=rL[1];tb[28]=258,Ig[258]=28;for(var sL=iL(nu,0),oL=sL[0],nb=sL[1],Ad=new Un(32768),Zt=0;Zt<32768;++Zt){var Zo=(43690&Zt)>>>1|(21845&Zt)<<1;Ad[Zt]=((65280&(Zo=(61680&(Zo=(52428&Zo)>>>2|(13107&Zo)<<2))>>>4|(3855&Zo)<<4))>>>8|(255&Zo)<<8)>>>1}var mr=function(i,e,t){for(var n=i.length,r=0,s=new Un(e);r<n;++r)++s[i[r]-1];var a,o=new Un(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;if(t){a=new Un(1<<e);var l=15-e;for(r=0;r<n;++r)if(i[r])for(var c=r<<4|i[r],u=e-i[r],h=o[i[r]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[Ad[h]>>>l]=c}else for(a=new Un(n),r=0;r<n;++r)i[r]&&(a[r]=Ad[o[i[r]-1]++]>>>15-i[r]);return a},Qs=new St(288);for(Zt=0;Zt<144;++Zt)Qs[Zt]=8;for(Zt=144;Zt<256;++Zt)Qs[Zt]=9;for(Zt=256;Zt<280;++Zt)Qs[Zt]=7;for(Zt=280;Zt<288;++Zt)Qs[Zt]=8;var iu=new St(32);for(Zt=0;Zt<32;++Zt)iu[Zt]=5;var aL=mr(Qs,9,0),lL=mr(Qs,9,1),cL=mr(iu,5,0),uL=mr(iu,5,1),Rg=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},gr=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(7&e)&t},Pg=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(7&e)},Dd=function(i){return(i/8|0)+(7&i&&1)},yr=function(i,e,t){(null==e||e<0)&&(e=0),(null==t||t>i.length)&&(t=i.length);var n=new(i instanceof Un?Un:i instanceof Ks?Ks:St)(t-e);return n.set(i.subarray(e,t)),n},Id=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new St(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new St(3*n));var o=function(K){var He=e.length;if(K>He){var Be=new St(Math.max(2*He,K));Be.set(e),e=Be}},a=t.f||0,l=t.p||0,c=t.b||0,u=t.l,h=t.d,d=t.m,f=t.n,p=8*n;do{if(!u){t.f=a=gr(i,l,1);var m=gr(i,l+1,3);if(l+=3,!m){var y=i[(g=Dd(l)+4)-4]|i[g-3]<<8,_=g+y;if(_>n){if(s)throw"unexpected EOF";break}r&&o(c+y),e.set(i.subarray(g,_),c),t.b=c+=y,t.p=l=8*_;continue}if(1==m)u=lL,h=uL,d=9,f=5;else{if(2!=m)throw"invalid block type";var v=gr(i,l,31)+257,x=gr(i,l+10,15)+4,b=v+gr(i,l+5,31)+1;l+=14;for(var S=new St(b),E=new St(19),w=0;w<x;++w)E[Td[w]]=gr(i,l+3*w,7);l+=3*x;var T=Rg(E),I=(1<<T)-1,k=mr(E,T,1);for(w=0;w<b;){var g,W=k[gr(i,l,I)];if(l+=15&W,(g=W>>>4)<16)S[w++]=g;else{var $=0,N=0;for(16==g?(N=3+gr(i,l,3),l+=2,$=S[w-1]):17==g?(N=3+gr(i,l,7),l+=3):18==g&&(N=11+gr(i,l,127),l+=7);N--;)S[w++]=$}}var G=S.subarray(0,v),F=S.subarray(v);d=Rg(G),f=Rg(F),u=mr(G,d,1),h=mr(F,f,1)}if(l>p){if(s)throw"unexpected EOF";break}}r&&o(c+131072);for(var z=(1<<d)-1,V=(1<<f)-1,U=l;;U=l){var j=($=u[Pg(i,l)&z])>>>4;if((l+=15&$)>p){if(s)throw"unexpected EOF";break}if(!$)throw"invalid length/literal";if(j<256)e[c++]=j;else{if(256==j){U=l,u=null;break}var te=j-254;j>264&&(te=gr(i,l,(1<<(Q=tu[w=j-257]))-1)+tb[w],l+=Q);var he=h[Pg(i,l)&V],ce=he>>>4;if(!he)throw"invalid distance";if(l+=15&he,F=oL[ce],ce>3){var Q=nu[ce];F+=Pg(i,l)&(1<<Q)-1,l+=Q}if(l>p){if(s)throw"unexpected EOF";break}r&&o(c+131072);for(var De=c+te;c<De;c+=4)e[c]=e[c-F],e[c+1]=e[c+1-F],e[c+2]=e[c+2-F],e[c+3]=e[c+3-F];c=De}}t.l=u,t.p=U,t.b=c,u&&(a=1,t.m=d,t.d=h,t.n=f)}while(!a);return c==e.length?e:yr(e,0,c)},ys=function(i,e,t){var n=e/8|0;i[n]|=t<<=7&e,i[n+1]|=t>>>8},ru=function(i,e,t){var n=e/8|0;i[n]|=t<<=7&e,i[n+1]|=t>>>8,i[n+2]|=t>>>16},Lg=function(i,e){for(var t=[],n=0;n<i.length;++n)i[n]&&t.push({s:n,f:i[n]});var r=t.length,s=t.slice();if(!r)return[Js,0];if(1==r){var o=new St(t[0].s+1);return o[t[0].s]=1,[o,1]}t.sort(function(b,S){return b.f-S.f}),t.push({s:-1,f:25001});var a=t[0],l=t[1],c=0,u=1,h=2;for(t[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=t[t[c].f<t[h].f?c++:h++],l=t[c!=u&&t[c].f<t[h].f?c++:h++],t[u++]={s:-1,f:a.f+l.f,l:a,r:l};var d=s[0].s;for(n=1;n<r;++n)s[n].s>d&&(d=s[n].s);var f=new Un(d+1),p=Fg(t[u-1],f,0);if(p>e){n=0;var m=0,g=p-e,y=1<<g;for(s.sort(function(S,E){return f[E.s]-f[S.s]||S.f-E.f});n<r;++n){var _=s[n].s;if(!(f[_]>e))break;m+=y-(1<<p-f[_]),f[_]=e}for(m>>>=g;m>0;){var v=s[n].s;f[v]<e?m-=1<<e-f[v]++-1:++n}for(;n>=0&&m;--n){var x=s[n].s;f[x]==e&&(--f[x],++m)}p=e}return[new St(f),p]},Fg=function(i,e,t){return-1==i.s?Math.max(Fg(i.l,e,t+1),Fg(i.r,e,t+1)):e[i.s]=t},ib=function(i){for(var e=i.length;e&&!i[--e];);for(var t=new Un(++e),n=0,r=i[0],s=1,o=function(l){t[n++]=l},a=1;a<=e;++a)if(i[a]==r&&a!=e)++s;else{if(!r&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(r),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(r);s=1,r=i[a]}return[t.subarray(0,n),e]},su=function(i,e){for(var t=0,n=0;n<e.length;++n)t+=i[n]*e[n];return t},Rd=function(i,e,t){var n=t.length,r=Dd(e+2);i[r]=255&n,i[r+1]=n>>>8,i[r+2]=255^i[r],i[r+3]=255^i[r+1];for(var s=0;s<n;++s)i[r+s+4]=t[s];return 8*(r+4+n)},rb=function(i,e,t,n,r,s,o,a,l,c,u){ys(e,u++,t),++r[256];for(var h=Lg(r,15),d=h[0],f=h[1],p=Lg(s,15),m=p[0],g=p[1],y=ib(d),_=y[0],v=y[1],x=ib(m),b=x[0],S=x[1],E=new Un(19),w=0;w<_.length;++w)E[31&_[w]]++;for(w=0;w<b.length;++w)E[31&b[w]]++;for(var T=Lg(E,7),I=T[0],k=T[1],W=19;W>4&&!I[Td[W-1]];--W);var F,z,V,U,$=c+5<<3,N=su(r,Qs)+su(s,iu)+o,G=su(r,d)+su(s,m)+o+14+3*W+su(E,I)+(2*E[16]+3*E[17]+7*E[18]);if($<=N&&$<=G)return Rd(e,u,i.subarray(l,l+c));if(ys(e,u,1+(G<N)),u+=2,G<N){F=mr(d,f,0),z=d,V=mr(m,g,0),U=m;var j=mr(I,k,0);for(ys(e,u,v-257),ys(e,u+5,S-1),ys(e,u+10,W-4),u+=14,w=0;w<W;++w)ys(e,u+3*w,I[Td[w]]);u+=3*W;for(var te=[_,b],Q=0;Q<2;++Q){var he=te[Q];for(w=0;w<he.length;++w)ys(e,u,j[ce=31&he[w]]),u+=I[ce],ce>15&&(ys(e,u,he[w]>>>5&127),u+=he[w]>>>12)}}else F=aL,z=Qs,V=cL,U=iu;for(w=0;w<a;++w)if(n[w]>255){var ce;ru(e,u,F[257+(ce=n[w]>>>18&31)]),u+=z[ce+257],ce>7&&(ys(e,u,n[w]>>>23&31),u+=tu[ce]);var De=31&n[w];ru(e,u,V[De]),u+=U[De],De>3&&(ru(e,u,n[w]>>>5&8191),u+=nu[De])}else ru(e,u,F[n[w]]),u+=z[n[w]];return ru(e,u,F[256]),u+z[256]},hL=new Ks([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Js=new St(0),dL=function(i,e,t,n,r,s){var o=i.length,a=new St(n+o+5*(1+Math.ceil(o/7e3))+r),l=a.subarray(n,a.length-r),c=0;if(!e||o<8)for(var u=0;u<=o;u+=65535){var h=u+65535;h<o?c=Rd(l,c,i.subarray(u,h)):(l[u]=s,c=Rd(l,c,i.subarray(u,o)))}else{for(var d=hL[e-1],f=d>>>13,p=8191&d,m=(1<<t)-1,g=new Un(32768),y=new Un(m+1),_=Math.ceil(t/3),v=2*_,x=function(xe){return(i[xe]^i[xe+1]<<_^i[xe+2]<<v)&m},b=new Ks(25e3),S=new Un(288),E=new Un(32),w=0,T=0,I=(u=0,0),k=0,W=0;u<o;++u){var $=x(u),N=32767&u,G=y[$];if(g[N]=G,y[$]=N,k<=u){var F=o-u;if((w>7e3||I>24576)&&F>423){c=rb(i,l,0,b,S,E,T,I,W,u-W,c),I=w=T=0,W=u;for(var z=0;z<286;++z)S[z]=0;for(z=0;z<30;++z)E[z]=0}var V=2,U=0,j=p,te=N-G&32767;if(F>2&&$==x(u-te))for(var Q=Math.min(f,F)-1,he=Math.min(32767,u),ce=Math.min(258,F);te<=he&&--j&&N!=G;){if(i[u+V]==i[u+V-te]){for(var De=0;De<ce&&i[u+De]==i[u+De-te];++De);if(De>V){if(V=De,U=te,De>Q)break;var K=Math.min(te,De-2),He=0;for(z=0;z<K;++z){var Be=u-te+z+32768&32767,ye=Be-g[Be]+32768&32767;ye>He&&(He=ye,G=Be)}}}te+=(N=G)-(G=g[N])+32768&32767}if(U){b[I++]=268435456|Ig[V]<<18|nb[U];var Ke=31&Ig[V],se=31&nb[U];T+=tu[Ke]+nu[se],++S[257+Ke],++E[se],k=u+V,++w}else b[I++]=i[u],++S[i[u]]}}c=rb(i,l,s,b,S,E,T,I,W,u-W,c),!s&&7&c&&(c=Rd(l,c+1,Js))}return yr(a,0,n+Dd(c)+r)},fL=function(){for(var i=new Ks(256),e=0;e<256;++e){for(var t=e,n=9;--n;)t=(1&t&&3988292384)^t>>>1;i[e]=t}return i}(),ou=function(){var i=-1;return{p:function(e){for(var t=i,n=0;n<e.length;++n)t=fL[255&t^e[n]]^t>>>8;i=t},d:function(){return~i}}},sb=function(){var i=1,e=0;return{p:function(t){for(var n=i,r=e,s=t.length,o=0;o!=s;){for(var a=Math.min(o+2655,s);o<a;++o)r+=n+=t[o];n=(65535&n)+15*(n>>16),r=(65535&r)+15*(r>>16)}i=n,e=r},d:function(){return(255&(i%=65521))<<24|i>>>8<<16|(255&(e%=65521))<<8|e>>>8}}},cl=function(i,e,t,n,r){return dL(i,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(i.length)))):12+e.mem,t,n,!r)},Pd=function(i,e){var t={};for(var n in i)t[n]=i[n];for(var n in e)t[n]=e[n];return t},pL=function(i,e,t){for(var n=i(),r=i.toString(),s=r.slice(r.indexOf("[")+1,r.lastIndexOf("]")).replace(/ /g,"").split(","),o=0;o<n.length;++o){var a=n[o],l=s[o];if("function"==typeof a){e+=";"+l+"=";var c=a.toString();if(a.prototype)if(-1!=c.indexOf("[native code]")){var u=c.indexOf(" ",8)+1;e+=c.slice(u,c.indexOf("(",u))}else for(var h in e+=c,a.prototype)e+=";"+l+".prototype."+h+"="+a.prototype[h].toString();else e+=c}else t[l]=a}return[e,t]},Og=[],mL=function(i,e,t,n){var r;if(!Og[t]){for(var s="",o={},a=i.length-1,l=0;l<a;++l)s=(r=pL(i[l],s,o))[0],o=r[1];Og[t]=pL(i[a],s,o)}var c=Pd({},Og[t][1]);return function(i,e,t,n,r){var s=nL(tL[e]||(tL[e]=eb(i)));return s.onerror=function(o){return r(o.error,null)},s.onmessage=function(o){return r(null,o.data)},s.postMessage(t,n),s}(Og[t][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+e.toString()+"}",t,c,function(i){var e=[];for(var t in i)(i[t]instanceof St||i[t]instanceof Un||i[t]instanceof Ks)&&e.push((i[t]=new i[t].constructor(i[t])).buffer);return e}(c),n)},au=function(){return[St,Un,Ks,tu,nu,Td,tb,oL,lL,uL,Ad,mr,Rg,gr,Pg,Dd,yr,Id,hu,Yo,ob]},lu=function(){return[St,Un,Ks,tu,nu,Td,Ig,nb,aL,Qs,cL,iu,Ad,hL,Js,mr,ys,ru,Lg,Fg,ib,su,Rd,rb,Dd,yr,dL,cl,Ld,Yo]},gL=function(){return[lb,ub,Ft,ou,fL]},yL=function(){return[cb,xL]},_L=function(){return[hb,Ft,sb]},vL=function(){return[wL]},Yo=function(i){return postMessage(i,[i.buffer])},ob=function(i){return i&&i.size&&new St(i.size)},cu=function(i,e,t,n,r,s){var o=mL(t,n,r,function(a,l){o.terminate(),s(a,l)});return o.postMessage([i,e],e.consume?[i.buffer]:[]),function(){o.terminate()}},_r=function(i){return i.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(e){return i.push(e.data[0],e.data[1])}},uu=function(i,e,t,n,r){var s,o=mL(i,n,r,function(a,l){a?(o.terminate(),e.ondata.call(e,a)):(l[1]&&o.terminate(),e.ondata.call(e,a,l[0],l[1]))});o.postMessage(t),e.push=function(a,l){if(s)throw"stream finished";if(!e.ondata)throw"no stream handler";o.postMessage([a,s=l],[a.buffer])},e.terminate=function(){o.terminate()}},xi=function(i,e){return i[e]|i[e+1]<<8},yn=function(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16|i[e+3]<<24)>>>0},ab=function(i,e){return yn(i,e)+4294967296*yn(i,e+4)},Ft=function(i,e,t){for(;t;++e)i[e]=t,t>>>=8},lb=function(i,e){var t=e.filename;if(i[0]=31,i[1]=139,i[2]=8,i[8]=e.level<2?4:9==e.level?2:0,i[9]=3,0!=e.mtime&&Ft(i,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),t){i[3]=8;for(var n=0;n<=t.length;++n)i[n+10]=t.charCodeAt(n)}},cb=function(i){if(31!=i[0]||139!=i[1]||8!=i[2])throw"invalid gzip data";var e=i[3],t=10;4&e&&(t+=i[10]|2+(i[11]<<8));for(var n=(e>>3&1)+(e>>4&1);n>0;n-=!i[t++]);return t+(2&e)},xL=function(i){var e=i.length;return(i[e-4]|i[e-3]<<8|i[e-2]<<16|i[e-1]<<24)>>>0},ub=function(i){return 10+(i.filename&&i.filename.length+1||0)},hb=function(i,e){var t=e.level,n=0==t?0:t<6?1:9==t?3:2;i[0]=120,i[1]=n<<6|(n?32-2*n:1)},wL=function(i){if(8!=(15&i[0])||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(32&i[1])throw"invalid zlib data: preset dictionaries not supported"};function db(i,e){return!e&&"function"==typeof i&&(e=i,i={}),this.ondata=e,i}var _s=function(){function i(e,t){!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{}}return i.prototype.p=function(e,t){this.ondata(cl(e,this.o,0,0,!t),t)},i.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},i}(),bL=function(){return function i(e,t){uu([lu,function(){return[_r,_s]}],this,db.call(this,e,t),function(n){var r=new _s(n.data);onmessage=_r(r)},6)}}();function ML(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[lu],function(n){return Yo(Ld(n.data[0],n.data[1]))},0,t)}function Ld(i,e){return cl(i,e||{},0,0)}var Ri=function(){function i(e){this.s={},this.p=new St(0),this.ondata=e}return i.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,n=new St(t+e.length);n.set(this.p),n.set(e,t),this.p=n},i.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,n=Id(this.p,this.o,this.s);this.ondata(yr(n,t,this.s.b),this.d),this.o=yr(n,this.s.b-32768),this.s.b=this.o.length,this.p=yr(this.p,this.s.p/8|0),this.s.p&=7},i.prototype.push=function(e,t){this.e(e),this.c(t)},i}(),fb=function(){return function i(e){this.ondata=e,uu([au,function(){return[_r,Ri]}],this,0,function(){var t=new Ri;onmessage=_r(t)},7)}}();function pb(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[au],function(n){return Yo(hu(n.data[0],ob(n.data[1])))},1,t)}function hu(i,e){return Id(i,e)}var Ng=function(){function i(e,t){this.c=ou(),this.l=0,this.v=1,_s.call(this,e,t)}return i.prototype.push=function(e,t){_s.prototype.push.call(this,e,t)},i.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var n=cl(e,this.o,this.v&&ub(this.o),t&&8,!t);this.v&&(lb(n,this.o),this.v=0),t&&(Ft(n,n.length-8,this.c.d()),Ft(n,n.length-4,this.l)),this.ondata(n,t)},i}(),SL=function(){return function i(e,t){uu([lu,gL,function(){return[_r,_s,Ng]}],this,db.call(this,e,t),function(n){var r=new Ng(n.data);onmessage=_r(r)},8)}}();function EL(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[lu,gL,function(){return[kg]}],function(n){return Yo(kg(n.data[0],n.data[1]))},2,t)}function kg(i,e){e||(e={});var t=ou(),n=i.length;t.p(i);var r=cl(i,e,ub(e),8),s=r.length;return lb(r,e),Ft(r,s-8,t.d()),Ft(r,s-4,n),r}var Bg=function(){function i(e){this.v=1,Ri.call(this,e)}return i.prototype.push=function(e,t){if(Ri.prototype.e.call(this,e),this.v){var n=this.p.length>3?cb(this.p):4;if(n>=this.p.length&&!t)return;this.p=this.p.subarray(n),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Ri.prototype.c.call(this,t)},i}(),CL=function(){return function i(e){this.ondata=e,uu([au,yL,function(){return[_r,Ri,Bg]}],this,0,function(){var t=new Bg;onmessage=_r(t)},9)}}();function TL(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[au,yL,function(){return[zg]}],function(n){return Yo(zg(n.data[0]))},3,t)}function zg(i,e){return Id(i.subarray(cb(i),-8),e||new St(xL(i)))}var mb=function(){function i(e,t){this.c=sb(),this.v=1,_s.call(this,e,t)}return i.prototype.push=function(e,t){_s.prototype.push.call(this,e,t)},i.prototype.p=function(e,t){this.c.p(e);var n=cl(e,this.o,this.v&&2,t&&4,!t);this.v&&(hb(n,this.o),this.v=0),t&&Ft(n,n.length-4,this.c.d()),this.ondata(n,t)},i}(),oK=function(){return function i(e,t){uu([lu,_L,function(){return[_r,_s,mb]}],this,db.call(this,e,t),function(n){var r=new mb(n.data);onmessage=_r(r)},10)}}();function aK(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[lu,_L,function(){return[gb]}],function(n){return Yo(gb(n.data[0],n.data[1]))},4,t)}function gb(i,e){e||(e={});var t=sb();t.p(i);var n=cl(i,e,2,4);return hb(n,e),Ft(n,n.length-4,t.d()),n}var Ug=function(){function i(e){this.v=1,Ri.call(this,e)}return i.prototype.push=function(e,t){if(Ri.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Ri.prototype.c.call(this,t)},i}(),AL=function(){return function i(e){this.ondata=e,uu([au,vL,function(){return[_r,Ri,Ug]}],this,0,function(){var t=new Ug;onmessage=_r(t)},11)}}();function DL(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return cu(i,e,[au,vL,function(){return[Ko]}],function(n){return Yo(Ko(n.data[0],ob(n.data[1])))},5,t)}function Ko(i,e){return Id((wL(i),i.subarray(2,-4)),e)}var IL=function(){function i(e){this.G=Bg,this.I=Ri,this.Z=Ug,this.ondata=e}return i.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var n=new St(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var r=this,s=function(){r.ondata.apply(r,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(s):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(s):new this.Z(s),this.s.push(this.p,t),this.p=null}}},i}(),lK=function(){function i(e){this.G=CL,this.I=fb,this.Z=AL,this.ondata=e}return i.prototype.push=function(e,t){IL.prototype.push.call(this,e,t)},i}();function cK(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";return 31==i[0]&&139==i[1]&&8==i[2]?TL(i,e,t):8!=(15&i[0])||i[0]>>4>7||(i[0]<<8|i[1])%31?pb(i,e,t):DL(i,e,t)}function uK(i,e){return 31==i[0]&&139==i[1]&&8==i[2]?zg(i,e):8!=(15&i[0])||i[0]>>4>7||(i[0]<<8|i[1])%31?hu(i,e):Ko(i,e)}var yb=function(i,e,t,n){for(var r in i){var s=i[r],o=e+r;s instanceof St?t[o]=[s,n]:Array.isArray(s)?t[o]=[s[0],Pd(n,s[1])]:yb(s,o+"/",t,n)}},RL="undefined"!=typeof TextEncoder&&new TextEncoder,_b="undefined"!=typeof TextDecoder&&new TextDecoder,PL=0;try{_b.decode(Js,{stream:!0}),PL=1}catch(i){}var LL=function(i){for(var e="",t=0;;){var n=i[t++],r=(n>127)+(n>223)+(n>239);if(t+r>i.length)return[e,yr(i,t-1)];r?3==r?(n=((15&n)<<18|(63&i[t++])<<12|(63&i[t++])<<6|63&i[t++])-65536,e+=String.fromCharCode(55296|n>>10,56320|1023&n)):e+=String.fromCharCode(1&r?(31&n)<<6|63&i[t++]:(15&n)<<12|(63&i[t++])<<6|63&i[t++]):e+=String.fromCharCode(n)}},hK=function(){function i(e){this.ondata=e,PL?this.t=new TextDecoder:this.p=Js}return i.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t=!!t,this.t){if(this.ondata(this.t.decode(e,{stream:!0}),t),t){if(this.t.decode().length)throw"invalid utf-8 data";this.t=null}}else{if(!this.p)throw"stream finished";var n=new St(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length);var r=LL(n),s=r[0],o=r[1];if(t){if(o.length)throw"invalid utf-8 data";this.p=null}else this.p=o;this.ondata(s,t)}},i}(),dK=function(){function i(e){this.ondata=e}return i.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(this.d)throw"stream finished";this.ondata(Qo(e),this.d=t||!1)},i}();function Qo(i,e){if(e){for(var t=new St(i.length),n=0;n<i.length;++n)t[n]=i.charCodeAt(n);return t}if(RL)return RL.encode(i);var r=i.length,s=new St(i.length+(i.length>>1)),o=0,a=function(u){s[o++]=u};for(n=0;n<r;++n){if(o+5>s.length){var l=new St(o+8+(r-n<<1));l.set(s),s=l}var c=i.charCodeAt(n);c<128||e?a(c):c<2048?(a(192|c>>6),a(128|63&c)):c>55295&&c<57344?(a(240|(c=65536+(1047552&c)|1023&i.charCodeAt(++n))>>18),a(128|c>>12&63),a(128|c>>6&63),a(128|63&c)):(a(224|c>>12),a(128|c>>6&63),a(128|63&c))}return yr(s,0,o)}function vb(i,e){if(e){for(var t="",n=0;n<i.length;n+=16384)t+=String.fromCharCode.apply(null,i.subarray(n,n+16384));return t}if(_b)return _b.decode(i);var r=LL(i);if(r[1].length)throw"invalid utf-8 data";return r[0]}var FL=function(i){return 1==i?3:i<6?2:9==i?1:0},OL=function(i,e){return e+30+xi(i,e+26)+xi(i,e+28)},NL=function(i,e,t){var n=xi(i,e+28),r=vb(i.subarray(e+46,e+46+n),!(2048&xi(i,e+8))),s=e+46+n,o=yn(i,e+20),a=t&&4294967295==o?kL(i,s):[o,yn(i,e+24),yn(i,e+42)],l=a[0],c=a[1],u=a[2];return[xi(i,e+10),l,c,r,s+xi(i,e+30)+xi(i,e+32),u]},kL=function(i,e){for(;1!=xi(i,e);e+=4+xi(i,e+2));return[ab(i,e+12),ab(i,e+4),ab(i,e+20)]},Jo=function(i){var e=0;if(i)for(var t in i){var n=i[t].length;if(n>65535)throw"extra field too long";e+=n+4}return e},du=function(i,e,t,n,r,s,o,a){var l=n.length,c=t.extra,u=a&&a.length,h=Jo(c);Ft(i,e,null!=o?33639248:67324752),e+=4,null!=o&&(i[e++]=20,i[e++]=t.os),i[e]=20,e+=2,i[e++]=t.flag<<1|(null==s&&8),i[e++]=r&&8,i[e++]=255&t.compression,i[e++]=t.compression>>8;var d=new Date(null==t.mtime?Date.now():t.mtime),f=d.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(Ft(i,e,f<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>>1),e+=4,null!=s&&(Ft(i,e,t.crc),Ft(i,e+4,s),Ft(i,e+8,t.size)),Ft(i,e+12,l),Ft(i,e+14,h),e+=16,null!=o&&(Ft(i,e,u),Ft(i,e+6,t.attrs),Ft(i,e+10,o),e+=14),i.set(n,e),e+=l,h)for(var p in c){var m=c[p],g=m.length;Ft(i,e,+p),Ft(i,e+2,g),i.set(m,e+4),e+=4+g}return u&&(i.set(a,e),e+=u),e},xb=function(i,e,t,n,r){Ft(i,e,101010256),Ft(i,e+8,t),Ft(i,e+10,t),Ft(i,e+12,n),Ft(i,e+16,r)},Fd=function(){function i(e){this.filename=e,this.c=ou(),this.size=0,this.compression=0}return i.prototype.process=function(e,t){this.ondata(null,e,t)},i.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},i}(),fK=function(){function i(e,t){var n=this;t||(t={}),Fd.call(this,e),this.d=new _s(t,function(r,s){n.ondata(null,r,s)}),this.compression=8,this.flag=FL(t.level)}return i.prototype.process=function(e,t){try{this.d.push(e,t)}catch(n){this.ondata(n,null,t)}},i.prototype.push=function(e,t){Fd.prototype.push.call(this,e,t)},i}(),pK=function(){function i(e,t){var n=this;t||(t={}),Fd.call(this,e),this.d=new bL(t,function(r,s,o){n.ondata(r,s,o)}),this.compression=8,this.flag=FL(t.level),this.terminate=this.d.terminate}return i.prototype.process=function(e,t){this.d.push(e,t)},i.prototype.push=function(e,t){Fd.prototype.push.call(this,e,t)},i}(),mK=function(){function i(e){this.ondata=e,this.u=[],this.d=1}return i.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var n=Qo(e.filename),r=n.length,s=e.comment,o=s&&Qo(s),a=r!=e.filename.length||o&&s.length!=o.length,l=r+Jo(e.extra)+30;if(r>65535)throw"filename too long";var c=new St(l);du(c,0,e,n,a);var u=[c],h=function(){for(var g=0,y=u;g<y.length;g++)t.ondata(null,y[g],!1);u=[]},d=this.d;this.d=0;var f=this.u.length,p=Pd(e,{f:n,u:a,o,t:function(){e.terminate&&e.terminate()},r:function(){if(h(),d){var g=t.u[f+1];g?g.r():t.d=1}d=1}}),m=0;e.ondata=function(g,y,_){if(g)t.ondata(g,y,_),t.terminate();else if(m+=y.length,u.push(y),_){var v=new St(16);Ft(v,0,134695760),Ft(v,4,e.crc),Ft(v,8,m),Ft(v,12,e.size),u.push(v),p.c=m,p.b=l+m+16,p.crc=e.crc,p.size=e.size,d&&p.r(),d=1}else d&&h()},this.u.push(p)},i.prototype.end=function(){var e=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){!(1&e.d)||(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},i.prototype.e=function(){for(var e=0,t=0,n=0,r=0,s=this.u;r<s.length;r++)n+=46+(o=s[r]).f.length+Jo(o.extra)+(o.o?o.o.length:0);for(var a=new St(n+22),l=0,c=this.u;l<c.length;l++){var o;du(a,e,o=c[l],o.f,o.u,o.c,t,o.o),e+=46+o.f.length+Jo(o.extra)+(o.o?o.o.length:0),t+=o.b}xb(a,e,this.u.length,n,t),this.ondata(null,a,!0),this.d=2},i.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++)t[e].t();this.d=2},i}();function gK(i,e,t){if(t||(t=e,e={}),"function"!=typeof t)throw"no callback";var n={};yb(i,"",n,e);var r=Object.keys(n),s=r.length,o=0,a=0,l=s,c=new Array(s),u=[],h=function(){for(var m=0;m<u.length;++m)u[m]()},d=function(){var m=new St(a+22),g=o,y=a-o;a=0;for(var _=0;_<l;++_){var v=c[_];try{var x=v.c.length;du(m,a,v,v.f,v.u,x);var b=30+v.f.length+Jo(v.extra),S=a+b;m.set(v.c,S),du(m,o,v,v.f,v.u,x,a,v.m),o+=16+b+(v.m?v.m.length:0),a=S+x}catch(E){return t(E,null)}}xb(m,o,c.length,y,g),t(null,m)};s||d();for(var f=function(m){var g=r[m],y=n[g],_=y[0],v=y[1],x=ou(),b=_.length;x.p(_);var S=Qo(g),E=S.length,w=v.comment,T=w&&Qo(w),I=T&&T.length,k=Jo(v.extra),W=0==v.level?0:8,$=function(N,G){if(N)h(),t(N,null);else{var F=G.length;c[m]=Pd(v,{size:b,crc:x.d(),c:G,f:S,m:T,u:E!=g.length||T&&w.length!=I,compression:W}),o+=30+E+k+F,a+=76+2*(E+k)+(I||0)+F,--s||d()}};if(E>65535&&$("filename too long",null),W)if(b<16e4)try{$(null,Ld(_,v))}catch(N){$(N,null)}else u.push(ML(_,v,$));else $(null,_)},p=0;p<l;++p)f(p);return h}function yK(i,e){e||(e={});var t={},n=[];yb(i,"",t,e);var r=0,s=0;for(var o in t){var a=t[o],l=a[0],c=a[1],u=0==c.level?0:8,d=(h=Qo(o)).length,f=c.comment,p=f&&Qo(f),m=p&&p.length,g=Jo(c.extra);if(d>65535)throw"filename too long";var y=u?Ld(l,c):l,_=y.length,v=ou();v.p(l),n.push(Pd(c,{size:l.length,crc:v.d(),c:y,f:h,m:p,u:d!=o.length||p&&f.length!=m,o:r,compression:u})),r+=30+d+g+_,s+=76+2*(d+g)+(m||0)+_}for(var x=new St(s+22),b=r,S=s-r,E=0;E<n.length;++E){var h;du(x,(h=n[E]).o,h,h.f,h.u,h.c.length);var w=30+h.f.length+Jo(h.extra);x.set(h.c,h.o+w),du(x,r,h,h.f,h.u,h.c.length,h.o,h.m),r+=16+w+(h.m?h.m.length:0)}return xb(x,r,n.length,S,b),x}var BL=function(){function i(){}return i.prototype.push=function(e,t){this.ondata(null,e,t)},i.compression=0,i}(),_K=function(){function i(){var e=this;this.i=new Ri(function(t,n){e.ondata(null,t,n)})}return i.prototype.push=function(e,t){try{this.i.push(e,t)}catch(n){this.ondata(n,e,t)}},i.compression=8,i}(),vK=function(){function i(e,t){var n=this;t<32e4?this.i=new Ri(function(r,s){n.ondata(null,r,s)}):(this.i=new fb(function(r,s,o){n.ondata(r,s,o)}),this.terminate=this.i.terminate)}return i.prototype.push=function(e,t){this.i.terminate&&(e=yr(e,0)),this.i.push(e,t)},i.compression=8,i}(),xK=function(){function i(e){this.onfile=e,this.k=[],this.o={0:BL},this.p=Js}return i.prototype.push=function(e,t){var n=this;if(!this.onfile)throw"no callback";if(!this.p)throw"stream finished";if(this.c>0){var r=Math.min(this.c,e.length),s=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(s,!this.c):this.k[0].push(s),(e=e.subarray(r)).length)return this.push(e,t)}else{var o=0,a=0,l=void 0,c=void 0;this.p.length?e.length?((c=new St(this.p.length+e.length)).set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var u=c.length,h=this.c,d=h&&this.d,f=function(){var y,_=yn(c,a);if(67324752==_){o=1,l=a,p.d=null,p.c=0;var v=xi(c,a+6),x=xi(c,a+8),b=2048&v,S=8&v,E=xi(c,a+26),w=xi(c,a+28);if(u>a+30+E+w){var T=[];p.k.unshift(T),o=2;var I=yn(c,a+18),k=yn(c,a+22),W=vb(c.subarray(a+30,a+=30+E),!b);4294967295==I?(y=S?[-2]:kL(c,a),I=y[0],k=y[1]):S&&(I=-1),a+=w,p.c=I;var $,N={name:W,compression:x,start:function(){if(!N.ondata)throw"no callback";if(I){var G=n.o[x];if(!G)throw"unknown compression type "+x;($=I<0?new G(W):new G(W,I,k)).ondata=function(U,j,te){N.ondata(U,j,te)};for(var F=0,z=T;F<z.length;F++)$.push(z[F],!1);n.k[0]==T&&n.c?n.d=$:$.push(Js,!0)}else N.ondata(null,Js,!0)},terminate:function(){$&&$.terminate&&$.terminate()}};I>=0&&(N.size=I,N.originalSize=k),p.onfile(N)}return"break"}if(h){if(134695760==_)return l=a+=12+(-2==h&&8),o=3,p.c=0,"break";if(33639248==_)return l=a-=4,o=3,p.c=0,"break"}},p=this;a<u-4&&"break"!==f();++a);if(this.p=Js,h<0){var g=c.subarray(0,o?l-12-(-2==h&&8)-(134695760==yn(c,l-16)&&4):a);d?d.push(g,!!o):this.k[+(2==o)].push(g)}if(2&o)return this.push(c.subarray(a),t);this.p=c.subarray(a)}if(t){if(this.c)throw"invalid zip file";this.p=null}},i.prototype.register=function(e){this.o[e.compression]=e},i}();function wK(i,e){if("function"!=typeof e)throw"no callback";for(var t=[],n=function(){for(var d=0;d<t.length;++d)t[d]()},r={},s=i.length-22;101010256!=yn(i,s);--s)if(!s||i.length-s>65558)return void e("invalid zip file",null);var o=xi(i,s+8);o||e(null,{});var a=o,l=yn(i,s+16),c=4294967295==l;if(c){if(s=yn(i,s-12),101075792!=yn(i,s))return void e("invalid zip file",null);a=o=yn(i,s+32),l=yn(i,s+48)}for(var u=function(d){var f=NL(i,l,c),p=f[0],m=f[1],g=f[2],y=f[3],_=f[4],x=OL(i,f[5]);l=_;var b=function(E,w){E?(n(),e(E,null)):(r[y]=w,--o||e(null,r))};if(p)if(8==p){var S=i.subarray(x,x+m);if(m<32e4)try{b(null,hu(S,new St(g)))}catch(E){b(E,null)}else t.push(pb(S,{size:g},b))}else b("unknown compression type "+p,null);else b(null,yr(i,x,x+m))},h=0;h<a;++h)u();return n}function bK(i){for(var e={},t=i.length-22;101010256!=yn(i,t);--t)if(!t||i.length-t>65558)throw"invalid zip file";var n=xi(i,t+8);if(!n)return{};var r=yn(i,t+16),s=4294967295==r;if(s){if(t=yn(i,t-12),101075792!=yn(i,t))throw"invalid zip file";n=yn(i,t+32),r=yn(i,t+48)}for(var o=0;o<n;++o){var a=NL(i,r,s),l=a[0],c=a[1],u=a[2],h=a[3],d=a[4],p=OL(i,a[5]);if(r=d,l){if(8!=l)throw"unknown compression type "+l;e[h]=hu(i.subarray(p,p+c),new St(u))}else e[h]=yr(i,p,p+c)}return e}class MK extends VZ{constructor(e){super(e),this.type=Us}parse(e){const T=Math.pow(2.7182818,2.2),W={l:0,c:0,lc:0};function $(M,C,L,H,Y){for(;L<M;)C=C<<8|Me(H,Y),L+=8;W.l=C>>(L-=M)&(1<<M)-1,W.c=C,W.lc=L}const N=new Array(59);function z(M){return 63&M}function V(M){return M>>6}const j={c:0,lc:0};function te(M,C,L,H){M=M<<8|Me(L,H),C+=8,j.c=M,j.lc=C}const Q={c:0,lc:0};function he(M,C,L,H,Y,X,ie,_e,Se){if(M==C){H<8&&(te(L,H,Y,X),L=j.c,H=j.lc);let de=L>>(H-=8);if(de=new Uint8Array([de])[0],_e.value+de>Se)return!1;const ge=ie[_e.value-1];for(;de-- >0;)ie[_e.value++]=ge}else{if(!(_e.value<Se))return!1;ie[_e.value++]=M}Q.c=L,Q.lc=H}function ce(M){return 65535&M}function De(M){const C=ce(M);return C>32767?C-65536:C}const K={a:0,b:0};function He(M,C){const L=De(M),Y=De(C),X=L+(1&Y)+(Y>>1),_e=X-Y;K.a=X,K.b=_e}function Be(M,C){const L=ce(M),H=ce(C),Y=L-(H>>1)&65535;K.a=H+Y-32768&65535,K.b=Y}function $e(M,C,L,H,Y,X,ie){const _e=ie<16384,Se=L>Y?Y:L;let ge,ve,de=1;for(;de<=Se;)de<<=1;for(de>>=1,ge=de,de>>=1;de>=1;){ve=0;const Ue=ve+X*(Y-ge),ze=X*de,et=X*ge,Ve=H*de,qe=H*ge;let pt,_t,Ht,Qn;for(;ve<=Ue;ve+=et){let Et=ve;const Dt=ve+H*(L-ge);for(;Et<=Dt;Et+=qe){const Ln=Et+Ve,wr=Et+ze,Hn=wr+Ve;_e?(He(M[Et+C],M[wr+C]),pt=K.a,Ht=K.b,He(M[Ln+C],M[Hn+C]),_t=K.a,Qn=K.b,He(pt,_t),M[Et+C]=K.a,M[Ln+C]=K.b,He(Ht,Qn),M[wr+C]=K.a,M[Hn+C]=K.b):(Be(M[Et+C],M[wr+C]),pt=K.a,Ht=K.b,Be(M[Ln+C],M[Hn+C]),_t=K.a,Qn=K.b,Be(pt,_t),M[Et+C]=K.a,M[Ln+C]=K.b,Be(Ht,Qn),M[wr+C]=K.a,M[Hn+C]=K.b)}if(L&de){const Ln=Et+ze;_e?He(M[Et+C],M[Ln+C]):Be(M[Et+C],M[Ln+C]),pt=K.a,M[Ln+C]=K.b,M[Et+C]=pt}}if(Y&de){let Et=ve;const Dt=ve+H*(L-ge);for(;Et<=Dt;Et+=qe){const Ln=Et+Ve;_e?He(M[Et+C],M[Ln+C]):Be(M[Et+C],M[Ln+C]),pt=K.a,M[Ln+C]=K.b,M[Et+C]=pt}}ge=de,de>>=1}return ve}function Ke(M,C,L,H,Y,X){const _e=L.value,Se=pe(C,L),de=pe(C,L);L.value+=4;const ge=pe(C,L);if(L.value+=4,Se<0||Se>=65537||de<0||de>=65537)throw new Error("Something wrong with HUF_ENCSIZE");const ve=new Array(65537),Ue=new Array(16384);if(function k(M){for(let C=0;C<16384;C++)M[C]={},M[C].len=0,M[C].lit=0,M[C].p=null}(Ue),function F(M,C,L,H,Y,X){const ie=C;let _e=0,Se=0;for(;H<=Y;H++){if(ie.value-C.value>L)return!1;$(6,_e,Se,M,ie);const de=W.l;if(_e=W.c,Se=W.lc,X[H]=de,63==de){if(ie.value-C.value>L)throw new Error("Something wrong with hufUnpackEncTable");$(8,_e,Se,M,ie);let ge=W.l+6;if(_e=W.c,Se=W.lc,H+ge>Y+1)throw new Error("Something wrong with hufUnpackEncTable");for(;ge--;)X[H++]=0;H--}else if(de>=59){let ge=de-59+2;if(H+ge>Y+1)throw new Error("Something wrong with hufUnpackEncTable");for(;ge--;)X[H++]=0;H--}}!function G(M){for(let L=0;L<=58;++L)N[L]=0;for(let L=0;L<65537;++L)N[M[L]]+=1;let C=0;for(let L=58;L>0;--L){const H=C+N[L]>>1;N[L]=C,C=H}for(let L=0;L<65537;++L){const H=M[L];H>0&&(M[L]=H|N[H]++<<6)}}(X)}(M,L,H-(L.value-_e),Se,de,ve),ge>8*(H-(L.value-_e)))throw new Error("Something wrong with hufUncompress");(function U(M,C,L,H){for(;C<=L;C++){const Y=V(M[C]),X=z(M[C]);if(Y>>X)throw new Error("Invalid table entry");if(X>14){const ie=H[Y>>X-14];if(ie.len)throw new Error("Invalid table entry");if(ie.lit++,ie.p){const _e=ie.p;ie.p=new Array(ie.lit);for(let Se=0;Se<ie.lit-1;++Se)ie.p[Se]=_e[Se]}else ie.p=new Array(1);ie.p[ie.lit-1]=C}else if(X){let ie=0;for(let _e=1<<14-X;_e>0;_e--){const Se=H[(Y<<14-X)+ie];if(Se.len||Se.p)throw new Error("Invalid table entry");Se.len=X,Se.lit=C,ie++}}}})(ve,Se,de,Ue),function ye(M,C,L,H,Y,X,ie,_e,Se){let de=0,ge=0;const ve=ie,Ue=Math.trunc(H.value+(Y+7)/8);for(;H.value<Ue;)for(te(de,ge,L,H),de=j.c,ge=j.lc;ge>=14;){const Ve=C[de>>ge-14&16383];if(Ve.len)ge-=Ve.len,he(Ve.lit,X,de,ge,L,H,_e,Se,ve),de=Q.c,ge=Q.lc;else{if(!Ve.p)throw new Error("hufDecode issues");let qe;for(qe=0;qe<Ve.lit;qe++){const pt=z(M[Ve.p[qe]]);for(;ge<pt&&H.value<Ue;)te(de,ge,L,H),de=j.c,ge=j.lc;if(ge>=pt&&V(M[Ve.p[qe]])==(de>>ge-pt&(1<<pt)-1)){ge-=pt,he(Ve.p[qe],X,de,ge,L,H,_e,Se,ve),de=Q.c,ge=Q.lc;break}}if(qe==Ve.lit)throw new Error("hufDecode issues")}}const ze=8-Y&7;for(de>>=ze,ge-=ze;ge>0;){const et=C[de<<14-ge&16383];if(!et.len)throw new Error("hufDecode issues");ge-=et.len,he(et.lit,X,de,ge,L,H,_e,Se,ve),de=Q.c,ge=Q.lc}}(ve,Ue,M,L,ge,de,X,Y,{value:0})}function oe(M){for(let C=1;C<M.length;C++)M[C]=M[C-1]+M[C]-128}function xe(M,C){let L=0,H=Math.floor((M.length+1)/2),Y=0;const X=M.length-1;for(;!(Y>X||(C[Y++]=M[L++],Y>X));)C[Y++]=M[H++]}function Ge(M){let C=M.byteLength;const L=new Array;let H=0;const Y=new DataView(M);for(;C>0;){const X=Y.getInt8(H++);if(X<0){const ie=-X;C-=ie+1;for(let _e=0;_e<ie;_e++)L.push(Y.getUint8(H++))}else{const ie=X;C-=2;const _e=Y.getUint8(H++);for(let Se=0;Se<ie+1;Se++)L.push(_e)}}return L}function rt(M,C,L){let H,Y=1;for(;Y<64;)H=C[M.value],65280==H?Y=64:H>>8==255?Y+=255&H:(L[Y]=H,Y++),M.value++}function Qe(M,C){C[0]=ae(M[0]),C[1]=ae(M[1]),C[2]=ae(M[5]),C[3]=ae(M[6]),C[4]=ae(M[14]),C[5]=ae(M[15]),C[6]=ae(M[27]),C[7]=ae(M[28]),C[8]=ae(M[2]),C[9]=ae(M[4]),C[10]=ae(M[7]),C[11]=ae(M[13]),C[12]=ae(M[16]),C[13]=ae(M[26]),C[14]=ae(M[29]),C[15]=ae(M[42]),C[16]=ae(M[3]),C[17]=ae(M[8]),C[18]=ae(M[12]),C[19]=ae(M[17]),C[20]=ae(M[25]),C[21]=ae(M[30]),C[22]=ae(M[41]),C[23]=ae(M[43]),C[24]=ae(M[9]),C[25]=ae(M[11]),C[26]=ae(M[18]),C[27]=ae(M[24]),C[28]=ae(M[31]),C[29]=ae(M[40]),C[30]=ae(M[44]),C[31]=ae(M[53]),C[32]=ae(M[10]),C[33]=ae(M[19]),C[34]=ae(M[23]),C[35]=ae(M[32]),C[36]=ae(M[39]),C[37]=ae(M[45]),C[38]=ae(M[52]),C[39]=ae(M[54]),C[40]=ae(M[20]),C[41]=ae(M[22]),C[42]=ae(M[33]),C[43]=ae(M[38]),C[44]=ae(M[46]),C[45]=ae(M[51]),C[46]=ae(M[55]),C[47]=ae(M[60]),C[48]=ae(M[21]),C[49]=ae(M[34]),C[50]=ae(M[37]),C[51]=ae(M[47]),C[52]=ae(M[50]),C[53]=ae(M[56]),C[54]=ae(M[59]),C[55]=ae(M[61]),C[56]=ae(M[35]),C[57]=ae(M[36]),C[58]=ae(M[48]),C[59]=ae(M[49]),C[60]=ae(M[57]),C[61]=ae(M[58]),C[62]=ae(M[62]),C[63]=ae(M[63])}function Ze(M){const C=.5*Math.cos(.7853975),L=.5*Math.cos(3.14159/16),H=.5*Math.cos(3.14159/8),Y=.5*Math.cos(3*3.14159/16),X=.5*Math.cos(.981746875),ie=.5*Math.cos(3*3.14159/8),_e=.5*Math.cos(1.374445625),Se=new Array(4),de=new Array(4),ge=new Array(4),ve=new Array(4);for(let Ue=0;Ue<8;++Ue){const ze=8*Ue;Se[0]=H*M[ze+2],Se[1]=ie*M[ze+2],Se[2]=H*M[ze+6],Se[3]=ie*M[ze+6],de[0]=L*M[ze+1]+Y*M[ze+3]+X*M[ze+5]+_e*M[ze+7],de[1]=Y*M[ze+1]-_e*M[ze+3]-L*M[ze+5]-X*M[ze+7],de[2]=X*M[ze+1]-L*M[ze+3]+_e*M[ze+5]+Y*M[ze+7],de[3]=_e*M[ze+1]-X*M[ze+3]+Y*M[ze+5]-L*M[ze+7],ge[0]=C*(M[ze+0]+M[ze+4]),ge[3]=C*(M[ze+0]-M[ze+4]),ge[1]=Se[0]+Se[3],ge[2]=Se[1]-Se[2],ve[0]=ge[0]+ge[1],ve[1]=ge[3]+ge[2],ve[2]=ge[3]-ge[2],ve[3]=ge[0]-ge[1],M[ze+0]=ve[0]+de[0],M[ze+1]=ve[1]+de[1],M[ze+2]=ve[2]+de[2],M[ze+3]=ve[3]+de[3],M[ze+4]=ve[3]-de[3],M[ze+5]=ve[2]-de[2],M[ze+6]=ve[1]-de[1],M[ze+7]=ve[0]-de[0]}for(let Ue=0;Ue<8;++Ue)Se[0]=H*M[16+Ue],Se[1]=ie*M[16+Ue],Se[2]=H*M[48+Ue],Se[3]=ie*M[48+Ue],de[0]=L*M[8+Ue]+Y*M[24+Ue]+X*M[40+Ue]+_e*M[56+Ue],de[1]=Y*M[8+Ue]-_e*M[24+Ue]-L*M[40+Ue]-X*M[56+Ue],de[2]=X*M[8+Ue]-L*M[24+Ue]+_e*M[40+Ue]+Y*M[56+Ue],de[3]=_e*M[8+Ue]-X*M[24+Ue]+Y*M[40+Ue]-L*M[56+Ue],ge[0]=C*(M[Ue]+M[32+Ue]),ge[3]=C*(M[Ue]-M[32+Ue]),ge[1]=Se[0]+Se[3],ge[2]=Se[1]-Se[2],ve[0]=ge[0]+ge[1],ve[1]=ge[3]+ge[2],ve[2]=ge[3]-ge[2],ve[3]=ge[0]-ge[1],M[0+Ue]=ve[0]+de[0],M[8+Ue]=ve[1]+de[1],M[16+Ue]=ve[2]+de[2],M[24+Ue]=ve[3]+de[3],M[32+Ue]=ve[3]-de[3],M[40+Ue]=ve[2]-de[2],M[48+Ue]=ve[1]-de[1],M[56+Ue]=ve[0]-de[0]}function Ot(M){for(let C=0;C<64;++C){const L=M[0][C],H=M[1][C],Y=M[2][C];M[0][C]=L+1.5747*Y,M[1][C]=L-.1873*H-.4682*Y,M[2][C]=L+1.8556*H}}function It(M,C,L){for(let H=0;H<64;++H)C[L+H]=N2.toHalfFloat(O(M[H]))}function O(M){return M<=1?Math.sign(M)*Math.pow(Math.abs(M),2.2):Math.sign(M)*Math.pow(T,Math.abs(M)-1)}function A(M){return new DataView(M.array.buffer,M.offset.value,M.size)}function ee(M){const C=M.viewer.buffer.slice(M.offset.value,M.offset.value+M.size),L=new Uint8Array(Ge(C)),H=new Uint8Array(L.length);return oe(L),xe(L,H),new DataView(H.buffer)}function me(M){const C=M.array.slice(M.offset.value,M.offset.value+M.size);void 0===yl&&console.error("THREE.EXRLoader: External library fflate.min.js required.");const L=Ko(C),H=new Uint8Array(L.length);return oe(L),xe(L,H),new DataView(H.buffer)}function be(M){const C=M.viewer,L={value:M.offset.value},H=new Uint16Array(M.width*M.scanlineBlockSize*(M.channels*M.type)),Y=new Uint8Array(8192);let X=0;const ie=new Array(M.channels);for(let et=0;et<M.channels;et++)ie[et]={},ie[et].start=X,ie[et].end=ie[et].start,ie[et].nx=M.width,ie[et].ny=M.lines,ie[et].size=M.type,X+=ie[et].nx*ie[et].ny*ie[et].size;const _e=Ct(C,L),Se=Ct(C,L);if(Se>=8192)throw new Error("Something is wrong with PIZ_COMPRESSION BITMAP_SIZE");if(_e<=Se)for(let et=0;et<Se-_e+1;et++)Y[et+_e]=Xe(C,L);const de=new Uint16Array(65536),ge=function I(M,C){let L=0;for(let Y=0;Y<65536;++Y)(0==Y||M[Y>>3]&1<<(7&Y))&&(C[L++]=Y);const H=L-1;for(;L<65536;)C[L++]=0;return H}(Y,de),ve=pe(C,L);Ke(M.array,C,L,ve,H,X);for(let et=0;et<M.channels;++et){const Ve=ie[et];for(let qe=0;qe<ie[et].size;++qe)$e(H,Ve.start+qe,Ve.nx,Ve.size,Ve.ny,Ve.nx*Ve.size,ge)}!function se(M,C,L){for(let H=0;H<L;++H)C[H]=M[C[H]]}(de,H,X);let Ue=0;const ze=new Uint8Array(H.buffer.byteLength);for(let et=0;et<M.lines;et++)for(let Ve=0;Ve<M.channels;Ve++){const qe=ie[Ve],pt=qe.nx*qe.size,_t=new Uint8Array(H.buffer,2*qe.end,2*pt);ze.set(_t,Ue),Ue+=2*pt,qe.end+=pt}return new DataView(ze.buffer)}function Re(M){const C=M.array.slice(M.offset.value,M.offset.value+M.size);void 0===yl&&console.error("THREE.EXRLoader: External library fflate.min.js required.");const L=Ko(C),H=M.lines*M.channels*M.width,Y=1==M.type?new Uint16Array(H):new Uint32Array(H);let X=0,ie=0;const _e=new Array(4);for(let Se=0;Se<M.lines;Se++)for(let de=0;de<M.channels;de++){let ge=0;switch(M.type){case 1:_e[0]=X,_e[1]=_e[0]+M.width,X=_e[1]+M.width;for(let ve=0;ve<M.width;++ve)ge+=L[_e[0]++]<<8|L[_e[1]++],Y[ie]=ge,ie++;break;case 2:_e[0]=X,_e[1]=_e[0]+M.width,_e[2]=_e[1]+M.width,X=_e[2]+M.width;for(let ve=0;ve<M.width;++ve)ge+=L[_e[0]++]<<24|L[_e[1]++]<<16|L[_e[2]++]<<8,Y[ie]=ge,ie++}}return new DataView(Y.buffer)}function Je(M){const C=M.viewer,L={value:M.offset.value},H=new Uint8Array(M.width*M.lines*(M.channels*M.type*2)),Y={version:Ee(C,L),unknownUncompressedSize:Ee(C,L),unknownCompressedSize:Ee(C,L),acCompressedSize:Ee(C,L),dcCompressedSize:Ee(C,L),rleCompressedSize:Ee(C,L),rleUncompressedSize:Ee(C,L),rleRawSize:Ee(C,L),totalAcUncompressedCount:Ee(C,L),totalDcUncompressedCount:Ee(C,L),acCompression:Ee(C,L)};if(Y.version<2)throw new Error("EXRLoader.parse: "+J.compression+" version "+Y.version+" is unsupported");const X=new Array;let ie=Ct(C,L)-2;for(;ie>0;){const Ve=R(C.buffer,L),qe=Xe(C,L),pt=qe>>2&3,Ht=new Int8Array([(qe>>4)-1])[0],Qn=Xe(C,L);X.push({name:Ve,index:Ht,type:Qn,compression:pt}),ie-=Ve.length+3}const _e=J.channels,Se=new Array(M.channels);for(let Ve=0;Ve<M.channels;++Ve){const qe=Se[Ve]={},pt=_e[Ve];qe.name=pt.name,qe.compression=0,qe.decoded=!1,qe.type=pt.pixelType,qe.pLinear=pt.pLinear,qe.width=M.width,qe.height=M.lines}const de={idx:new Array(3)};for(let Ve=0;Ve<M.channels;++Ve){const qe=Se[Ve];for(let pt=0;pt<X.length;++pt){const _t=X[pt];qe.name==_t.name&&(qe.compression=_t.compression,_t.index>=0&&(de.idx[_t.index]=Ve),qe.offset=Ve)}}let ge,ve,Ue;if(Y.acCompressedSize>0)switch(Y.acCompression){case 0:ge=new Uint16Array(Y.totalAcUncompressedCount),Ke(M.array,C,L,Y.acCompressedSize,ge,Y.totalAcUncompressedCount);break;case 1:const qe=Ko(M.array.slice(L.value,L.value+Y.totalAcUncompressedCount));ge=new Uint16Array(qe.buffer),L.value+=Y.totalAcUncompressedCount}Y.dcCompressedSize>0&&(ve=new Uint16Array(me({array:M.array,offset:L,size:Y.dcCompressedSize}).buffer),L.value+=Y.dcCompressedSize),Y.rleRawSize>0&&(Ue=Ge(Ko(M.array.slice(L.value,L.value+Y.rleCompressedSize)).buffer),L.value+=Y.rleCompressedSize);let ze=0;const et=new Array(Se.length);for(let Ve=0;Ve<et.length;++Ve)et[Ve]=new Array;for(let Ve=0;Ve<M.lines;++Ve)for(let qe=0;qe<Se.length;++qe)et[qe].push(ze),ze+=Se[qe].width*M.type*2;!function Ie(M,C,L,H,Y,X){let ie=new DataView(X.buffer);const _e=L[M.idx[0]].width,Se=L[M.idx[0]].height,ge=Math.floor(_e/8),ve=Math.ceil(_e/8),Ue=Math.ceil(Se/8),ze=_e-8*(ve-1),et=Se-8*(Ue-1),Ve={value:0},qe=new Array(3),pt=new Array(3),_t=new Array(3),Ht=new Array(3),Qn=new Array(3);for(let Dt=0;Dt<3;++Dt)Qn[Dt]=C[M.idx[Dt]],qe[Dt]=Dt<1?0:qe[Dt-1]+ve*Ue,pt[Dt]=new Float32Array(64),_t[Dt]=new Uint16Array(64),Ht[Dt]=new Uint16Array(64*ve);for(let Dt=0;Dt<Ue;++Dt){let Ln=8;Dt==Ue-1&&(Ln=et);let wr=8;for(let kt=0;kt<ve;++kt){kt==ve-1&&(wr=ze);for(let qt=0;qt<3;++qt)_t[qt].fill(0),_t[qt][0]=Y[qe[qt]++],rt(Ve,H,_t[qt]),Qe(_t[qt],pt[qt]),Ze(pt[qt]);Ot(pt);for(let qt=0;qt<3;++qt)It(pt[qt],Ht[qt],64*kt)}let Hn=0;for(let kt=0;kt<3;++kt){const qt=L[M.idx[kt]].type;for(let uo=8*Dt;uo<8*Dt+Ln;++uo){Hn=Qn[kt][uo];for(let $d=0;$d<ge;++$d){const vs=64*$d+8*(7&uo);ie.setUint16(Hn+0*qt,Ht[kt][vs+0],!0),ie.setUint16(Hn+2*qt,Ht[kt][vs+1],!0),ie.setUint16(Hn+4*qt,Ht[kt][vs+2],!0),ie.setUint16(Hn+6*qt,Ht[kt][vs+3],!0),ie.setUint16(Hn+8*qt,Ht[kt][vs+4],!0),ie.setUint16(Hn+10*qt,Ht[kt][vs+5],!0),ie.setUint16(Hn+12*qt,Ht[kt][vs+6],!0),ie.setUint16(Hn+14*qt,Ht[kt][vs+7],!0),Hn+=16*qt}}if(ge!=ve)for(let uo=8*Dt;uo<8*Dt+Ln;++uo){const $d=Qn[kt][uo]+8*ge*2*qt,vs=64*ge+8*(7&uo);for(let my=0;my<wr;++my)ie.setUint16($d+2*my*qt,Ht[kt][vs+my],!0)}}}const Et=new Uint16Array(_e);ie=new DataView(X.buffer);for(let Dt=0;Dt<3;++Dt){L[M.idx[Dt]].decoded=!0;const Ln=L[M.idx[Dt]].type;if(2==L[Dt].type)for(let wr=0;wr<Se;++wr){const Hn=Qn[Dt][wr];for(let kt=0;kt<_e;++kt)Et[kt]=ie.getUint16(Hn+2*kt*Ln,!0);for(let kt=0;kt<_e;++kt)ie.setFloat32(Hn+2*kt*Ln,ae(Et[kt]),!0)}}}(de,et,Se,ge,ve,H);for(let Ve=0;Ve<Se.length;++Ve){const qe=Se[Ve];if(!qe.decoded){if(2!==qe.compression)throw new Error("EXRLoader.parse: unsupported channel compression");{let pt=0,_t=0;for(let Ht=0;Ht<M.lines;++Ht){let Qn=et[Ve][pt];for(let Et=0;Et<qe.width;++Et){for(let Dt=0;Dt<2*qe.type;++Dt)H[Qn++]=Ue[_t+Dt*qe.width*qe.height];_t++}pt++}}}}return new DataView(H.buffer)}function R(M,C){const L=new Uint8Array(M);let H=0;for(;0!=L[C.value+H];)H+=1;const Y=(new TextDecoder).decode(L.slice(C.value,C.value+H));return C.value=C.value+H+1,Y}function B(M,C){const L=M.getInt32(C.value,!0);return C.value=C.value+4,L}function pe(M,C){const L=M.getUint32(C.value,!0);return C.value=C.value+4,L}function Me(M,C){const L=M[C.value];return C.value=C.value+1,L}function Xe(M,C){const L=M.getUint8(C.value);return C.value=C.value+1,L}const Ee=function(M,C){let L;return L="getBigInt64"in DataView.prototype?Number(M.getBigInt64(C.value,!0)):M.getUint32(C.value+4,!0)+Number(M.getUint32(C.value,!0)<<32),C.value+=8,L};function Ne(M,C){const L=M.getFloat32(C.value,!0);return C.value+=4,L}function Ae(M,C){return N2.toHalfFloat(Ne(M,C))}function ae(M){const C=(31744&M)>>10,L=1023&M;return(M>>15?-1:1)*(C?31===C?L?NaN:1/0:Math.pow(2,C-15)*(1+L/1024):L/1024*6103515625e-14)}function Ct(M,C){const L=M.getUint16(C.value,!0);return C.value+=2,L}function Lt(M,C){return ae(Ct(M,C))}function py(M,C,L,H,Y){return"string"===H||"stringvector"===H||"iccProfile"===H?function ue(M,C,L){const H=(new TextDecoder).decode(new Uint8Array(M).slice(C.value,C.value+L));return C.value=C.value+L,H}(C,L,Y):"chlist"===H?function Kn(M,C,L,H){const Y=L.value,X=[];for(;L.value<Y+H-1;){const ie=R(C,L),_e=B(M,L),Se=Xe(M,L);L.value+=3;const de=B(M,L),ge=B(M,L);X.push({name:ie,pixelType:_e,pLinear:Se,xSampling:de,ySampling:ge})}return L.value+=1,X}(M,C,L,Y):"chromaticities"===H?function xr(M,C){return{redX:Ne(M,C),redY:Ne(M,C),greenX:Ne(M,C),greenY:Ne(M,C),blueX:Ne(M,C),blueY:Ne(M,C),whiteX:Ne(M,C),whiteY:Ne(M,C)}}(M,L):"compression"===H?function fy(M,C){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][Xe(M,C)]}(M,L):"box2i"===H?function rM(M,C){return{xMin:pe(M,C),yMin:pe(M,C),xMax:pe(M,C),yMax:pe(M,C)}}(M,L):"lineOrder"===H?function Au(M,C){return["INCREASING_Y"][Xe(M,C)]}(M,L):"float"===H?Ne(M,L):"v2f"===H?function sM(M,C){return[Ne(M,C),Ne(M,C)]}(M,L):"v3f"===H?function qd(M,C){return[Ne(M,C),Ne(M,C),Ne(M,C)]}(M,L):"int"===H?B(M,L):"rational"===H?function Ce(M,C){return[B(M,C),pe(M,C)]}(M,L):"timecode"===H?function Te(M,C){return[pe(M,C),pe(M,C)]}(M,L):"preview"===H?(L.value+=Y,"skipped"):void(L.value+=Y)}const Du=new DataView(e),P=new Uint8Array(e),Z={value:0},J=function oM(M,C,L){const H={};if(20000630!=M.getUint32(0,!0))throw new Error("THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.");H.version=M.getUint8(4);const Y=M.getUint8(5);H.spec={singleTile:!!(2&Y),longName:!!(4&Y),deepFormat:!!(8&Y),multiPart:!!(16&Y)},L.value=8;let X=!0;for(;X;){const ie=R(C,L);if(0==ie)X=!1;else{const _e=R(C,L),de=py(M,C,L,_e,pe(M,L));void 0===de?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${_e}'.`):H[ie]=de}}if(0!=(-5&Y))throw console.error("EXRHeader:",H),new Error("THREE.EXRLoader: provided file is currently unsupported.");return H}(Du,e,Z),q=function aM(M,C,L,H,Y){const X={size:0,viewer:C,array:L,offset:H,width:M.dataWindow.xMax-M.dataWindow.xMin+1,height:M.dataWindow.yMax-M.dataWindow.yMin+1,channels:M.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:M.channels[0].pixelType,uncompress:null,getter:null,format:null,encoding:null};switch(M.compression){case"NO_COMPRESSION":X.lines=1,X.uncompress=A;break;case"RLE_COMPRESSION":X.lines=1,X.uncompress=ee;break;case"ZIPS_COMPRESSION":X.lines=1,X.uncompress=me;break;case"ZIP_COMPRESSION":X.lines=16,X.uncompress=me;break;case"PIZ_COMPRESSION":X.lines=32,X.uncompress=be;break;case"PXR24_COMPRESSION":X.lines=16,X.uncompress=Re;break;case"DWAA_COMPRESSION":X.lines=32,X.uncompress=Je;break;case"DWAB_COMPRESSION":X.lines=256,X.uncompress=Je;break;default:throw new Error("EXRLoader.parse: "+M.compression+" is unsupported")}if(X.scanlineBlockSize=X.lines,1==X.type)switch(Y){case kr:X.getter=Lt,X.inputSize=2;break;case Us:X.getter=Ct,X.inputSize=2}else{if(2!=X.type)throw new Error("EXRLoader.parse: unsupported pixelType "+X.type+" for "+M.compression+".");switch(Y){case kr:X.getter=Ne,X.inputSize=4;break;case Us:X.getter=Ae,X.inputSize=4}}X.blockCount=(M.dataWindow.yMax+1)/X.scanlineBlockSize;for(let _e=0;_e<X.blockCount;_e++)Ee(C,H);X.outputChannels=3==X.channels?4:X.channels;const ie=X.width*X.height*X.outputChannels;switch(Y){case kr:X.byteArray=new Float32Array(ie),X.channels<X.outputChannels&&X.byteArray.fill(1,0,ie);break;case Us:X.byteArray=new Uint16Array(ie),X.channels<X.outputChannels&&X.byteArray.fill(15360,0,ie);break;default:console.error("THREE.EXRLoader: unsupported type: ",Y)}return X.bytesPerLine=X.width*X.inputSize*X.channels,4==X.outputChannels?(X.format=Ti,X.encoding=hs):(X.format=1028,X.encoding=hs),X}(J,Du,P,Z,this.type),le={value:0},nt={R:0,G:1,B:2,A:3,Y:0};for(let M=0;M<q.height/q.scanlineBlockSize;M++){const C=pe(Du,Z);q.size=pe(Du,Z),q.lines=C+q.scanlineBlockSize>q.height?q.height-C:q.scanlineBlockSize;const H=q.size<q.lines*q.bytesPerLine?q.uncompress(q):A(q);Z.value+=q.size;for(let Y=0;Y<q.scanlineBlockSize;Y++){const X=Y+M*q.scanlineBlockSize;if(X>=q.height)break;for(let ie=0;ie<q.channels;ie++){const _e=nt[J.channels[ie].name];for(let Se=0;Se<q.width;Se++)le.value=(Y*(q.channels*q.width)+ie*q.width+Se)*q.inputSize,q.byteArray[q.width*q.outputChannels*(q.height-1-X)+Se*q.outputChannels+_e]=q.getter(H,le)}}}return{header:J,width:q.width,height:q.height,data:q.byteArray,format:q.format,encoding:q.encoding,type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){return super.load(e,function s(o,a){o.encoding=a.encoding,o.minFilter=Kt,o.magFilter=Kt,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)},n,r)}}const eo="srgb",ul="srgb-linear";class Mb{constructor(e=0,t=0,n=0,r=1){this.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const l=e.elements,c=l[0],u=l[4],h=l[8],d=l[1],f=l[5],p=l[9],m=l[2],g=l[6],y=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-m)<.01&&Math.abs(p-g)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+m)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const v=(c+1)/2,x=(f+1)/2,b=(y+1)/2,S=(u+d)/4,E=(h+m)/4,w=(p+g)/4;return v>x&&v>b?v<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(v),r=S/n,s=E/n):x>b?x<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),n=S/r,s=w/r):b<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),n=E/s,r=w/s),this.set(n,r,s,t),this}let _=Math.sqrt((g-p)*(g-p)+(h-m)*(h-m)+(d-u)*(d-u));return Math.abs(_)<.001&&(_=1),this.x=(g-p)/_,this.y=(h-m)/_,this.z=(d-u)/_,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}const Zn=[];for(let i=0;i<256;i++)Zn[i]=(i<16?"0":"")+i.toString(16);const Gg=Math.PI/180,Sb=180/Math.PI;function Od(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Zn[255&i]+Zn[i>>8&255]+Zn[i>>16&255]+Zn[i>>24&255]+"-"+Zn[255&e]+Zn[e>>8&255]+"-"+Zn[e>>16&15|64]+Zn[e>>24&255]+"-"+Zn[63&t|128]+Zn[t>>8&255]+"-"+Zn[t>>16&255]+Zn[t>>24&255]+Zn[255&n]+Zn[n>>8&255]+Zn[n>>16&255]+Zn[n>>24&255]).toLowerCase()}function $i(i,e,t){return Math.max(e,Math.min(t,i))}function Wg(i,e,t){return(1-t)*i+t*e}class Nd{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,s,o,a){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],m=s[o+3];if(0===a)return e[t+0]=l,e[t+1]=c,e[t+2]=u,void(e[t+3]=h);if(1===a)return e[t+0]=d,e[t+1]=f,e[t+2]=p,void(e[t+3]=m);if(h!==m||l!==d||c!==f||u!==p){let g=1-a;const y=l*d+c*f+u*p+h*m,_=y>=0?1:-1,v=1-y*y;if(v>Number.EPSILON){const b=Math.sqrt(v),S=Math.atan2(b,y*_);g=Math.sin(g*S)/b,a=Math.sin(a*S)/b}const x=a*_;if(l=l*g+d*x,c=c*g+f*x,u=u*g+p*x,h=h*g+m*x,g===1-a){const b=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=b,c*=b,u*=b,h*=b}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){const a=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[t]=a*p+u*h+l*f-c*d,e[t+1]=l*p+u*d+c*h-a*f,e[t+2]=c*p+u*f+a*d-l*h,e[t+3]=u*p-a*h-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(n/2),u=a(r/2),h=a(s/2),d=l(n/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h+d*f*p;break;case"YZX":this._x=d*u*h+c*f*p,this._y=c*f*h+d*u*p,this._z=c*u*p-d*f*h,this._w=c*u*h-d*f*p;break;case"XZY":this._x=d*u*h-c*f*p,this._y=c*f*h-d*u*p,this._z=c*u*p+d*f*h,this._w=c*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],c=t[2],u=t[6],h=t[10],d=n+a+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(n>a&&n>h){const f=2*Math.sqrt(1+n-a-h);this._w=(u-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>h){const f=2*Math.sqrt(1+a-n-h);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs($i(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-s*l,this._y=r*u+o*l+s*a-n*c,this._z=s*u+o*c+n*l-r*a,this._w=o*u-n*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,a),h=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class re{constructor(e=0,t=0,n=0){this.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(QL.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(QL.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*t+o*r-a*n,u=l*n+a*t-s*r,h=l*r+s*n-o*t,d=-s*t-o*n-a*r;return this.x=c*l+d*-s+u*-a-h*-o,this.y=u*l+d*-o+h*-s-c*-a,this.z=h*l+d*-a+c*-o-u*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-n*l,this.z=n*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Eb.copy(this).projectOnVector(e),this.sub(Eb)}reflect(e){return this.sub(Eb.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos($i(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-lM(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Eb=new re,QL=new Nd;class Xi{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}function hl(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function jg(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const Cb={[eo]:{[ul]:hl},[ul]:{[eo]:jg}},qr={legacyMode:!0,get workingColorSpace(){return ul},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(Cb[e]&&void 0!==Cb[e][t]){const n=Cb[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},JL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Pn={r:0,g:0,b:0},$r={h:0,s:0,l:0},qg={h:0,s:0,l:0};function Tb(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function $g(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let Ab=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=eo){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,qr.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=ul){return this.r=t,this.g=n,this.b=r,qr.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=ul){if(t=function KL(i,e){return(i%e+e)%e}(t,1),n=$i(n,0,1),r=$i(r,0,1),0===n)this.r=this.g=this.b=r;else{const o=r<=.5?r*(1+n):r+n-r*n,a=2*r-o;this.r=Tb(a,o,t+1/3),this.g=Tb(a,o,t),this.b=Tb(a,o,t-1/3)}return qr.toWorkingColorSpace(this,s),this}setStyle(t,n=eo){function r(o){void 0!==o&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let o;const l=s[2];switch(s[1]){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,qr.toWorkingColorSpace(this,n),r(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,qr.toWorkingColorSpace(this,n),r(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l)){const c=parseFloat(o[1])/360,u=parseInt(o[2],10)/100,h=parseInt(o[3],10)/100;return r(o[4]),this.setHSL(c,u,h,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const o=s[1],a=o.length;if(3===a)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,qr.toWorkingColorSpace(this,n),this;if(6===a)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,qr.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=eo){const r=JL[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=hl(t.r),this.g=hl(t.g),this.b=hl(t.b),this}copyLinearToSRGB(t){return this.r=jg(t.r),this.g=jg(t.g),this.b=jg(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=eo){return qr.fromWorkingColorSpace($g(this,Pn),t),$i(255*Pn.r,0,255)<<16^$i(255*Pn.g,0,255)<<8^$i(255*Pn.b,0,255)<<0}getHexString(t=eo){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=ul){qr.fromWorkingColorSpace($g(this,Pn),n);const r=Pn.r,s=Pn.g,o=Pn.b,a=Math.max(r,s,o),l=Math.min(r,s,o);let c,u;const h=(l+a)/2;if(l===a)c=0,u=0;else{const d=a-l;switch(u=h<=.5?d/(a+l):d/(2-a-l),a){case r:c=(s-o)/d+(s<o?6:0);break;case s:c=(o-r)/d+2;break;case o:c=(r-s)/d+4}c/=6}return t.h=c,t.s=u,t.l=h,t}getRGB(t,n=ul){return qr.fromWorkingColorSpace($g(this,Pn),n),t.r=Pn.r,t.g=Pn.g,t.b=Pn.b,t}getStyle(t=eo){return qr.fromWorkingColorSpace($g(this,Pn),t),t!==eo?`color(${t} ${Pn.r} ${Pn.g} ${Pn.b})`:`rgb(${255*Pn.r|0},${255*Pn.g|0},${255*Pn.b|0})`}offsetHSL(t,n,r){return this.getHSL($r),$r.h+=t,$r.s+=n,$r.l+=r,this.setHSL($r.h,$r.s,$r.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL($r),t.getHSL(qg);const r=Wg($r.h,qg.h,n),s=Wg($r.s,qg.s,n),o=Wg($r.l,qg.l,n);return this.setHSL(r,s,o),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=JL,i})();const En=new re,Xg=new Xi;class to{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new Ab),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Xi),t[n++]=o.x,t[n++]=o.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new re),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let o=e[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new Mb),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Xg.fromBufferAttribute(this,t),Xg.applyMatrix3(e),this.setXY(t,Xg.x,Xg.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)En.fromBufferAttribute(this,t),En.applyMatrix3(e),this.setXYZ(t,En.x,En.y,En.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)En.fromBufferAttribute(this,t),En.applyMatrix4(e),this.setXYZ(t,En.x,En.y,En.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)En.fromBufferAttribute(this,t),En.applyNormalMatrix(e),this.setXYZ(t,En.x,En.y,En.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)En.fromBufferAttribute(this,t),En.transformDirection(e),this.setXYZ(t,En.x,En.y,En.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class kK extends to{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class BK extends to{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Zg extends to{constructor(e,t,n){super(new Float32Array(e),t,n)}}class kd{constructor(e=new re(1/0,1/0,1/0),t=new re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.length;l<c;l+=3){const u=e[l],h=e[l+1],d=e[l+2];u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,c=e.count;l<c;l++){const u=e.getX(l),h=e.getY(l),d=e.getZ(l);u<t&&(t=u),h<n&&(n=h),d<r&&(r=d),u>s&&(s=u),h>o&&(o=h),d>a&&(a=d)}return this.min.set(t,n,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=dl.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let o=0,a=s.count;o<a;o++)dl.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(dl)}else null===n.boundingBox&&n.computeBoundingBox(),Db.copy(n.boundingBox),Db.applyMatrix4(e.matrixWorld),this.union(Db);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,dl),dl.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Bd),Yg.subVectors(this.max,Bd),fu.subVectors(e.a,Bd),pu.subVectors(e.b,Bd),mu.subVectors(e.c,Bd),ea.subVectors(pu,fu),ta.subVectors(mu,pu),fl.subVectors(fu,mu);let t=[0,-ea.z,ea.y,0,-ta.z,ta.y,0,-fl.z,fl.y,ea.z,0,-ea.x,ta.z,0,-ta.x,fl.z,0,-fl.x,-ea.y,ea.x,0,-ta.y,ta.x,0,-fl.y,fl.x,0];return!(!Ib(t,fu,pu,mu,Yg)||(t=[1,0,0,0,1,0,0,0,1],!Ib(t,fu,pu,mu,Yg)))&&(Kg.crossVectors(ea,ta),t=[Kg.x,Kg.y,Kg.z],Ib(t,fu,pu,mu,Yg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return dl.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(dl).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(no[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),no[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),no[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),no[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),no[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),no[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),no[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),no[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(no)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const no=[new re,new re,new re,new re,new re,new re,new re,new re],dl=new re,Db=new kd,fu=new re,pu=new re,mu=new re,ea=new re,ta=new re,fl=new re,Bd=new re,Yg=new re,Kg=new re,pl=new re;function Ib(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){pl.fromArray(i,s);const a=r.x*Math.abs(pl.x)+r.y*Math.abs(pl.y)+r.z*Math.abs(pl.z),l=e.dot(pl),c=t.dot(pl),u=n.dot(pl);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>a)return!1}return!0}class zd{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const zK=new kd,eF=new re,Qg=new re,Rb=new re;class tF{constructor(e=new re,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):zK.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Rb.subVectors(e,this.center);const t=Rb.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Rb.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?Qg.set(0,0,1).multiplyScalar(e.radius):Qg.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(eF.copy(e.center).add(Qg)),this.expandByPoint(eF.copy(e.center).sub(Qg)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}class Zi{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c,u,h,d,f,p,m,g){const y=this.elements;return y[0]=e,y[4]=t,y[8]=n,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=c,y[6]=u,y[10]=h,y[14]=d,y[3]=f,y[7]=p,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Zi).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/gu.setFromMatrixColumn(e,0).length(),s=1/gu.setFromMatrixColumn(e,1).length(),o=1/gu.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if("XYZ"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=-l*h,t[8]=c,t[1]=f+p*c,t[5]=d-m*c,t[9]=-a*l,t[2]=m-d*c,t[6]=p+f*c,t[10]=o*l}else if("YXZ"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d+m*a,t[4]=p*a-f,t[8]=o*c,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-p,t[6]=m+d*a,t[10]=o*l}else if("ZXY"===e.order){const d=l*u,f=l*h,p=c*u,m=c*h;t[0]=d-m*a,t[4]=-o*h,t[8]=p+f*a,t[1]=f+p*a,t[5]=o*u,t[9]=m-d*a,t[2]=-o*c,t[6]=a,t[10]=o*l}else if("ZYX"===e.order){const d=o*u,f=o*h,p=a*u,m=a*h;t[0]=l*u,t[4]=p*c-f,t[8]=d*c+m,t[1]=l*h,t[5]=m*c+d,t[9]=f*c-p,t[2]=-c,t[6]=a*l,t[10]=o*l}else if("YZX"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=m-d*h,t[8]=p*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=f*h+p,t[10]=d-m*h}else if("XZY"===e.order){const d=o*l,f=o*c,p=a*l,m=a*c;t[0]=l*u,t[4]=-h,t[8]=c*u,t[1]=d*h+m,t[5]=o*u,t[9]=f*h-p,t[2]=p*h-f,t[6]=a*u,t[10]=m*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(UK,e,VK)}lookAt(e,t,n){const r=this.elements;return Yi.subVectors(e,t),0===Yi.lengthSq()&&(Yi.z=1),Yi.normalize(),na.crossVectors(n,Yi),0===na.lengthSq()&&(1===Math.abs(n.z)?Yi.x+=1e-4:Yi.z+=1e-4,Yi.normalize(),na.crossVectors(n,Yi)),na.normalize(),Jg.crossVectors(Yi,na),r[0]=na.x,r[4]=Jg.x,r[8]=Yi.x,r[1]=na.y,r[5]=Jg.y,r[9]=Yi.y,r[2]=na.z,r[6]=Jg.z,r[10]=Yi.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],f=n[13],p=n[2],m=n[6],g=n[10],y=n[14],_=n[3],v=n[7],x=n[11],b=n[15],S=r[0],E=r[4],w=r[8],T=r[12],I=r[1],k=r[5],W=r[9],$=r[13],N=r[2],G=r[6],F=r[10],z=r[14],V=r[3],U=r[7],j=r[11],te=r[15];return s[0]=o*S+a*I+l*N+c*V,s[4]=o*E+a*k+l*G+c*U,s[8]=o*w+a*W+l*F+c*j,s[12]=o*T+a*$+l*z+c*te,s[1]=u*S+h*I+d*N+f*V,s[5]=u*E+h*k+d*G+f*U,s[9]=u*w+h*W+d*F+f*j,s[13]=u*T+h*$+d*z+f*te,s[2]=p*S+m*I+g*N+y*V,s[6]=p*E+m*k+g*G+y*U,s[10]=p*w+m*W+g*F+y*j,s[14]=p*T+m*$+g*z+y*te,s[3]=_*S+v*I+x*N+b*V,s[7]=_*E+v*k+x*G+b*U,s[11]=_*w+v*W+x*F+b*j,s[15]=_*T+v*$+x*z+b*te,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],u=e[2],h=e[6],d=e[10],f=e[14];return e[3]*(+s*l*h-r*c*h-s*a*d+n*c*d+r*a*f-n*l*f)+e[7]*(+t*l*f-t*c*d+s*o*d-r*o*f+r*c*u-s*l*u)+e[11]*(+t*c*h-t*a*f-s*o*h+n*o*f+s*a*u-n*c*u)+e[15]*(-r*a*u-t*l*h+t*a*d+r*o*h-n*o*d+n*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],_=h*g*c-m*d*c+m*l*f-a*g*f-h*l*y+a*d*y,v=p*d*c-u*g*c-p*l*f+o*g*f+u*l*y-o*d*y,x=u*m*c-p*h*c+p*a*f-o*m*f-u*a*y+o*h*y,b=p*h*l-u*m*l-p*a*d+o*m*d+u*a*g-o*h*g,S=t*_+n*v+r*x+s*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const E=1/S;return e[0]=_*E,e[1]=(m*d*s-h*g*s-m*r*f+n*g*f+h*r*y-n*d*y)*E,e[2]=(a*g*s-m*l*s+m*r*c-n*g*c-a*r*y+n*l*y)*E,e[3]=(h*l*s-a*d*s-h*r*c+n*d*c+a*r*f-n*l*f)*E,e[4]=v*E,e[5]=(u*g*s-p*d*s+p*r*f-t*g*f-u*r*y+t*d*y)*E,e[6]=(p*l*s-o*g*s-p*r*c+t*g*c+o*r*y-t*l*y)*E,e[7]=(o*d*s-u*l*s+u*r*c-t*d*c-o*r*f+t*l*f)*E,e[8]=x*E,e[9]=(p*h*s-u*m*s-p*n*f+t*m*f+u*n*y-t*h*y)*E,e[10]=(o*m*s-p*a*s+p*n*c-t*m*c-o*n*y+t*a*y)*E,e[11]=(u*a*s-o*h*s-u*n*c+t*h*c+o*n*f-t*a*f)*E,e[12]=b*E,e[13]=(u*m*r-p*h*r+p*n*d-t*m*d-u*n*g+t*h*g)*E,e[14]=(p*a*r-o*m*r-p*n*l+t*m*l+o*n*g-t*a*g)*E,e[15]=(o*h*r-u*a*r+u*n*l-t*h*l-o*n*d+t*a*d)*E,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,l=e.z,c=s*o,u=s*a;return this.set(c*o+n,c*a-r*l,c*l+r*a,0,c*a+r*l,u*a+n,u*l-r*o,0,c*l-r*a,u*l+r*o,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,m=o*u,g=o*h,y=a*h,_=l*c,v=l*u,x=l*h,b=n.x,S=n.y,E=n.z;return r[0]=(1-(m+y))*b,r[1]=(f+x)*b,r[2]=(p-v)*b,r[3]=0,r[4]=(f-x)*S,r[5]=(1-(d+y))*S,r[6]=(g+_)*S,r[7]=0,r[8]=(p+v)*E,r[9]=(g-_)*E,r[10]=(1-(d+m))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=gu.set(r[0],r[1],r[2]).length();const o=gu.set(r[4],r[5],r[6]).length(),a=gu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Xr.copy(this);const c=1/s,u=1/o,h=1/a;return Xr.elements[0]*=c,Xr.elements[1]*=c,Xr.elements[2]*=c,Xr.elements[4]*=u,Xr.elements[5]*=u,Xr.elements[6]*=u,Xr.elements[8]*=h,Xr.elements[9]*=h,Xr.elements[10]*=h,t.setFromRotationMatrix(Xr),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const a=this.elements,c=2*s/(n-r),u=(t+e)/(t-e),h=(n+r)/(n-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=2*s/(t-e),a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,n,r,s,o){const a=this.elements,l=1/(t-e),c=1/(n-r),u=1/(o-s),h=(t+e)*l,d=(n+r)*c,f=(o+s)*u;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const gu=new re,Xr=new Zi,UK=new re(0,0,0),VK=new re(1,1,1),na=new re,Jg=new re,Yi=new re,nF=new Zi,iF=new Nd;let HK=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,o=s[0],a=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],f=s[6],p=s[10];switch(n){case"XYZ":this._y=Math.asin($i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,p),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-$i(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(l,p),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin($i(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,p),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o));break;case"ZYX":this._y=Math.asin(-$i(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,p),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin($i(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(l,p));break;case"XZY":this._z=Math.asin(-$i(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(l,o)):(this._x=Math.atan2(-h,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return nF.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nF,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return iF.setFromEuler(this),this.setFromQuaternion(iF,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class GK{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}class Pb{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,o,a,l,c){const u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=l,u[6]=n,u[7]=o,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],f=n[5],p=n[8],m=r[0],g=r[3],y=r[6],_=r[1],v=r[4],x=r[7],b=r[2],S=r[5],E=r[8];return s[0]=o*m+a*_+l*b,s[3]=o*g+a*v+l*S,s[6]=o*y+a*x+l*E,s[1]=c*m+u*_+h*b,s[4]=c*g+u*v+h*S,s[7]=c*y+u*x+h*E,s[2]=d*m+f*_+p*b,s[5]=d*g+f*v+p*S,s[8]=d*y+f*x+p*E,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*s*u+n*a*l+r*s*c-r*o*l}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=u*o-a*c,d=a*l-u*s,f=c*s-o*l,p=t*h+n*d+r*f;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=h*m,e[1]=(r*c-u*n)*m,e[2]=(a*n-r*o)*m,e[3]=d*m,e[4]=(u*t-r*l)*m,e[5]=(r*s-a*t)*m,e[6]=f*m,e[7]=(n*l-c*t)*m,e[8]=(o*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7];return r[0]=t*s+n*l,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*s+t*l,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let WK=0;const rF=new re,yu=new Nd,io=new Zi,ey=new re,Ud=new re,jK=new re,qK=new Nd,sF=new re(1,0,0),oF=new re(0,1,0),aF=new re(0,0,1),$K={type:"added"},lF={type:"removed"};class ia extends zd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:WK++}),this.uuid=Od(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ia.DefaultUp.clone();const e=new re,t=new HK,n=new Nd,r=new re(1,1,1);t._onChange(function s(){n.setFromEuler(t,!1)}),n._onChange(function o(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Zi},normalMatrix:{value:new Pb}}),this.matrix=new Zi,this.matrixWorld=new Zi,this.matrixAutoUpdate=ia.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new GK,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return yu.setFromAxisAngle(e,t),this.quaternion.multiply(yu),this}rotateOnWorldAxis(e,t){return yu.setFromAxisAngle(e,t),this.quaternion.premultiply(yu),this}rotateX(e){return this.rotateOnAxis(sF,e)}rotateY(e){return this.rotateOnAxis(oF,e)}rotateZ(e){return this.rotateOnAxis(aF,e)}translateOnAxis(e,t){return rF.copy(e).applyQuaternion(this.quaternion),this.position.add(rF.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(sF,e)}translateY(e){return this.translateOnAxis(oF,e)}translateZ(e){return this.translateOnAxis(aF,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(io.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?ey.copy(e):ey.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Ud.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?io.lookAt(Ud,ey,this.up):io.lookAt(ey,Ud,this.up),this.quaternion.setFromRotationMatrix(io),r&&(io.extractRotation(r.matrixWorld),yu.setFromRotationMatrix(io),this.quaternion.premultiply(yu.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent($K)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(lF)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(lF)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),io.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),io.multiply(e.parent.matrixWorld)),e.applyMatrix4(io),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n].getObjectByProperty(e,t);if(void 0!==o)return o}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ud,e,jK),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ud,qK,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(a,l){return void 0===a[l.uuid]&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){const l=a.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++)s(e.shapes,l[c]);else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++)r.animations.push(s(e.animations,this.animations[a]))}if(t){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),u=o(e.images),h=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(n.geometries=a),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),f.length>0&&(n.animations=f),p.length>0&&(n.nodes=p)}return n.object=r,n;function o(a){const l=[];for(const c in a){const u=a[c];delete u.metadata,l.push(u)}return l}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}function cF(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}ia.DefaultUp=new re(0,1,0),ia.DefaultMatrixAutoUpdate=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let YK=0;const vr=new Zi,Lb=new ia,_u=new re,Ki=new kd,Vd=new kd,Vn=new re;class Hd extends zd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:YK++}),this.uuid=Od(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(function XK(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}(e)?BK:kK)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new Pb).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return vr.makeRotationFromQuaternion(e),this.applyMatrix4(vr),this}rotateX(e){return vr.makeRotationX(e),this.applyMatrix4(vr),this}rotateY(e){return vr.makeRotationY(e),this.applyMatrix4(vr),this}rotateZ(e){return vr.makeRotationZ(e),this.applyMatrix4(vr),this}translate(e,t,n){return vr.makeTranslation(e,t,n),this.applyMatrix4(vr),this}scale(e,t,n){return vr.makeScale(e,t,n),this.applyMatrix4(vr),this}lookAt(e){return Lb.lookAt(e),Lb.updateMatrix(),this.applyMatrix4(Lb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_u).negate(),this.translate(_u.x,_u.y,_u.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Zg(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new kd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new re(-1/0,-1/0,-1/0),new re(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)Ki.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(Vn.addVectors(this.boundingBox.min,Ki.min),this.boundingBox.expandByPoint(Vn),Vn.addVectors(this.boundingBox.max,Ki.max),this.boundingBox.expandByPoint(Vn)):(this.boundingBox.expandByPoint(Ki.min),this.boundingBox.expandByPoint(Ki.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new tF);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new re,1/0);if(e){const n=this.boundingSphere.center;if(Ki.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++)Vd.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(Vn.addVectors(Ki.min,Vd.min),Ki.expandByPoint(Vn),Vn.addVectors(Ki.max,Vd.max),Ki.expandByPoint(Vn)):(Ki.expandByPoint(Vd.min),Ki.expandByPoint(Vd.max));Ki.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)Vn.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Vn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let c=0,u=a.count;c<u;c++)Vn.fromBufferAttribute(a,c),l&&(_u.fromBufferAttribute(e,c),Vn.add(_u)),r=Math.max(r,n.distanceToSquared(Vn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new to(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let I=0;I<a;I++)c[I]=new re,u[I]=new re;const h=new re,d=new re,f=new re,p=new Xi,m=new Xi,g=new Xi,y=new re,_=new re;function v(I,k,W){h.fromArray(r,3*I),d.fromArray(r,3*k),f.fromArray(r,3*W),p.fromArray(o,2*I),m.fromArray(o,2*k),g.fromArray(o,2*W),d.sub(h),f.sub(h),m.sub(p),g.sub(p);const $=1/(m.x*g.y-g.x*m.y);!isFinite($)||(y.copy(d).multiplyScalar(g.y).addScaledVector(f,-m.y).multiplyScalar($),_.copy(f).multiplyScalar(m.x).addScaledVector(d,-g.x).multiplyScalar($),c[I].add(y),c[k].add(y),c[W].add(y),u[I].add(_),u[k].add(_),u[W].add(_))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let I=0,k=x.length;I<k;++I){const W=x[I],$=W.start;for(let G=$,F=$+W.count;G<F;G+=3)v(n[G+0],n[G+1],n[G+2])}const b=new re,S=new re,E=new re,w=new re;function T(I){E.fromArray(s,3*I),w.copy(E);const k=c[I];b.copy(k),b.sub(E.multiplyScalar(E.dot(k))).normalize(),S.crossVectors(w,k);const $=S.dot(u[I])<0?-1:1;l[4*I]=b.x,l[4*I+1]=b.y,l[4*I+2]=b.z,l[4*I+3]=$}for(let I=0,k=x.length;I<k;++I){const W=x[I],$=W.start;for(let G=$,F=$+W.count;G<F;G+=3)T(n[G+0]),T(n[G+1]),T(n[G+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new to(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);const r=new re,s=new re,o=new re,a=new re,l=new re,c=new re,u=new re,h=new re;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),m=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),o.fromBufferAttribute(t,g),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,g),a.add(u),l.add(u),c.add(u),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const o=n[r].array,a=e.attributes[r],l=a.array,c=a.itemSize*t,u=Math.min(l.length,o.length-c);for(let h=0,d=c;h<u;h++,d++)o[d]=l[h]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Vn.fromBufferAttribute(e,t),Vn.normalize(),e.setXYZ(t,Vn.x,Vn.y,Vn.z)}toNonIndexed(){function e(a,l){const c=a.array,u=a.itemSize,h=a.normalized,d=new c.constructor(l.length*u);let f=0,p=0;for(let m=0,g=l.length;m<g;m++){f=a.isInterleavedBufferAttribute?l[m]*a.data.stride+a.offset:l[m]*u;for(let y=0;y<u;y++)d[p++]=c[f++]}return new to(d,u,h)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Hd,n=this.index.array,r=this.attributes;for(const a in r){const c=e(r[a],n);t.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let u=0,h=c.length;u<h;u++){const f=e(c[u],n);l.push(f)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const l=this.parameters;for(const c in l)void 0!==l[c]&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n)e.data.attributes[l]=n[l].toJSON(e.data);const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++)u.push(c[h].toJSON(e.data));u.length>0&&(r[l]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return null!==a&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const c in r)this.setAttribute(c,r[c].clone(t));const s=e.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;null!==a&&(this.boundingBox=a.clone());const l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const ro=new re,Fb=new re,ty=new re,ra=new re,Ob=new re,ny=new re,Nb=new re;class KK{constructor(e=new re,t=new re(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ro)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ro.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ro.copy(this.direction).multiplyScalar(t).add(this.origin),ro.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){Fb.copy(e).add(t).multiplyScalar(.5),ty.copy(t).sub(e).normalize(),ra.copy(this.origin).sub(Fb);const s=.5*e.distanceTo(t),o=-this.direction.dot(ty),a=ra.dot(this.direction),l=-ra.dot(ty),c=ra.lengthSq(),u=Math.abs(1-o*o);let h,d,f,p;if(u>0)if(h=o*l-a,d=o*a-l,p=s*u,h>=0)if(d>=-p)if(d<=p){const m=1/u;h*=m,d*=m,f=h*(h+o*d+2*a)+d*(o*h+d+2*l)+c}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;else d<=-p?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c):d<=p?(h=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-l),s),f=-h*h+d*(d+2*l)+c);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*l)+c;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),r&&r.copy(ty).multiplyScalar(d).add(Fb),f}intersectSphere(e,t){ro.subVectors(e.center,this.origin);const n=ro.dot(this.direction),r=ro.dot(ro)-n*n,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=n-o,l=n+o;return a<0&&l<0?null:this.at(a<0?l:a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||n!=n)&&(n=s),(o<r||r!=r)&&(r=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),n>l||a>r)||((a>n||n!=n)&&(n=a),(l<r||r!=r)&&(r=l),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,ro)}intersectTriangle(e,t,n,r,s){Ob.subVectors(t,e),ny.subVectors(n,e),Nb.crossVectors(Ob,ny);let a,o=this.direction.dot(Nb);if(o>0){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ra.subVectors(this.origin,e);const l=a*this.direction.dot(ny.crossVectors(ra,ny));if(l<0)return null;const c=a*this.direction.dot(Ob.cross(ra));if(c<0||l+c>o)return null;const u=-a*ra.dot(Nb);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}const Zr=new re,so=new re,kb=new re,oo=new re,vu=new re,xu=new re,uF=new re,Bb=new re,zb=new re,Ub=new re;class ao{constructor(e=new re,t=new re,n=new re){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Zr.subVectors(e,t),r.cross(Zr);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Zr.subVectors(r,t),so.subVectors(n,t),kb.subVectors(e,t);const o=Zr.dot(Zr),a=Zr.dot(so),l=Zr.dot(kb),c=so.dot(so),u=so.dot(kb),h=o*c-a*a;if(0===h)return s.set(-2,-1,-1);const d=1/h,f=(c*l-a*u)*d,p=(o*u-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,oo),oo.x>=0&&oo.y>=0&&oo.x+oo.y<=1}static getUV(e,t,n,r,s,o,a,l){return this.getBarycoord(e,t,n,r,oo),l.set(0,0),l.addScaledVector(s,oo.x),l.addScaledVector(o,oo.y),l.addScaledVector(a,oo.z),l}static isFrontFacing(e,t,n,r){return Zr.subVectors(n,t),so.subVectors(e,t),Zr.cross(so).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Zr.subVectors(this.c,this.b),so.subVectors(this.a,this.b),.5*Zr.cross(so).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ao.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return ao.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return ao.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return ao.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ao.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let o,a;vu.subVectors(r,n),xu.subVectors(s,n),Bb.subVectors(e,n);const l=vu.dot(Bb),c=xu.dot(Bb);if(l<=0&&c<=0)return t.copy(n);zb.subVectors(e,r);const u=vu.dot(zb),h=xu.dot(zb);if(u>=0&&h<=u)return t.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return o=l/(l-u),t.copy(n).addScaledVector(vu,o);Ub.subVectors(e,s);const f=vu.dot(Ub),p=xu.dot(Ub);if(p>=0&&f<=p)return t.copy(s);const m=f*c-l*p;if(m<=0&&c>=0&&p<=0)return a=c/(c-p),t.copy(n).addScaledVector(xu,a);const g=u*p-f*h;if(g<=0&&h-u>=0&&f-p>=0)return uF.subVectors(s,r),a=(h-u)/(h-u+(f-p)),t.copy(r).addScaledVector(uF,a);const y=1/(g+m+d);return o=m*y,a=d*y,t.copy(n).addScaledVector(vu,o).addScaledVector(xu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let QK=0,hF=(()=>{class i extends zd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:QK++}),this.uuid=Od(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const n in t){const r=t[n];if(void 0===r){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if("shading"===n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const s=this[n];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.")}}toJSON(t){const n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(o){const a=[];for(const l in o){const c=o[l];delete c.metadata,a.push(c)}return a}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){const o=s(t.textures),a=s(t.images);o.length>0&&(r.textures=o),a.length>0&&(r.images=a)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(null!==n){const s=n.length;r=new Array(s);for(let o=0;o!==s;++o)r[o]=n[o].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}return i.fromType=function(){return null},i})();class dF extends hF{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ab(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const fF=new Zi,wu=new KK,Vb=new tF,sa=new re,oa=new re,aa=new re,Hb=new re,Gb=new re,Wb=new re,iy=new re,ry=new re,sy=new re,oy=new Xi,ay=new Xi,ly=new Xi,jb=new re,cy=new re;class uy extends ia{constructor(e=new Hd,t=new dF){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),Vb.copy(n.boundingSphere),Vb.applyMatrix4(s),!1===e.ray.intersectsSphere(Vb))||(fF.copy(s).invert(),wu.copy(e.ray).applyMatrix4(fF),null!==n.boundingBox&&!1===wu.intersectsBox(n.boundingBox)))return;let o;const a=n.index,l=n.attributes.position,c=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,d=n.attributes.uv2,f=n.groups,p=n.drawRange;if(null!==a)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const y=f[m],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(a.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3){const E=a.getX(b),w=a.getX(b+1),T=a.getX(b+2);o=hy(this,_,e,wu,l,c,u,h,d,E,w,T),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}}else for(let y=Math.max(0,p.start),_=Math.min(a.count,p.start+p.count);y<_;y+=3){const v=a.getX(y),x=a.getX(y+1),b=a.getX(y+2);o=hy(this,r,e,wu,l,c,u,h,d,v,x,b),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}else if(void 0!==l)if(Array.isArray(r))for(let m=0,g=f.length;m<g;m++){const y=f[m],_=r[y.materialIndex];for(let b=Math.max(y.start,p.start),S=Math.min(l.count,Math.min(y.start+y.count,p.start+p.count));b<S;b+=3)o=hy(this,_,e,wu,l,c,u,h,d,b,b+1,b+2),o&&(o.faceIndex=Math.floor(b/3),o.face.materialIndex=y.materialIndex,t.push(o))}else for(let y=Math.max(0,p.start),_=Math.min(l.count,p.start+p.count);y<_;y+=3)o=hy(this,r,e,wu,l,c,u,h,d,y,y+1,y+2),o&&(o.faceIndex=Math.floor(y/3),t.push(o))}}function hy(i,e,t,n,r,s,o,a,l,c,u,h){sa.fromBufferAttribute(r,c),oa.fromBufferAttribute(r,u),aa.fromBufferAttribute(r,h);const d=i.morphTargetInfluences;if(s&&d){iy.set(0,0,0),ry.set(0,0,0),sy.set(0,0,0);for(let p=0,m=s.length;p<m;p++){const g=d[p],y=s[p];0!==g&&(Hb.fromBufferAttribute(y,c),Gb.fromBufferAttribute(y,u),Wb.fromBufferAttribute(y,h),o?(iy.addScaledVector(Hb,g),ry.addScaledVector(Gb,g),sy.addScaledVector(Wb,g)):(iy.addScaledVector(Hb.sub(sa),g),ry.addScaledVector(Gb.sub(oa),g),sy.addScaledVector(Wb.sub(aa),g)))}sa.add(iy),oa.add(ry),aa.add(sy)}i.isSkinnedMesh&&(i.boneTransform(c,sa),i.boneTransform(u,oa),i.boneTransform(h,aa));const f=function JK(i,e,t,n,r,s,o,a){let l;if(l=1===e.side?n.intersectTriangle(o,s,r,!0,a):n.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;cy.copy(a),cy.applyMatrix4(i.matrixWorld);const c=t.ray.origin.distanceTo(cy);return c<t.near||c>t.far?null:{distance:c,point:cy.clone(),object:i}}(i,e,t,n,sa,oa,aa,jb);if(f){a&&(oy.fromBufferAttribute(a,c),ay.fromBufferAttribute(a,u),ly.fromBufferAttribute(a,h),f.uv=ao.getUV(jb,sa,oa,aa,oy,ay,ly,new Xi)),l&&(oy.fromBufferAttribute(l,c),ay.fromBufferAttribute(l,u),ly.fromBufferAttribute(l,h),f.uv2=ao.getUV(jb,sa,oa,aa,oy,ay,ly,new Xi));const p={a:c,b:u,c:h,normal:new re,materialIndex:0};ao.getNormal(sa,oa,aa,p.normal),f.face=p}return f}class pF extends ia{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Zi,this.projectionMatrix=new Zi,this.projectionMatrixInverse=new Zi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class eQ extends pF{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,o=n+e,a=r+t,l=r-t;if(null!==this.view&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=u*this.view.offsetY,l=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class tQ extends pF{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*Sb*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Gg*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*Sb*Math.atan(Math.tan(.5*Gg*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Gg*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const o=this.view;if(null!==this.view&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*n/c,r*=o.width/l,n*=o.height/c}const a=this.filmOffset;0!==a&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class $b extends hF{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",this.fragmentShader="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=function qb(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;t.uniforms[r]=o&&o.isTexture?{type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?{type:"c",value:o.getHex()}:o&&o.isVector2?{type:"v2",value:o.toArray()}:o&&o.isVector3?{type:"v3",value:o.toArray()}:o&&o.isVector4?{type:"v4",value:o.toArray()}:o&&o.isMatrix3?{type:"m3",value:o.toArray()}:o&&o.isMatrix4?{type:"m4",value:o.toArray()}:{value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}let bu;class mF{constructor(e=null){this.isSource=!0,this.uuid=Od(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)s.push(Xb(r[o].isDataTexture?r[o].image:r[o]))}else s=Xb(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function Xb(i){return"undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&i instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap?class sQ{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===bu&&(bu=cF("canvas")),bu.width=e.width,bu.height=e.height;const n=bu.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=bu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=cF("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=255*hl(s[o]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*hl(t[n]/255)):hl(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let oQ=0,aQ=(()=>{class i extends zd{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=1001,s=1001,o=1006,a=1008,l=1023,c=1009,u=1,h=3e3){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:oQ++}),this.uuid=Od(),this.name="",this.source=new mF(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=c,this.offset=new Xi(0,0),this.repeat=new Xi(1,1),this.center=new Xi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pb,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case 1001:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case 1001:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i})();class lQ extends zd{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Mb(0,0,e,t),this.scissorTest=!1,this.viewport=new Mb(0,0,e,t),this.texture=new aQ({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:1006,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new mF(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Zb extends Hd{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],u=[],h=[];let d=0,f=0;function p(m,g,y,_,v,x,b,S,E,w,T){const I=x/E,k=b/w,W=x/2,$=b/2,N=S/2,G=E+1,F=w+1;let z=0,V=0;const U=new re;for(let j=0;j<F;j++){const te=j*k-$;for(let Q=0;Q<G;Q++)U[m]=(Q*I-W)*_,U[g]=te*v,U[y]=N,c.push(U.x,U.y,U.z),U[m]=0,U[g]=0,U[y]=S>0?1:-1,u.push(U.x,U.y,U.z),h.push(Q/E),h.push(1-j/w),z+=1}for(let j=0;j<w;j++)for(let te=0;te<E;te++){const he=d+te+G*(j+1),ce=d+(te+1)+G*(j+1),De=d+(te+1)+G*j;l.push(d+te+G*j,he,De),l.push(he,ce,De),V+=6}a.addGroup(f,V,T),f+=V,d+=z}p("z","y","x",-1,-1,n,t,e,o,s,0),p("z","y","x",1,-1,n,t,-e,o,s,1),p("x","z","y",1,1,e,n,t,r,o,2),p("x","z","y",1,-1,e,n,-t,r,o,3),p("x","y","z",1,-1,e,t,n,r,s,4),p("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new Zg(c,3)),this.setAttribute("normal",new Zg(u,3)),this.setAttribute("uv",new Zg(h,2))}static fromJSON(e){return new Zb(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}const gF=[.125,.215,.35,.446,.526,.582],Yb=new eQ,yF=new Ab;let Kb=null;const gl=(1+Math.sqrt(5))/2,Su=1/gl,_F=[new re(1,1,1),new re(-1,1,1),new re(1,1,-1),new re(-1,1,-1),new re(0,gl,Su),new re(0,gl,-Su),new re(Su,0,gl),new re(-Su,0,gl),new re(gl,Su,0),new re(-gl,Su,0)];class cQ{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Kb=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=wF(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=xF(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Kb),e.scissorTest=!1,dy(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),Kb=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,encoding:3e3,depthBuffer:!1},r=vF(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=vF(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function uQ(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+gF.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>i-4?l=gF[o-i+4-1]:0===o&&(l=0),n.push(l);const c=1/(a-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,m=3,g=2,y=1,_=new Float32Array(m*p*f),v=new Float32Array(g*p*f),x=new Float32Array(y*p*f);for(let S=0;S<f;S++){const E=S%3*2/3-1,w=S>2?0:-1;_.set([E,w,0,E+2/3,w,0,E+2/3,w+1,0,E,w,0,E+2/3,w+1,0,E,w+1,0],m*p*S),v.set(d,g*p*S),x.set([S,S,S,S,S,S],y*p*S)}const b=new Hd;b.setAttribute("position",new to(_,m)),b.setAttribute("uv",new to(v,g)),b.setAttribute("faceIndex",new to(x,y)),e.push(b),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function hQ(i,e,t){const n=new Float32Array(20),r=new re(0,1,0);return new $b({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new uy(this._lodPlanes[0],e);this._renderer.compile(t,Yb)}_sceneToCubeUV(e,t,n,r){const a=new tQ(90,1,t,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(yF),u.toneMapping=0,u.autoClear=!1;const f=new dF({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),p=new uy(new Zb,f);let m=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,m=!0):(f.color.copy(yF),m=!0);for(let y=0;y<6;y++){const _=y%3;0===_?(a.up.set(0,l[y],0),a.lookAt(c[y],0,0)):1===_?(a.up.set(0,0,l[y]),a.lookAt(0,c[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,c[y]));const v=this._cubeSize;dy(r,_*v,y>2?v:0,v,v),u.setRenderTarget(r),m&&u.render(p,a),u.render(e,a)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=g}_textureToCubeUV(e,t){const n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=wF()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=xF());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new uy(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const l=this._cubeSize;dy(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(o,Yb)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,_F[(r-1)%_F.length])}t.autoClear=n}_blur(e,t,n,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){const l=this._renderer,c=this._blurMaterial;"latitudinal"!==o&&"longitudinal"!==o&&console.error("blur direction must be either latitudinal or longitudinal!");const h=new uy(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[n]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/39,m=s/p,g=isFinite(s)?1+Math.floor(3*m):20;g>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to 20`);const y=[];let _=0;for(let E=0;E<20;++E){const w=E/m,T=Math.exp(-w*w/2);y.push(T),0===E?_+=T:E<g&&(_+=2*T)}for(let E=0;E<y.length;E++)y[E]=y[E]/_;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=y,d.latitudinal.value="latitudinal"===o,a&&(d.poleAxis.value=a);const{_lodMax:v}=this;d.dTheta.value=p,d.mipInt.value=v-n;const x=this._sizeLods[r];dy(t,3*x*(r>v-4?r-v+4:0),4*(this._cubeSize-x),3*x,2*x),l.setRenderTarget(t),l.render(h,Yb)}}function vF(i,e,t){const n=new lQ(i,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function dy(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function xF(){return new $b({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function wF(){return new $b({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}class dQ{constructor(e){this.environments=new Map,this.productConfigurator=e}loadEnvironment(e){if(this.environments.has(e))return this.environments.get(e);const t=new Promise(n=>{const r=this.productConfigurator.renderer;(new MK).load(e,s=>{s.minFilter=pn,s.encoding=hs;const o=new cQ(r),a=o.fromEquirectangular(s);s.dispose(),o.dispose(),n(a)},Dg(this.productConfigurator.productConfiguratorService))});return this.environments.set(e,t),t}}class fQ{constructor(e){this.productConfigurator=e,this.productConfigurator=e,this.productConfiguratorService=this.productConfigurator.productConfiguratorService,this.environmentMapLoader=new dQ(e),this.productConfiguratorService.toolbarChangeProduct.subscribe(t=>this.changeProduct(t))}changeProduct(e){return ha(this,void 0,void 0,function*(){if(this.productConfiguratorService.selectedProduct===e)return;const t=this.productConfiguratorService.selectedProduct;t&&t.object3D&&this.productConfigurator.scene.remove(t.object3D),this.productConfiguratorService.selectedProduct=e;const n=new iK(this.productConfiguratorService,this.environmentMapLoader);let r=e.object3D;if(!r){this.productConfiguratorService.loadingStarted.next(),r=new sn;const o=[];for(const l of e.models)o.push(n.loadMesh(l));const a=yield Promise.all(o);for(const l of a)!l.object||(this.setMeshTransform(l.object,l.model),r.attach(l.object));this.setObjectAtOrigin(r),this.productConfiguratorService.loadingFinished.next(),e.object3D=r}if(this.productConfiguratorService.selectedProduct!==e)return;this.productConfigurator.scene.add(r),this.updateCameraPosition(r,e.hasFloor);const s=["model",e.name];e.selectedSubItem&&s.push(e.selectedSubItem.id.toString()),this.productConfiguratorService.selectedProductChanged.next(this.productConfiguratorService.selectedProduct),this.productConfigurator.router.navigate(s).then()})}setMeshTransform(e,t){t.position&&e.position.add(t.position),t.rotation&&e.rotation.copy(t.rotation),t.scale&&e.scale.copy(t.scale)}setObjectAtOrigin(e){const n=(new Hs).setFromObject(e).getCenter(new D);e.position.x=e.position.x-n.x,e.position.y=e.position.y-n.y,e.position.z=e.position.z-n.z}updateCameraPosition(e,t){const n=this.productConfigurator.camera,r=this.productConfigurator.cameraControls,o=(new Hs).setFromObject(e).getSize(new D).length();n.near=o/100,n.far=100*o,n.updateProjectionMatrix(),r.maxDistance=1.15*o,r.minDistance=1.15*o,r.update(),r.maxDistance=1.5*o,r.minDistance=.55*o,r.maxPolarAngle=t?.5*Math.PI:Math.PI,r.update()}}var li=(()=>{return(i=li||(li={}))[i.None=0]="None",i[i.Linear=1]="Linear",i[i.FromTopToBottom=2]="FromTopToBottom",li;var i})();function bF(i,e,t,n,r,s){let o=!1,a=Date.now(),l=0;const c=()=>{if(o)return;const f=Date.now();l+=f-a,a=f;let p=Math.min(l/t,1);s&&(p=s(p)),n(p),p<1?requestAnimationFrame(c):h(!0)},h=f=>{const p=i.activeEvents.indexOf(d);-1!==p&&i.activeEvents.splice(p,1),null==r||r(o,f)},d={cancelEvent:f=>{o=!0,f&&n(1),h(f)},type:e};return i.activeEvents.push(d),c}var lo=(()=>{return(i=lo||(lo={}))[i.ColorChange=0]="ColorChange",i[i.TextureChange=1]="TextureChange",lo;var i})();function Jb(i,e,t){for(let n=0;n<i.activeEvents.length;){const r=i.activeEvents[n];e.includes(r.type)?(r.cancelEvent(t),i.activeEvents.splice(n,1)):n++}}class gQ{constructor(e){this.productConfiguratorService=e,e.materialTextureSwap.subscribe(t=>{this.swapTexture(t)})}swapTexture(e){var t;if(e.productItem.object3D)switch(Jb(e.productItem,[lo.TextureChange],!0),e.animationType){case li.None:this.changeTexture(e,0);break;case li.Linear:this.changeTexture(e,250);break;case li.FromTopToBottom:this.changeTexture(e,500)}else null===(t=e.onLoaded)||void 0===t||t.call(e)}loadTexture(e,t){e.addGlobalLoadingEvent&&this.productConfiguratorService.loadingStarted.next();const n=e.addGlobalLoadingEvent?Dg(this.productConfiguratorService):void 0;(new xg).load(e.textureUrl,r=>{var s;e.addGlobalLoadingEvent&&this.productConfiguratorService.loadingFinished.next(),null===(s=e.onLoaded)||void 0===s||s.call(e),t(r)},n)}changeTexture(e,t){const n=function pQ(i,e){const t={cancelEvent:()=>{const n=i.activeEvents.indexOf(t);-1!==n&&i.activeEvents.splice(n)},type:e};return i.activeEvents.push(t),t}(e.productItem,lo.TextureChange);this.loadTexture(e,r=>{const s=e.productItem.activeEvents.indexOf(n);if(-1===s)return;e.productItem.activeEvents.splice(s,1);const o=this.getMaterials(e,r);if(0===t||0===o.length){for(const x of o)x.material[e.textureSlot]=r;return}let a=document.createElement("canvas"),l=a.getContext("2d");const c=(x,b)=>{if(a.width=1,a.height=1,null==l||l.clearRect(0,0,1,1),a=void 0,l=null,null==u||u.dispose(),!x||b){g&&g.drawImage(f,0,0);for(const S of o)S.material[e.textureSlot]=r}else for(const S of o)S.material[e.textureSlot]=S.originalTexture};l||c(!1,!0);const u=new $X(a),h=o[0].originalTexture;u.flipY=h.flipY;const d=h.image,f=r.image,p=d.naturalWidth||d.width,m=d.naturalHeight||d.height;a.width=p,a.height=m;const{debugCanvasContext:g}=this.trySetupDebugCanvas(a),y=this.getRenderMethod(e.animationType);l.drawImage(d,0,0);for(const x of o)x.material[e.textureSlot]=u;const v=bF(e.productItem,lo.TextureChange,t,x=>{y(l,x,p,m,d,f),g&&g.drawImage(a,0,0),u.needsUpdate=!0},c);requestAnimationFrame(v)})}getMaterials(e,t){const n=[];if(e.materials)for(const r of e.materials)r[e.textureSlot]&&(n.push({material:r,originalTexture:r[e.textureSlot]}),t.flipY=r[e.textureSlot].flipY);else e.productItem.object3D.traverse(r=>{const s=r;if(!s.isMesh)return;const o=Array.isArray(s.material)?s.material:[s.material];for(const a of o)a[e.textureSlot]&&(n.push({material:a,originalTexture:a[e.textureSlot]}),t.flipY=a[e.textureSlot].flipY)});return n}getRenderMethod(e){switch(e){case li.Linear:return this.renderLinearly;case li.FromTopToBottom:return this.renderFromTopToBottom;default:return()=>{}}}renderLinearly(e,t,n,r,s,o){e.clearRect(0,0,n,r),e.globalAlpha=1-t,e.drawImage(s,0,0),e.globalAlpha=t,e.drawImage(o,0,0)}renderFromTopToBottom(e,t,n,r,s,o){e.clearRect(0,0,n,r),e.drawImage(s,0,0),e.save(),e.beginPath(),e.rect(0,0,t*n,t*r),e.clip(),e.drawImage(o,0,0,n,r),e.restore()}trySetupDebugCanvas(e){return{debugCanvasElement:undefined,debugCanvasContext:undefined}}}function MF(i,e){let t,r,n=!1;return function(...o){r=o,t?n=!0:(i(...o),t=!0,s())};function s(){setTimeout(function(){n?(i(...r),n=!1,s()):t=!1},e)}}class _Q{constructor(e,t){this.productConfiguratorService=e,this.selectedProductMeshIntersector=t,this.pointerPosition=new ne,this.pointerdownPosition=void 0,this.onPointerDown=n=>{this.pointerdownPosition={x:n.clientX,y:n.clientY}},this.onPointerUp=n=>{if(this.pointerdownPosition){const s=n.clientY-this.pointerdownPosition.y;Math.pow(n.clientX-this.pointerdownPosition.x,2)+Math.pow(s,2)<5&&this.onClick(n)}this.pointerdownPosition=void 0},this.onPointerMove=MF(n=>{this.pointerdownPosition||this.trySetMeshAndEmitEvents(n,this.productConfiguratorService.meshPointerEnter,"currentHoveredMesh",this.tryDeselectCurrentHoveredMesh)},1e3/60),this.onPointerLeave=()=>{this.tryDeselectCurrentHoveredMesh(),this.pointerdownPosition=void 0},this.productConfiguratorService.selectedProductChanged.subscribe(()=>{this.tryDeselectCurrentHoveredMesh(),this.tryDeselectCurrentMesh()})}initPointerEvents(e){this.element=e,e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointerup",this.onPointerUp),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerleave",this.onPointerLeave)}removePointerEvents(){this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointermove",this.onPointerMove),this.element.removeEventListener("pointerleave",this.onPointerLeave)}onClick(e){"mouse"===e.pointerType&&0!==e.button||this.trySetMeshAndEmitEvents(e,this.productConfiguratorService.meshSelected,"currentSelectedMesh",this.tryDeselectCurrentMesh)}trySetMeshAndEmitEvents(e,t,n,r){const s=this.getIntersections(e);if(0===s.length)return void(this[n]&&r.call(this));const o=s[0].object;if(this[n]){if(o===this[n])return;r.call(this)}!function yQ(i){return i.isMesh}(o)||(this[n]=o,t.next(o))}setPointerPosition(e){this.pointerPosition.x=e.clientX/this.element.offsetWidth*2-1,this.pointerPosition.y=-e.clientY/this.element.offsetHeight*2+1}getIntersections(e){return this.setPointerPosition(e),this.selectedProductMeshIntersector.getIntersections(this.pointerPosition)}tryDeselectCurrentHoveredMesh(){!this.currentHoveredMesh||(this.productConfiguratorService.meshPointerLeave.next(this.currentHoveredMesh),this.currentHoveredMesh=void 0)}tryDeselectCurrentMesh(){!this.currentSelectedMesh||(this.productConfiguratorService.meshDeselected.next(this.currentSelectedMesh),this.currentSelectedMesh=void 0)}}class vQ{constructor(e,t){this.productConfiguratorService=t,this.subscriptions=[],this.subscriptions.push(this.productConfiguratorService.meshPointerEnter.subscribe(n=>{this.hoveredMesh=n,this.setHoverMaterial(n)}),this.productConfiguratorService.meshPointerLeave.subscribe(n=>{this.hoveredMesh=void 0,this.clearHoverMaterial(n)}),this.productConfiguratorService.meshSelected.subscribe(n=>{this.selectedMesh=n,this.setSelectedMaterial(n)}),this.productConfiguratorService.meshDeselected.subscribe(n=>{this.selectedMesh=void 0,this.clearSelectedMaterial(n)}))}dispose(){this.subscriptions.forEach(e=>e.unsubscribe()),this.hoveredMesh=void 0,this.selectedMesh=void 0}isAnyProductHighlighted(){return!(!this.hoveredMesh&&!this.selectedMesh)}setSelectedMaterial(e){this.enableLayer(e,2),this.hoveredMesh&&this.areMeshOrSiblingsEqual(e,this.hoveredMesh)&&this.clearHoverMaterial(this.hoveredMesh)}clearSelectedMaterial(e){this.disableLayer(e,2),this.hoveredMesh&&this.areMeshOrSiblingsEqual(e,this.hoveredMesh)&&this.setHoverMaterial(this.hoveredMesh)}setHoverMaterial(e){this.selectedMesh&&this.areMeshOrSiblingsEqual(e,this.selectedMesh)||this.enableLayer(e,1)}clearHoverMaterial(e){this.disableLayer(e,1)}areMeshOrSiblingsEqual(e,t){var n,r,s,o;if(e===t)return!0;const a=[e,...null!==(r=null===(n=e.userData)||void 0===n?void 0:n.siblings)&&void 0!==r?r:[]],l=[t,...null!==(o=null===(s=t.userData)||void 0===s?void 0:s.siblings)&&void 0!==o?o:[]];return a.some(c=>l.some(u=>u===c))}enableLayer(e,t){e.layers.enable(t);const n=e.userData;if(Array.isArray(null==n?void 0:n.siblings))for(const r of n.siblings)r.layers.enable(t)}disableLayer(e,t){e.layers.disable(t);const n=e.userData;if(Array.isArray(null==n?void 0:n.siblings))for(const r of n.siblings)r.layers.disable(t)}}class xQ{constructor(e,t){this.camera=e,this.productConfiguratorService=t,this.raycaster=new mY,this.intersectableObjects=[],this.subscriptions=[],this.subscriptions.push(this.productConfiguratorService.selectedProductChanged.subscribe(n=>{if(n.selectableMeshIntersections)this.intersectableObjects=n.selectableMeshIntersections;else if(this.intersectableObjects=[],n.object3D&&Array.isArray(n.selectableMeshesOptions)){for(const r of n.selectableMeshesOptions)this.parseSelectableMeshesOption(n,r);n.selectableMeshIntersections=this.intersectableObjects}}))}dispose(){this.subscriptions.forEach(e=>e.unsubscribe()),this.subscriptions=[]}getIntersections(e){return this.raycaster.far=this.camera.far,this.raycaster.setFromCamera(e,this.camera),this.raycaster.intersectObjects(this.intersectableObjects,!1)}parseSelectableMeshesOption(e,t){const n=[];if(e.object3D.traverse(r=>{const s=r;!s.isMesh||Array.isArray(t.excludeMeshes)&&t.excludeMeshes.includes(s.name)||Array.isArray(t.includedMeshes)&&!t.includedMeshes.includes(s.name)||(s.userData.selectableMeshesOption=t.options,n.push(s))}),!t.noSiblings)for(const r of n)r.userData.siblings=n.filter(o=>o!==r);for(const r of n)-1===this.intersectableObjects.indexOf(r)&&this.intersectableObjects.push(r)}}function Gd(i){return Array.isArray(i.material)?i.material:[i.material]}function SF(i){const e=[];for(const t of i)e.push(...Gd(t));return e}class MQ{constructor(e){this.productConfiguratorService=e,e.materialColorSwap.subscribe(t=>{switch(t.animationType){case li.None:this.changeColorLinearly(t,0);break;case li.Linear:this.changeColorLinearly(t,250)}})}changeColorLinearly(e,t){const n=this.getAnimatableItems(e),r=o=>{for(const a of n)a.material.color.setRGB(a.startColor.r+o*a.deltaColor.r,a.startColor.g+o*a.deltaColor.g,a.startColor.b+o*a.deltaColor.b)};if(t<=0)return void r(1);const s=bF(e.productItem,lo.ColorChange,t,r);requestAnimationFrame(s)}getAnimatableItems(e){const t=[];return e.materials&&this.tryAddAnimatableItems(e.materials,t,e.targetColor),e.rootObject&&e.rootObject.traverse(n=>{const r=n;if(!r.isMesh)return;const s=Array.isArray(r.material)?r.material:[r.material];this.tryAddAnimatableItems(s,t,e.targetColor)}),t}tryAddAnimatableItems(e,t,n){for(const r of e){if(!r.color)continue;const s=new we(n.r-r.color.r,n.g-r.color.g,n.b-r.color.b);t.push({material:r,startColor:r.color.clone(),deltaColor:s})}}}const Eu={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor.a *= opacity;\n\n\n\t\t}"};class Wd{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}const SQ=new Uc(-1,1,1,-1,0,1),eM=new lt;eM.setAttribute("position",new ke([-1,3,0,-1,-1,0,3,-1,0],3)),eM.setAttribute("uv",new ke([0,2,0,0,2,0],2));class EF{constructor(e){this._mesh=new kn(eM,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,SQ)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class tM extends Wd{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Ii?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=cw.clone(e.uniforms),this.material=new Ii({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new EF(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}class CF extends Wd{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){const r=e.getContext(),s=e.state;let o,a;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class EQ extends Wd{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class CQ{constructor(e,t){if(this.renderer=e,void 0===t){const n=e.getSize(new ne);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new Ai(this._width*this._pixelRatio,this._height*this._pixelRatio)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===Eu&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===tM&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new tM(Eu),this.clock=new x2}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let n=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(!1!==o.enabled){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),o.needsSwap){if(n){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==CF&&(o instanceof CF?n=!0:o instanceof EQ&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new ne);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}new Uc(-1,1,1,-1,0,1);const nM=new lt;nM.setAttribute("position",new ke([-1,3,0,-1,-1,0,3,-1,0],3)),nM.setAttribute("uv",new ke([0,2,0,0,2,0],2));class AQ extends Wd{constructor(e,t,n,r,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new we}render(e,t,n){const r=e.autoClear;let s,o;e.autoClear=!1,void 0!==this.overrideMaterial&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),s=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,s),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=o),e.autoClear=r}}function TF(i){return new Ii({defines:{MAX_RADIUS:i},uniforms:{colorTexture:{value:null},texSize:{value:new ne(.5,.5)},direction:{value:new ne(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }",fragmentShader:"#include <common>\n      varying vec2 vUv;\n      uniform sampler2D colorTexture;\n      uniform vec2 texSize;\n      uniform vec2 direction;\n      uniform float kernelRadius;\n\n      float gaussianPdf(in float x, in float sigma) {\n        return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n      }\n      void main() {\n        vec2 invSize = 1.0 / texSize;\n        float weightSum = gaussianPdf(0.0, kernelRadius);\n        vec4 diffuseSum = texture2D(colorTexture, vUv) * weightSum;\n        vec2 delta = direction * invSize * kernelRadius / float(MAX_RADIUS);\n        vec2 uvOffset = delta;\n        for( int i = 1; i <= MAX_RADIUS; i++ ) {\n          float w = gaussianPdf(uvOffset.x, kernelRadius);\n          vec4 sample1 = texture2D(colorTexture, vUv + uvOffset);\n          vec4 sample2 = texture2D(colorTexture, vUv - uvOffset);\n          diffuseSum += ((sample1 + sample2) * w);\n          weightSum += (2.0 * w);\n          uvOffset += delta;\n        }\n        gl_FragColor = diffuseSum / weightSum;\n      }"})}class DQ extends Wd{constructor(e,t,n,r,s,o,a){super(),this.productConfiguratorService=e,this.selectedProductHighlighter=t,this.scene=r,this.camera=s,this.blurHorizontalDirection=new ne(1,0),this.blurVerticalDirection=new ne(0,1),this.downsampleResolution=2,this.edgeThickness=1,this.edgeGlow=2,this.maskClearColor=new we(0),this.tempOldClearColor=new we,this.hoverMaskMaterial=new Di({color:16711680,side:2,blending:2,depthWrite:!1}),this.selectedMaskMaterial=new Di({color:65280,side:2,blending:2,depthWrite:!1});const l={format:Ti};this.maskRenderTarget=new Ai(n.x,n.y,l),this.maskRenderTarget.texture.name="OutlinePass.mask",this.maskRenderTarget.texture.generateMipmaps=!1,this.fsQuad=new EF,this.outlineMaterial=this.createOutlineMaterial(o,a),this.initBlurRenderTargetsAndMaterials(n,l),void 0===Eu&&console.error("THREE.OutlinePass relies on CopyShader"),this.copyUniforms=cw.clone(Eu.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new Ii({uniforms:this.copyUniforms,vertexShader:Eu.vertexShader,fragmentShader:Eu.fragmentShader,blending:0,depthTest:!1,depthWrite:!1,transparent:!0}),this.productConfiguratorService.canvasResized.subscribe(c=>this.setSize(c.width,c.height))}setSize(e,t){this.maskRenderTarget.setSize(e,t);let n=Math.round(e/this.downsampleResolution),r=Math.round(t/this.downsampleResolution);this.blurHorizontalRenderTarget.setSize(n,r),this.blurMaterial.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.blurHorizontalHalfRenderTarget.setSize(n,r),this.blurHalfMaterial.uniforms.texSize.value.set(n,r)}initBlurRenderTargetsAndMaterials(e,t){let n=Math.round(e.x/this.downsampleResolution),r=Math.round(e.y/this.downsampleResolution);this.blurHorizontalRenderTarget=new Ai(n,r,t),this.blurHorizontalRenderTarget.texture.name="OutlinePass.blur",this.blurHorizontalRenderTarget.texture.generateMipmaps=!1,this.blurVerticalRenderTarget=new Ai(n,r,t),this.blurVerticalRenderTarget.texture.name="OutlinePass.blur2",this.blurVerticalRenderTarget.texture.generateMipmaps=!1,this.blurMaterial=TF(this.edgeThickness),this.blurMaterial.uniforms.texSize.value.set(n,r),this.blurMaterial.uniforms.kernelRadius.value=1,n=Math.round(n/2),r=Math.round(r/2),this.blurHorizontalHalfRenderTarget=new Ai(n,r,t),this.blurHorizontalHalfRenderTarget.texture.name="OutlinePass.blur.half",this.blurHorizontalHalfRenderTarget.texture.generateMipmaps=!1,this.blurVerticalHalfRenderTarget2=new Ai(n,r,t),this.blurVerticalHalfRenderTarget2.texture.name="OutlinePass.blur.half2",this.blurVerticalHalfRenderTarget2.texture.generateMipmaps=!1,this.blurHalfMaterial=TF(this.edgeGlow),this.blurHalfMaterial.uniforms.texSize.value.set(n,r),this.blurHalfMaterial.uniforms.kernelRadius.value=this.edgeGlow}render(e,t,n,r,s){this.renderOutline(e,n),s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this.fsQuad.render(e))}renderOutline(e,t){if(!this.selectedProductHighlighter.isAnyProductHighlighted())return;const n=e.autoClear,r=e.getClearAlpha(),s=e.getClearColor(this.tempOldClearColor);e.setClearColor(this.maskClearColor,0),e.autoClear=!1,this.renderMaskTexture(e),this.renderBlurTexture(e),this.renderBlurHalfTexture(e),this.fsQuad.material=this.outlineMaterial,this.outlineMaterial.uniforms.maskTexture.value=this.maskRenderTarget.texture,this.outlineMaterial.uniforms.blurTexture.value=this.blurVerticalRenderTarget.texture,this.outlineMaterial.uniforms.blurHalfTexture.value=this.blurVerticalHalfRenderTarget2.texture,e.setRenderTarget(t),this.fsQuad.render(e),e.autoClear=n,e.setClearColor(s,r)}renderMaskTexture(e){e.setRenderTarget(this.maskRenderTarget),e.clear(),this.scene.overrideMaterial=this.hoverMaskMaterial,this.camera.layers.set(1),e.render(this.scene,this.camera),this.scene.overrideMaterial=this.selectedMaskMaterial,this.camera.layers.set(2),e.render(this.scene,this.camera),this.camera.layers.set(0),this.scene.overrideMaterial=null}renderBlurTexture(e){e.setRenderTarget(this.blurHorizontalRenderTarget),e.clear(),this.fsQuad.material=this.blurMaterial,this.blurMaterial.uniforms.colorTexture.value=this.maskRenderTarget.texture,this.blurMaterial.uniforms.direction.value=this.blurHorizontalDirection,this.fsQuad.render(e),e.setRenderTarget(this.blurVerticalRenderTarget),e.clear(),this.blurMaterial.uniforms.colorTexture.value=this.blurHorizontalRenderTarget.texture,this.blurMaterial.uniforms.direction.value=this.blurVerticalDirection,this.fsQuad.render(e)}renderBlurHalfTexture(e){e.setRenderTarget(this.blurHorizontalHalfRenderTarget),e.clear(),this.fsQuad.material=this.blurHalfMaterial,this.blurHalfMaterial.uniforms.colorTexture.value=this.maskRenderTarget.texture,this.blurHalfMaterial.uniforms.direction.value=this.blurHorizontalDirection,this.fsQuad.render(e),e.setRenderTarget(this.blurVerticalHalfRenderTarget2),e.clear(),this.blurHalfMaterial.uniforms.colorTexture.value=this.blurHorizontalHalfRenderTarget.texture,this.blurHalfMaterial.uniforms.direction.value=this.blurVerticalDirection,this.fsQuad.render(e)}createOutlineMaterial(e,t){return new Ii({vertexShader:"varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }",fragmentShader:"varying vec2 vUv;\n        uniform sampler2D maskTexture;\n\t\t\t\tuniform sampler2D blurTexture;\n\t\t\t\tuniform sampler2D blurHalfTexture;\n\n\t\t\t\tuniform vec3 hoverOutlineColor;\n\t\t\t\tuniform vec3 selectedOutlineColor;\n\n\t\t\t\tvec4 getOutlineColor(float mask, float blur, vec3 outlineColor)\n        {\n          float blurOutline = clamp((blur - mask) * 2.5, 0.0, 1.0);\n          return vec4(outlineColor.x * blurOutline, outlineColor.y * blurOutline, outlineColor.z * blurOutline, blurOutline);\n        }\n\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\n\t\t\t\t\tvec4 blurColor = texture2D(blurTexture, vUv);\n\t\t\t\t\tvec4 blurHalfColor = texture2D(blurHalfTexture, vUv);\n\n\t\t\t\t\tvec3 combinedBlur = min(blurColor.xyz + blurHalfColor.xyz, vec3(1.0, 1.0, 1.0));\n\n\t\t\t\t\tvec4 hover = getOutlineColor(maskColor.r, combinedBlur.r, hoverOutlineColor);\n\t\t\t\t\tvec4 selected = getOutlineColor(maskColor.g, combinedBlur.g, selectedOutlineColor);\n\t\t\t\t\tgl_FragColor = vec4(hover.xyz + selected.xyz, max(hover.w, selected.w));;\n\t\t\t\t}",uniforms:{maskTexture:{value:null},blurTexture:{value:null},blurHalfTexture:{value:null},hoverOutlineColor:{value:e},selectedOutlineColor:{value:t}},transparent:!0})}}const IQ={uniforms:{tDiffuse:{value:null}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 tex = texture2D( tDiffuse, vUv );\n\n\t\t\tgl_FragColor = LinearTosRGB( tex );\n\n\t\t}"};class RQ{constructor(e,t,n,r,s){this.subscription=e.selectedProductChanged.subscribe(u=>this.onSelectedProductChanged(u)),this.composer=new CQ(n);const o=new AQ(r,s);this.gammaCorrectionPass=new tM(IQ);const a=new we(181/255,145/255,199/255),l=new we(1,250/255,250/255),c=new DQ(e,t,n.getSize(new ne(0,0)),r,s,a,l);this.composer.addPass(o),this.composer.addPass(this.gammaCorrectionPass),this.composer.addPass(c)}dispose(){this.subscription.unsubscribe()}onSelectedProductChanged(e){this.gammaCorrectionPass.enabled=e.useGammaSpace}render(){this.composer.render()}}const PQ={filename:"assets/models/flowerpot.obj",materialInfo:{mtl:"assets/models/flowerpot.mtl",renderBackface:!0}},LQ={filename:"assets/models/rose.obj",materialInfo:{diffuseTexture:"assets/models/rose.png",normalTexture:"assets/models/rosenormal.png",renderBackface:!1}},FQ={filename:"assets/models/wuffels.obj",materialInfo:{diffuseTexture:"assets/models/wuffels.png",renderBackface:!1}},OQ={filename:"assets/models/pbr/Waifair_chair.gltf",materialInfo:{renderBackface:!1}},NQ={filename:"assets/models/pbr/Waifair_table.gltf",materialInfo:{renderBackface:!1}},kQ={filename:"assets/models/pbr/IKEA_chear.gltf",materialInfo:{renderBackface:!1}},BQ={filename:"assets/models/pbr/IKEA_table.gltf",materialInfo:{renderBackface:!1}},jd=()=>Object.assign({},LQ);var co=(()=>{return(i=co||(co={}))[i.None=0]="None",i[i.FreeColor=1]="FreeColor",i[i.SpecificColors=2]="SpecificColors",i[i.SpecificTextures=3]="SpecificTextures",co;var i})(),Yn=(()=>{return(i=Yn||(Yn={}))[i.CanvasResized=0]="CanvasResized",i[i.LoadingStarted=1]="LoadingStarted",i[i.LoadingProgress=2]="LoadingProgress",i[i.LoadingFinished=3]="LoadingFinished",i[i.MaterialColorSwap=4]="MaterialColorSwap",i[i.MaterialTextureSwap=5]="MaterialTextureSwap",i[i.MeshSelected=6]="MeshSelected",i[i.MeshDeselected=7]="MeshDeselected",i[i.MeshPointerEnter=8]="MeshPointerEnter",i[i.MeshPointerLeave=9]="MeshPointerLeave",i[i.SelectedProductChanged=10]="SelectedProductChanged",i[i.ToolbarChangeProduct=11]="ToolbarChangeProduct",Yn;var i})();let Yr=(()=>{class i{constructor(){this.items=[],this.itemElements={},this.selectedProduct=null,this.subjects={};let t=0;this.items.push(function jQ(i){return{id:i,name:"flowerpot",thumbnail:"assets/models/thumbnail_pot.png",models:[Object.assign({},PQ)],hasFloor:!1,useGammaSpace:!1,tooltip:"A very good looking flower pot.",subItems:[],selectableMeshesOptions:[{includedMeshes:["Cylinder.002_Cylinder.006_M_flower"],options:{type:co.FreeColor}},{includedMeshes:["Cylinder.002_Cylinder.006_M_pot"],options:{type:co.SpecificColors,value:{animationType:li.Linear,colors:["#ff7f00","#badbad","#ffc0cb"]}}}],activeEvents:[]}}(t++)),this.items.push(function qQ(i){const e=jd(),t=jd(),n=jd(),r=jd(),s=jd();return e.position=new D(1,0,0),e.rotation=new Yh(0,0,-.2),t.position=new D(-1,0,0),t.rotation=new Yh(0,0,.2),r.position=new D(0,0,1),r.rotation=new Yh(.2,0,0),s.position=new D(0,0,-1),s.rotation=new Yh(-.2,0,0),{id:i,name:"roses",thumbnail:"assets/models/thumbnail_rose.png",models:[e,t,n,r,s],hasFloor:!1,useGammaSpace:!1,tooltip:"A special gift a long time ago.",subItems:[],selectableMeshesOptions:[{noSiblings:!0,options:{type:co.SpecificTextures,value:{animationType:li.FromTopToBottom,textures:[{url:"assets/models/rose.png",thumbnail:"assets/models/thumbnail_rose.png"},{url:"assets/models/rose_pink.png",thumbnail:"assets/models/rose_pink.png"}]}}}],activeEvents:[]}}(t++)),this.items.push(function $Q(i){return{id:i,name:"Wuffels",thumbnail:"assets/models/thumbnail_wuffels.png",models:[Object.assign({},FQ)],hasFloor:!0,useGammaSpace:!1,tooltip:"Wuffels! Wuff!",subItems:[],selectableMeshesOptions:[],activeEvents:[]}}(t++)),this.items.push(function XQ(i){return{id:i,name:"table1",thumbnail:"assets/models/pbr/thumbnail_wayfair_table.png",models:[Object.assign({},NQ)],hasFloor:!1,useGammaSpace:!0,tooltip:"A table.",subItems:[],activeEvents:[]}}(t++)),this.items.push(function ZQ(i){return{id:i,name:"chair",thumbnail:"assets/models/pbr/thumbnail_wayfair_chair.png",models:[Object.assign({},OQ)],hasFloor:!1,useGammaSpace:!0,tooltip:"A hard chair.",subItems:[],activeEvents:[]}}(t++)),this.items.push(function YQ(i){const e={id:i,name:"chear",thumbnail:"assets/models/pbr/thumbnail_ikea_chair.png",models:[Object.assign({},kQ)],hasFloor:!1,useGammaSpace:!0,tooltip:"A soft chair.",subItems:[],selectedSubItem:null,activeEvents:[]},t=e.subItems;return t.push({id:t.length,image:"assets/models/pbr/chair_mat_baseColor.png",eventType:Yn.MaterialTextureSwap,tooltip:"White chair",data:{addGlobalLoadingEvent:!0,animationType:li.FromTopToBottom,productItem:e,textureSlot:"map",textureUrl:"assets/models/pbr/chair_mat_baseColor.png"}}),t.push({id:t.length,image:"assets/models/pbr/chair_mat_baseColor_alt.png",eventType:Yn.MaterialTextureSwap,tooltip:"Blue chair",data:{addGlobalLoadingEvent:!0,animationType:li.FromTopToBottom,productItem:e,textureSlot:"map",textureUrl:"assets/models/pbr/chair_mat_baseColor_alt.png"}}),e.selectedSubItem=t[0],e}(t++)),this.items.push(function KQ(i){return{id:i,name:"table2",thumbnail:"assets/models/pbr/thumbnail_ikea_table.png",models:[Object.assign({},BQ)],hasFloor:!1,useGammaSpace:!0,tooltip:"A quite plastic looking table, but it's wood!!",subItems:[],activeEvents:[]}}(t++)),this.canvasResized=this.createSubject(Yn.CanvasResized),this.loadingStarted=this.createSubject(Yn.LoadingStarted),this.loadingProgress=this.createSubject(Yn.LoadingProgress),this.loadingFinished=this.createSubject(Yn.LoadingFinished),this.materialColorSwap=this.createSubject(Yn.MaterialColorSwap),this.materialTextureSwap=this.createSubject(Yn.MaterialTextureSwap),this.meshSelected=this.createSubject(Yn.MeshSelected),this.meshDeselected=this.createSubject(Yn.MeshDeselected),this.meshPointerEnter=this.createSubject(Yn.MeshPointerEnter),this.meshPointerLeave=this.createSubject(Yn.MeshPointerLeave),this.selectedProductChanged=this.createSubject(Yn.SelectedProductChanged),this.toolbarChangeProduct=this.createSubject(Yn.ToolbarChangeProduct)}ngOnDestroy(){const t=Object.keys(this.subjects);for(const n of t){const r=this.subjects[n];!r||(r.complete(),r.unsubscribe(),delete this.subjects[n])}}dispatch(t,n){!this.subjects[t]||this.subjects[t].next(n)}getSelectedProductElement(t){if(t)return this.itemElements[t.name]}createSubject(t){const n=new Kr;return this.subjects[t]=n,n}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),QQ=(()=>{class i{constructor(t,n,r,s,o){this.renderer=t,this.containerElement=n,this.productConfiguratorService=r,this.activatedRoute=s,this.router=o,this.lights=[],this.lightIntensityFactor=1;const{width:a,height:l}=this.getRendererSize();this.renderer.setSize(a,l),this.renderer.setClearColor(new we(0),0),this.scene=new SP,this.camera=new Bn(90,a/l,.1,1e4),this.camera.position.z=100,this.scene.add(this.camera),this.cameraControls=new yY(this.camera,this.renderer.domElement),this.cameraControls.maxPolarAngle=Math.PI,this.cameraControls.minPolarAngle=0,this.cameraControls.enablePan=!1,this.cameraControls.enableDamping=!0,this.cameraControls.dampingFactor=.05,this.cameraControls.rotateSpeed*=.67,this.cameraControls.update(),this.initLights(),this.productChanger=new fQ(this),this.materialColorChanger=new MQ(this.productConfiguratorService),this.textureChanger=new gQ(this.productConfiguratorService),this.selectedProductMeshIntersector=new xQ(this.camera,this.productConfiguratorService),this.pointerEventHandler=new _Q(this.productConfiguratorService,this.selectedProductMeshIntersector),this.selectedProductHighlighter=new vQ(this.renderer,this.productConfiguratorService),this.pointerEventHandler.initPointerEvents(this.renderer.domElement),this.initEvents(),this.effectsComposerHandler=new RQ(this.productConfiguratorService,this.selectedProductHighlighter,this.renderer,this.scene,this.camera),this.startRenderLoop()}startRenderLoop(){const t=()=>{this.cameraControls.update(),this.effectsComposerHandler.render(),requestAnimationFrame(t)};requestAnimationFrame(t)}initLights(){this.lightIntensityFactor=.7/.3;const a=new Md(16777215,.7);a.position.set(-247,285,209),a.position.normalize(),a.castShadow=!0;const l=new Md(16777215,.35);l.position.set(212,285,250),l.position.normalize(),l.castShadow=!0;const c=new Md(16777215,.175);c.position.set(-153,285,-183),c.position.normalize(),c.castShadow=!0,this.scene.add(a,l,c),this.lights.push(a,l,c)}initEvents(){window.addEventListener("resize",MF(()=>{const{width:t,height:n}=this.getRendererSize();this.renderer.setSize(t,n),this.camera.aspect=t/n,this.camera.updateProjectionMatrix(),this.productConfiguratorService.canvasResized.next(new ne(t,n))},1e3/30))}loadInitialItem(){const t=this.activatedRoute.snapshot,n=t.paramMap.has("name")?t.paramMap.get("name").toLowerCase():"",r=this.productConfiguratorService.items.find(s=>s.name.toLowerCase()===n)||this.productConfiguratorService.items[0];this.productChanger.changeProduct(r)}getRendererSize(){return new ne(this.containerElement.offsetWidth,this.containerElement.offsetHeight)}}return i.\u0275fac=function(t){return new(t||i)(je(xw),je(HTMLElement),je(Yr),je(Do),je(mi))},i.\u0275prov=mt({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const JQ=["canvas"];let eJ=(()=>{class i{constructor(){this.sceneInit=new qn}ngOnInit(){const n=new xw({canvas:this.canvasRef.nativeElement,antialias:!0});this.sceneInit.emit(n)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=Jn({type:i,selectors:[["app-viewer-threejs"]],viewQuery:function(t,n){if(1&t&&Ma(JQ,7),2&t){let r;Rs(r=Ps())&&(n.canvasRef=r.first)}},outputs:{sceneInit:"sceneInit"},decls:2,vars:0,consts:[["canvas",""]],template:function(t,n){1&t&&si(0,"canvas",null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1}canvas[_ngcontent-%COMP%]{position:absolute}"]}),i})();const tJ=["instructionContainer"];let nJ=(()=>{class i{constructor(){this.isOpen=!0,this.isTextVisible=!0,this.closed=new qn}ngOnInit(){setTimeout(()=>{this.isOpen&&this.closeInstructions()},1e4)}closeInstructionsButton(){localStorage&&localStorage.setItem("tutorial","1"),this.closeInstructions()}closeInstructions(){this.isOpen=!1;const t=this.instructionContainerRef.nativeElement;t.style.height=t.offsetHeight+"px",setTimeout(()=>{this.isTextVisible=!1},250),setTimeout(()=>{this.closed.emit()},734)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=Jn({type:i,selectors:[["app-toolbar-instructions"]],viewQuery:function(t,n){if(1&t&&Ma(tJ,5),2&t){let r;Rs(r=Ps())&&(n.instructionContainerRef=r.first)}},outputs:{closed:"closed"},decls:7,vars:2,consts:[[1,"instructions-container"],["instructionContainer",""],[3,"hidden"],[1,"close-text"],[1,"close-button",3,"click"]],template:function(t,n){1&t&&(en(0,"div",0,1)(2,"p",2)(3,"span",3),wa(4,"Drag to rotate camera. Scroll to zoom in and out."),tn(),en(5,"span",4),Si("click",function(){return n.closeInstructionsButton()}),wa(6,"\u2716"),tn()()()),2&t&&(Rt("@close",n.isOpen?"open":"closed"),xn(2),Rt("hidden",!n.isTextVisible))},styles:["[_nghost-%COMP%]{pointer-events:none}.instructions-container[_ngcontent-%COMP%]{padding-top:15px;padding-bottom:15px;margin-bottom:5px;width:100%;background-color:#faebd7;-webkit-user-select:none;user-select:none}.instructions-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;margin:0}.close-text[_ngcontent-%COMP%]{flex-grow:1}.close-button[_ngcontent-%COMP%]{cursor:pointer;margin-right:15px;pointer-events:all;margin-left:5px}"],data:{animation:[iI("close",[oI("open => closed",[aI("p",ex("250ms",dc({opacity:"0"}))),aI(":self",ex("500ms",dc({width:"0"})))])])]}}),i})();function DF(i){return function(e,t,n){const r=new Map,s=n.value;function a(l){setTimeout(function(){l.wasCalled?(s.apply(l.thisArg,l.args),l.wasCalled=!1,a(l)):r.delete(l.thisArg)},i)}return n.value=function(...l){let c=r.get(this);if(c)return c.args=l,void(c.wasCalled=!0);c=function o(l,c){const u={args:l,wasCalled:!1,thisArg:c};return r.set(c,u),u}(l,this),s.apply(this,l),a(c)},n}}let iJ=(()=>{class i{constructor(t){this.productConfiguratorService=t}clicked(){this.productItem.selectedSubItem=this.item,this.productConfiguratorService.dispatch(this.item.eventType,this.item.data)}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr))},i.\u0275cmp=Jn({type:i,selectors:[["app-toolbar-subitem"]],inputs:{item:"item",productItem:"productItem"},decls:2,vars:5,consts:[[1,"sub-item","medium-icon",3,"title","click"],[3,"src","alt"]],template:function(t,n){1&t&&(en(0,"div",0),Si("click",function(){return n.clicked()}),si(1,"img",1),tn()),2&t&&(Rt("title",n.item.tooltip),xn(1),ec("active",n.productItem.selectedSubItem===n.item),Rt("src",n.item.image,Qu)("alt",n.item.tooltip))},styles:[".active[_ngcontent-%COMP%]{border:1px solid cyan}.sub-item[_ngcontent-%COMP%]{display:inline-block;cursor:pointer}.sub-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;-webkit-user-select:none;user-select:none;border-radius:50%}.sub-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover:not(.active){border:1px solid #00cccc}.medium-icon[_ngcontent-%COMP%]{width:32px;height:32px}"]}),i})();const rJ=["containerElement"],sJ=["subItemsElement"];function oJ(i,e){if(1&i&&si(0,"app-toolbar-subitem",5),2&i){const t=e.$implicit,n=Ui();Rt("item",t)("productItem",n.productItem)}}class Cu{constructor(e){this.productConfiguratorService=e,this.isViewInitialized=!1}ngOnChanges(e){this.isViewInitialized&&e.productItem&&(this.productItemElement=this.productConfiguratorService.getSelectedProductElement(this.productItem),this.calculatePosition())}ngAfterViewInit(){this.isViewInitialized=!0,this.productItemElement=this.productConfiguratorService.getSelectedProductElement(this.productItem),this.calculatePosition()}onResize(){this.calculatePosition()}calculatePosition(){if(!this.productItemElement)return;const e=this.subItemsElement.nativeElement,t=e.offsetWidth,r=this.containerRef.nativeElement.offsetWidth;if(t>r)return void(e.style.left="");const s=this.productItemElement.getBoundingClientRect();let o=s.left+.5*s.width-.5*t;const a=o+t;a>r&&(o-=a-r),e.style.left=o+"px"}}Cu.\u0275fac=function(e){return new(e||Cu)(Oe(Yr))},Cu.\u0275cmp=Jn({type:Cu,selectors:[["app-toolbar-subitem-container"]],viewQuery:function(e,t){if(1&e&&(Ma(rJ,5),Ma(sJ,5)),2&e){let n;Rs(n=Ps())&&(t.containerRef=n.first),Rs(n=Ps())&&(t.subItemsElement=n.first)}},hostBindings:function(e,t){1&e&&Si("resize",function(){return t.onResize()},!1,QS)},inputs:{productItem:"productItem"},features:[go],decls:5,vars:1,consts:[[1,"sub-item-container"],["containerElement",""],[1,"sub-items"],["subItemsElement",""],[3,"item","productItem",4,"ngFor","ngForOf"],[3,"item","productItem"]],template:function(e,t){1&e&&(en(0,"div",0,1)(2,"div",2,3),zi(4,oJ,1,2,"app-toolbar-subitem",4),tn()()),2&e&&(xn(4),Rt("ngForOf",t.productItem.subItems))},directives:[Sh,iJ],styles:["app-toolbar-subitem[_ngcontent-%COMP%]:not(:last-child){margin-right:10px}.sub-item-container[_ngcontent-%COMP%]{position:relative;text-align:left}.sub-items[_ngcontent-%COMP%]{position:relative;display:inline-block}"]}),xM([DF(1e3/60)],Cu.prototype,"onResize",null);const aJ=["containerElement"],lJ=function(i){return{active:i}};let cJ=(()=>{class i{constructor(t){this.productConfiguratorService=t}ngAfterViewInit(){this.productConfiguratorService.itemElements[this.item.name]=this.containerRef.nativeElement}changeProduct(){this.productConfiguratorService.toolbarChangeProduct.next(this.item)}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr))},i.\u0275cmp=Jn({type:i,selectors:[["app-toolbar-product-item"]],viewQuery:function(t,n){if(1&t&&Ma(aJ,5),2&t){let r;Rs(r=Ps())&&(n.containerRef=r.first)}},inputs:{item:"item"},decls:3,vars:5,consts:[[1,"product-item",3,"title"],["containerElement",""],[3,"ngClass","src","click"]],template:function(t,n){1&t&&(en(0,"div",0,1)(2,"img",2),Si("click",function(){return n.changeProduct()}),tn()()),2&t&&(Rt("title",n.item.tooltip),xn(2),Rt("ngClass",ip(3,lJ,n.productConfiguratorService.selectedProduct===n.item))("src",n.item.thumbnail,Qu))},directives:[DA],styles:[".active[_ngcontent-%COMP%]{border:1px solid aqua}.product-item[_ngcontent-%COMP%]{display:inline-block}img[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;cursor:pointer;-webkit-user-select:none;user-select:none}@media screen and (max-width: 480px){img[_ngcontent-%COMP%]{width:48px;height:48px}}img[_ngcontent-%COMP%]:hover:not(.active){border:1px solid #00cccc}"]}),i})();function uJ(i,e){if(1&i){const t=qf();en(0,"app-toolbar-instructions",4),Si("closed",function(){return cf(t),Ui().hasReadInstructions=!0}),tn()}}function hJ(i,e){1&i&&si(0,"app-toolbar-subitem-container",5),2&i&&Rt("productItem",Ui().selectedProduct)}function dJ(i,e){1&i&&si(0,"app-toolbar-product-item",6),2&i&&Rt("item",e.$implicit)}let fJ=(()=>{class i{constructor(t){this.productConfiguratorService=t,this.hasReadInstructions=!1,this.hasSubItems=!1,this.subscriptions=[]}ngOnInit(){const t=null==localStorage?void 0:localStorage.getItem("tutorial");t&&"1"===t&&(this.hasReadInstructions=!0),this.subscriptions.push(this.productConfiguratorService.selectedProductChanged.subscribe(n=>{var r;this.selectedProduct=n,this.hasSubItems=!!((null===(r=n.subItems)||void 0===r?void 0:r.length)>0&&n.object3D)}))}ngOnDestroy(){for(const t of this.subscriptions)t.unsubscribe();this.subscriptions=[]}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr))},i.\u0275cmp=Jn({type:i,selectors:[["app-toolbar"]],decls:4,vars:3,consts:[[1,"toolbar-container"],[3,"closed",4,"ngIf"],[3,"productItem",4,"ngIf"],[3,"item",4,"ngFor","ngForOf"],[3,"closed"],[3,"productItem"],[3,"item"]],template:function(t,n){1&t&&(en(0,"div",0),zi(1,uJ,1,0,"app-toolbar-instructions",1),zi(2,hJ,1,1,"app-toolbar-subitem-container",2),zi(3,dJ,1,1,"app-toolbar-product-item",3),tn()),2&t&&(xn(1),Rt("ngIf",!n.hasReadInstructions),xn(1),Rt("ngIf",n.selectedProduct&&n.hasSubItems),xn(1),Rt("ngForOf",n.productConfiguratorService.items))},directives:[bp,nJ,Cu,Sh,cJ],styles:[".toolbar-container[_ngcontent-%COMP%]{z-index:2;position:absolute;bottom:5px;width:100%;text-align:center}.toolbar-container[_ngcontent-%COMP%]   app-toolbar-product-item[_ngcontent-%COMP%]{margin-right:15px}"]}),i})();class Tu{constructor(e){this.productConfiguratorService=e,this.initialColor=""}ngOnInit(){const e=Gd(this.mesh);for(const t of e){const n=t.color;if(n){this.initialColor=`#${n.getHexString()}`;break}}}colorChanged(e){const t=e.target.value;Jb(this.productConfiguratorService.selectedProduct,[lo.ColorChange],!0),function bQ(i,e){const t=Gd(i),n=Object.keys(e);for(const r of t)for(const s of n)r[s]=e[s]}(this.mesh,{color:new we(t)})}}Tu.\u0275fac=function(e){return new(e||Tu)(Oe(Yr))},Tu.\u0275cmp=Jn({type:Tu,selectors:[["sidebar-free-color"]],inputs:{mesh:"mesh"},decls:4,vars:1,consts:[["type","color",3,"value","input"]],template:function(e,t){1&e&&(en(0,"label"),wa(1,"Edit colour: "),tn(),si(2,"br"),en(3,"input",0),Si("input",function(r){return t.colorChanged(r)}),tn()),2&e&&(xn(3),Rt("value",t.initialColor))},styles:["input[type=color][_ngcontent-%COMP%]{width:64px;max-width:100%;height:64px;padding:0;border:none}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch{border:none}input[type=color][_ngcontent-%COMP%]::-moz-color-swatch{border:none}"]}),xM([DF(100)],Tu.prototype,"colorChanged",null);const pJ=function(i){return{backgroundColor:i}};function mJ(i,e){if(1&i){const t=qf();en(0,"li",2)(1,"div",3),Si("click",function(){const s=cf(t).$implicit;return Ui().changeCurrentColor(s)}),tn()()}if(2&i){const t=e.$implicit;ec("active",Ui().currentValue===t),xn(1),Rt("ngStyle",ip(3,pJ,t))}}let gJ=(()=>{class i{constructor(t,n){this.productConfiguratorService=t,this.ngZone=n,this.currentValue="",this.values=[],this.animationType=li.None}ngOnInit(){const n=this.mesh.userData.selectableMeshesOption.value;this.values=n.colors?n.colors:[],this.setCurrentColorValue(),this.animationType=n.animationType}setCurrentColorValue(){const t=Gd(this.mesh);this.currentValue="";for(const n of t){const r=n.color;if(r){this.currentValue=`#${r.getHexString()}`;break}}}changeCurrentColor(t){if(t===this.currentValue)return;Jb(this.productConfiguratorService.selectedProduct,[lo.ColorChange],!0);const n=this.mesh.userData,r=[this.mesh];n.siblings&&r.push(...n.siblings);const s=SF(r);this.currentValue=t,this.ngZone.runOutsideAngular(()=>{this.productConfiguratorService.materialColorSwap.next({animationType:this.animationType,materials:s,targetColor:new we(t),productItem:this.productConfiguratorService.selectedProduct})})}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr),Oe(nn))},i.\u0275cmp=Jn({type:i,selectors:[["sidebar-specific-color"]],inputs:{mesh:"mesh"},decls:4,vars:1,consts:[[1,"specific-color-values"],["class","item item-color",3,"active",4,"ngFor","ngForOf"],[1,"item","item-color"],[1,"item-content",3,"ngStyle","click"]],template:function(t,n){1&t&&(en(0,"p"),wa(1," Edit color:\n"),tn(),en(2,"ul",0),zi(3,mJ,2,5,"li",1),tn()),2&t&&(xn(3),Rt("ngForOf",n.values))},directives:[Sh,bv],styles:[".specific-color-values[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.item[_ngcontent-%COMP%]{display:inline-block;max-width:100%;padding:0;cursor:pointer;width:64px;height:64px}.item-content[_ngcontent-%COMP%]{position:relative;height:100%}.active[_ngcontent-%COMP%]{border:1px solid aqua}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch{border:none}input[type=color][_ngcontent-%COMP%]::-moz-color-swatch{border:none}"]}),i})();const yJ=function(i){return{backgroundImage:i}};function _J(i,e){if(1&i){const t=qf();en(0,"li",2)(1,"div",3),Si("click",function(){const s=cf(t).$implicit;return Ui().changeCurrentTexture(s.url)}),tn()()}if(2&i){const t=e.$implicit,n=Ui();ec("active",n.currentValue===t.url),xn(1),ec("active",n.currentValue===t.url)("inline-spinner",n.loadingValues[t.url]),Rt("ngStyle",ip(7,yJ,"url('"+t.thumbnail+"')"))}}let vJ=(()=>{class i{constructor(t,n){this.productConfiguratorService=t,this.ngZone=n,this.currentValue="",this.values=[],this.animationType=li.None,this.loadingValues={}}ngOnInit(){const n=this.mesh.userData.selectableMeshesOption.value;this.values=n.textures?n.textures:[],this.setCurrentTextureValue(),this.animationType=n.animationType}setCurrentTextureValue(){var t;const n=Gd(this.mesh);let r="";if(this.currentValue="",0!==this.values.length){for(const s of n){const o=s.map;if(o){r=null!==(t=o.image.src)&&void 0!==t?t:"";break}}if(r)for(const s of this.values)if(r.includes(s.url)||r.includes(s.thumbnail)){this.currentValue=s.url;break}}}changeCurrentTexture(t){if(t===this.currentValue)return;this.currentValue=t,this.loadingValues[t]=!0;const n=this.mesh.userData,r=[this.mesh];n.siblings&&r.push(...n.siblings);const s=SF(r),o=()=>{this.ngZone.run(()=>{delete this.loadingValues[t]})};this.ngZone.runOutsideAngular(()=>{this.productConfiguratorService.materialTextureSwap.next({addGlobalLoadingEvent:!1,animationType:this.animationType,materials:s,onLoaded:o,productItem:this.productConfiguratorService.selectedProduct,textureSlot:"map",textureUrl:t})})}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr),Oe(nn))},i.\u0275cmp=Jn({type:i,selectors:[["sidebar-specific-texture"]],inputs:{mesh:"mesh"},decls:4,vars:1,consts:[[1,"specific-color-values"],["class","item",3,"active",4,"ngFor","ngForOf"],[1,"item"],[1,"item-content",3,"ngStyle","click"]],template:function(t,n){1&t&&(en(0,"p"),wa(1," Edit texture:\n"),tn(),en(2,"ul",0),zi(3,_J,2,9,"li",1),tn()),2&t&&(xn(3),Rt("ngForOf",n.values))},directives:[Sh,bv],styles:[".specific-color-values[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.item[_ngcontent-%COMP%]{display:inline-block;max-width:100%;padding:0;cursor:pointer;width:128px;height:128px}.item-content[_ngcontent-%COMP%]{position:relative;height:100%;background-size:cover}.active[_ngcontent-%COMP%]{border:1px solid aqua}.inline-spinner[_ngcontent-%COMP%]:after{width:64px;height:64px}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}input[type=color][_ngcontent-%COMP%]::-webkit-color-swatch{border:none}input[type=color][_ngcontent-%COMP%]::-moz-color-swatch{border:none}"]}),i})();function xJ(i,e){1&i&&si(0,"sidebar-free-color",5),2&i&&Rt("mesh",Ui(3).activeMesh)}function wJ(i,e){1&i&&si(0,"sidebar-specific-color",5),2&i&&Rt("mesh",Ui(3).activeMesh)}function bJ(i,e){1&i&&si(0,"sidebar-specific-texture",5),2&i&&Rt("mesh",Ui(3).activeMesh)}function MJ(i,e){if(1&i&&(Wf(0,3),zi(1,xJ,1,1,"sidebar-free-color",4),zi(2,wJ,1,1,"sidebar-specific-color",4),zi(3,bJ,1,1,"sidebar-specific-texture",4),jf()),2&i){const t=Ui(2);Rt("ngSwitch",t.type),xn(1),Rt("ngSwitchCase",t.SelectedOptionsType.FreeColor),xn(1),Rt("ngSwitchCase",t.SelectedOptionsType.SpecificColors),xn(1),Rt("ngSwitchCase",t.SelectedOptionsType.SpecificTextures)}}function SJ(i,e){if(1&i&&(en(0,"div"),zi(1,MJ,4,4,"ng-container",2),tn()),2&i){const t=Ui();xn(1),Rt("ngIf",t.activeMesh)}}let EJ=(()=>{class i{constructor(t,n,r){this.productConfiguratorService=t,this.changeDetectorRef=n,this.zone=r,this.SelectedOptionsType=co,this.isOpened=!1,this.isContentVisible=this.isOpened,this.type=co.None,this.subscriptions=[]}ngOnInit(){this.subscriptions.push(this.productConfiguratorService.meshDeselected.subscribe(()=>{this.zone.run(()=>{this.isOpened=!1,this.activeMesh=void 0,this.type=co.None})}),this.productConfiguratorService.meshSelected.subscribe(t=>{this.zone.run(()=>{this.isOpened=!0;const n=t.userData;this.activeMesh=t,this.type=n.selectableMeshesOption.type})}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions=[]}openClosedStart(t){"closed"===t.fromState&&setTimeout(()=>{this.isContentVisible=!0},1)}openClosedDone(t){"closed"===t.toState&&setTimeout(()=>{this.isContentVisible=!1},1)}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr),Oe(lp),Oe(nn))},i.\u0275cmp=Jn({type:i,selectors:[["app-sidebar"]],decls:2,vars:2,consts:[[1,"configurator-sidebar"],[4,"ngIf"],[3,"ngSwitch",4,"ngIf"],[3,"ngSwitch"],[3,"mesh",4,"ngSwitchCase"],[3,"mesh"]],template:function(t,n){1&t&&(en(0,"div",0),Si("@openClosed.start",function(s){return n.openClosedStart(s)})("@openClosed.done",function(s){return n.openClosedDone(s)}),zi(1,SJ,2,1,"div",1),tn()),2&t&&(Rt("@openClosed",n.isOpened?"open":"closed"),xn(1),Rt("ngIf",n.isContentVisible))},directives:[bp,Mp,PA,Tu,gJ,vJ],styles:["[_nghost-%COMP%]{position:absolute;top:0;right:0;bottom:0;width:300px;overflow:hidden;--sidebar-closed-right: -300px}.configurator-sidebar[_ngcontent-%COMP%]{position:absolute;top:0;right:0;bottom:0;z-index:1;width:300px;padding:.5em;background-color:#383838;border-left:1px solid gray;color:snow}"],data:{animation:[iI("openClosed",[sI("open",dc({right:"0"})),sI("closed",dc({right:"var(--sidebar-closed-right)"})),oI("open <=> closed",[ex("0.15s")])])]}}),i})(),CJ=(()=>{class i{constructor(t){this.productConfiguratorService=t,this.loadingsMap={},this.loadings=[],this.progressText="0%"}ngOnInit(){this.progressSubscription=this.productConfiguratorService.loadingProgress.subscribe(t=>{let n=this.loadingsMap[t.id];n?(n.loaded=t.loaded,n.total=t.total):(n={loaded:t.loaded,total:t.total},this.loadingsMap[t.id]=n,this.loadings.push(n));let r=0,s=0;for(const a of this.loadings)r+=a.loaded,s+=a.total;if(0===s)return;const o=(r/s*100).toFixed(0);this.progressText=`${o}%`})}ngOnDestroy(){var t;null===(t=this.progressSubscription)||void 0===t||t.unsubscribe(),this.progressSubscription=void 0}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr))},i.\u0275cmp=Jn({type:i,selectors:[["app-loading-spinner"]],decls:4,vars:1,consts:[[1,"loading-spinner"],["src","assets/loading.svg"],[1,"loading-progress"]],template:function(t,n){1&t&&(en(0,"div",0),si(1,"img",1),en(2,"div",2),wa(3),tn()()),2&t&&(xn(3),M_(n.progressText))},styles:[".loading-spinner[_ngcontent-%COMP%]{width:128px;height:128px;position:absolute;top:50%;left:50%;margin-left:-64px;margin-top:-64px;z-index:2;-webkit-user-select:none;user-select:none}.loading-progress[_ngcontent-%COMP%]{position:relative;font-size:24px;text-align:center;color:#faebd7}"]}),i})();const TJ=["canvasContainer"];function AJ(i,e){1&i&&si(0,"app-loading-spinner")}const RJ=iG.forRoot([{component:(()=>{class i{constructor(t,n,r,s){this.productConfiguratorService=t,this.activatedRoute=n,this.router=r,this.zone=s,this.loadingsStarted=0,this.loadingsFinished=0,this.productConfiguratorService.loadingStarted.subscribe(()=>{this.loadingsStarted++}),this.productConfiguratorService.loadingFinished.subscribe(()=>{this.loadingsFinished++,this.loadingsFinished===this.loadingsStarted&&(this.loadingsStarted=0,this.loadingsFinished=0)})}onSceneInit(t){let n;this.zone.runOutsideAngular(()=>{n=new QQ(t,this.containerElement.nativeElement,this.productConfiguratorService,this.activatedRoute,this.router)}),setTimeout(()=>{n.loadInitialItem()},1)}}return i.\u0275fac=function(t){return new(t||i)(Oe(Yr),Oe(Do),Oe(mi),Oe(nn))},i.\u0275cmp=Jn({type:i,selectors:[["app-product-viewer"]],viewQuery:function(t,n){if(1&t&&Ma(TJ,7),2&t){let r;Rs(r=Ps())&&(n.containerElement=r.first)}},decls:7,vars:1,consts:[[1,"viewer-container"],[1,"container-3d"],["canvasContainer",""],[3,"sceneInit"],[4,"ngIf"]],template:function(t,n){1&t&&(en(0,"div",0)(1,"div",1,2)(3,"app-viewer-threejs",3),Si("sceneInit",function(s){return n.onSceneInit(s)}),tn()(),si(4,"app-toolbar")(5,"app-sidebar"),zi(6,AJ,1,0,"app-loading-spinner",4),tn()),2&t&&(xn(6),Rt("ngIf",n.loadingsStarted!==n.loadingsFinished))},directives:[eJ,fJ,EJ,bp,CJ],styles:[".viewer-container[_ngcontent-%COMP%]{width:100vw;height:100vh}.container-3d[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;background-color:#444}"]}),i})(),matcher:function IJ(i){const e={};return i.length>0&&"model"===i[0].path&&(i.length>1&&(e.name=i[1]),i.length>2&&(e.subname=i[2])),{consumed:i,posParams:e}}}]);let PJ=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=fa({type:i,bootstrap:[fG]}),i.\u0275inj=ho({providers:[],imports:[[$A,hj,RJ]]}),i})();(function _4(){sA=!1})(),R5().bootstrapModule(PJ).catch(i=>console.error(i))}},gy=>{gy(gy.s=902)}]);